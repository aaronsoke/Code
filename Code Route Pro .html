<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Route Pro - Formation au code de la route</title>
    <meta name="description" content="R√©ussissez le code de la route : cours complets, examens blancs, quiz th√©matiques et jeux. Formation compl√®te en ligne.">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#FF6B35">
    <!-- Open Graph (Facebook, LinkedIn, etc.) -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Code Route Pro - Formation au code de la route">
    <meta property="og:description" content="R√©ussissez le code de la route : cours complets, examens blancs, quiz th√©matiques et jeux. Formation compl√®te en ligne.">
    <meta property="og:image" content="">
    <meta property="og:url" content="">
    <meta property="og:locale" content="fr_FR">
    <meta property="og:site_name" content="Code Route Pro">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Code Route Pro - Formation au code de la route">
    <meta name="twitter:description" content="R√©ussissez le code de la route : cours complets, examens blancs, quiz th√©matiques et jeux. Formation compl√®te en ligne.">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='85'%3E%F0%9F%9A%97%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='85'%3E%F0%9F%9A%97%3C/text%3E%3C/svg%3E">
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Space+Mono:wght@700&display=swap" rel="stylesheet">
    <style>
        /* Mode clair (par d√©faut) */
        :root, [data-theme="light"] {
            --primary: #FF6B35;
            --secondary: #F7931E;
            --accent: #FFD23F;
            --success: #06D6A0;
            --danger: #FF6B6B;
            --bg: #FFFEF9;
            --surface: #FFFFFF;
            --text: #1A1A1A;
            --text-light: #666666;
            --border: #E8E8E8;
            --shadow: rgba(0, 0, 0, 0.08);
        }
        /* Mode sombre */
        [data-theme="dark"] {
            --primary: #FF8A5C;
            --secondary: #F9A54D;
            --accent: #FFD23F;
            --success: #34D399;
            --danger: #F87171;
            --bg: #1a1a1e;
            --surface: #25252a;
            --text: #f4f4f5;
            --text-light: #a1a1aa;
            --border: #3f3f46;
            --shadow: rgba(0, 0, 0, 0.3);
        }
        [data-theme="dark"] .question-illustration-wrap,
        [data-theme="dark"] .situation-illustration,
        [data-theme="dark"] .question-illustration {
            background: #18181b;
        }
        [data-theme="dark"] .highlight-box {
            background: linear-gradient(135deg, rgba(255, 138, 92, 0.12), rgba(249, 165, 77, 0.08));
        }
        [data-theme="dark"] .highlight-box.success {
            background: linear-gradient(135deg, rgba(52, 211, 153, 0.12), rgba(52, 211, 153, 0.06));
        }
        [data-theme="dark"] .highlight-box.danger {
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.12), rgba(248, 113, 113, 0.06));
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* HEADER */
        .header {
            position: relative;
            text-align: center;
            margin-bottom: 60px;
            animation: slideDown 0.6s ease-out;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .logo {
            font-family: 'Space Mono', monospace;
            font-size: 3.5em;
            margin-bottom: 10px;
            letter-spacing: -2px;
        }
        
        .tagline {
            font-size: 1.2em;
            color: var(--text-light);
        }
        
        .theme-toggle-wrap {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        .theme-toggle {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 18px;
            border-radius: 50px;
            border: 2px solid var(--border);
            background: var(--surface);
            color: var(--text);
            font-family: 'DM Sans', sans-serif;
            font-size: 0.95em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .theme-toggle:hover {
            border-color: var(--primary);
            background: rgba(255, 107, 53, 0.08);
        }
        [data-theme="dark"] .theme-toggle:hover {
            background: rgba(255, 138, 92, 0.15);
        }
        .theme-toggle span.icon { font-size: 1.2em; }
        
        /* NAVIGATION TABS */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 40px;
            overflow-x: auto;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
        }
        
        .nav-tabs::-webkit-scrollbar {
            height: 4px;
        }
        
        .nav-tabs::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        
        .tab-btn {
            background: var(--surface);
            border: 2px solid var(--border);
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'DM Sans', sans-serif;
            font-size: 1em;
            font-weight: 500;
            color: var(--text);
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .tab-btn:hover {
            border-color: var(--primary);
            background: rgba(255, 107, 53, 0.05);
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.4s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* CARDS */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .card {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .card:hover {
            border-color: var(--primary);
            box-shadow: 0 8px 25px var(--shadow);
            transform: translateY(-5px);
        }
        
        .card.card-completed {
            border-left: 4px solid var(--success);
            background: linear-gradient(135deg, rgba(6, 214, 160, 0.06), var(--surface));
        }
        .card.card-completed .course-done-badge {
            display: inline-flex;
        }
        .course-done-badge {
            display: none;
            align-items: center;
            gap: 6px;
            margin-top: 12px;
            padding: 6px 12px;
            background: var(--success);
            color: white;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .card-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .card-title {
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .card-desc {
            color: var(--text-light);
            font-size: 0.95em;
        }
        
        /* COURSE CONTENT */
        .course-content {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
        }
        
        .course-content h2 {
            font-size: 2em;
            margin-bottom: 20px;
            color: var(--primary);
        }
        
        .course-content h3 {
            font-size: 1.5em;
            margin: 30px 0 15px;
        }
        
        .course-content p {
            margin-bottom: 15px;
            line-height: 1.8;
        }
        
        .course-content ul, .course-content ol {
            margin: 15px 0 15px 30px;
            line-height: 1.8;
        }
        
        /* HIGHLIGHT BOX */
        .highlight-box {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(247, 147, 30, 0.1));
            border-left: 4px solid var(--primary);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .highlight-box h3, .highlight-box h4 {
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .highlight-box.success {
            background: linear-gradient(135deg, rgba(6, 214, 160, 0.1), rgba(4, 191, 138, 0.1));
            border-left-color: var(--success);
        }
        
        .highlight-box.success h3, .highlight-box.success h4 {
            color: var(--success);
        }
        
        .highlight-box.danger {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(238, 90, 111, 0.1));
            border-left-color: var(--danger);
        }
        
        .highlight-box.danger h3, .highlight-box.danger h4 {
            color: var(--danger);
        }
        
        /* EXAM */
        .exam-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .exam-timer {
            font-family: 'Space Mono', monospace;
            font-size: 2.5em;
            font-weight: 700;
        }
        
        .question-card {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
        }
        
        .question-number {
            color: var(--primary);
            font-weight: 700;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        
        .question-text {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .situation-illustration,
        .question-illustration {
            width: 100%;
            max-width: 560px;
            height: auto;
            max-height: 320px;
            object-fit: contain;
            border-radius: 12px;
            margin: 0 auto 20px;
            display: block;
            border: 1px solid var(--border);
            background: var(--bg);
        }
        
        .question-illustration-wrap {
            width: 100%;
            max-width: 560px;
            margin: 0 auto 20px;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
            background: var(--bg);
        }
        .question-illustration-wrap svg {
            width: 100%;
            height: auto;
            max-height: 320px;
            display: block;
        }
        .exam-video-link {
            margin: -8px auto 16px;
            text-align: center;
        }
        .exam-video-link a {
            color: var(--primary);
            font-weight: 600;
            text-decoration: none;
        }
        .exam-video-link a:hover { text-decoration: underline; }
        
        .answers-grid {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .answer-option {
            background: rgba(255, 107, 53, 0.03);
            border: 2px solid var(--border);
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .answer-option:hover {
            border-color: var(--primary);
            background: rgba(255, 107, 53, 0.08);
        }
        
        .answer-option.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.15), rgba(247, 147, 30, 0.15));
            font-weight: 600;
        }
        
        .answer-option.correct {
            border-color: var(--success);
            background: linear-gradient(135deg, rgba(6, 214, 160, 0.15), rgba(4, 191, 138, 0.15));
        }
        
        .answer-option.incorrect {
            border-color: var(--danger);
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.15), rgba(238, 90, 111, 0.15));
        }
        
        .answer-radio {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid var(--primary);
            flex-shrink: 0;
        }
        
        .answer-option.selected .answer-radio {
            background: var(--primary);
            box-shadow: inset 0 0 0 4px var(--surface);
        }
        
        .explanation {
            background: linear-gradient(135deg, rgba(6, 214, 160, 0.1), rgba(4, 191, 138, 0.1));
            border-left: 4px solid var(--success);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        /* BUTTONS */
        .btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 12px;
            font-family: 'DM Sans', sans-serif;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }
        
        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 2px solid var(--border);
            box-shadow: none;
        }
        
        .btn-secondary:hover {
            border-color: var(--primary);
            background: rgba(255, 107, 53, 0.05);
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 30px;
        }
        
        /* RESULTS */
        .results-card {
            background: var(--surface);
            color: var(--text);
            padding: 50px 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            border: 3px solid var(--primary);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
        }
        
        .results-card h2 {
            color: var(--text);
            margin-bottom: 16px;
        }
        
        .results-card p {
            color: var(--text-light);
            font-size: 1.1em;
            margin: 10px 0;
        }
        
        .results-score {
            font-family: 'Space Mono', monospace;
            font-size: 5em;
            font-weight: 700;
            margin: 20px 0;
            color: var(--primary);
        }
        
        /* √âcran de fin examen / quiz (√©pur√©) */
        .exam-results-wrap {
            max-width: 640px;
            margin: 0 auto;
            padding: 20px 0;
        }
        
        .exam-results-wrap .results-card {
            margin-bottom: 24px;
        }
        
        .exam-results-wrap .stats-grid {
            margin-top: 24px;
        }
        
        .exam-results-wrap .stat-card {
            background: var(--surface);
            border: 2px solid var(--border);
            color: var(--text);
        }
        
        .exam-results-wrap .stat-number {
            color: var(--primary);
        }
        
        .exam-results-wrap .stat-label {
            color: var(--text-light);
        }
        
        .exam-results-wrap .btn-group {
            margin-top: 24px;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        /* STATS */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: var(--surface);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            border: 2px solid var(--border);
        }
        
        .stat-number {
            font-family: 'Space Mono', monospace;
            font-size: 3em;
            color: var(--primary);
            display: block;
            margin-bottom: 8px;
        }
        
        .stat-label {
            color: var(--text-light);
        }
        
        /* CONFETTI */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            z-index: 9999;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* SOUND TOGGLE */
        .sound-toggle {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.8em;
            z-index: 100;
            box-shadow: 0 4px 15px var(--shadow);
            transition: all 0.3s;
        }
        
        .sound-toggle:hover {
            border-color: var(--primary);
            transform: scale(1.1);
        }
        
        /* ANIMATIONS */
        .shake {
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .pulse-success {
            animation: pulse 0.6s;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 30px var(--success); }
        }
        
        .particle {
            position: fixed;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            animation: rise 1.5s ease-out forwards;
        }
        
        @keyframes rise {
            to {
                transform: translateY(-150px);
                opacity: 0;
            }
        }
        
        /* PR√âDICTION IA */
        .prediction-box {
            background: linear-gradient(135deg, rgba(6, 214, 160, 0.1), rgba(4, 191, 138, 0.1));
            border: 2px solid var(--success);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .prediction-box::before {
            content: 'ü§ñ';
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 8em;
            opacity: 0.1;
        }
        
        .prediction-title {
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .prediction-percent {
            font-family: 'Space Mono', monospace;
            font-size: 4em;
            color: var(--success);
            font-weight: 700;
            text-align: center;
            margin: 20px 0;
        }
        
        .ai-tip {
            background: var(--surface);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid var(--primary);
        }
        
        /* MINI-JEUX */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            max-width: 500px;
            margin: 30px auto;
        }
        
        .memory-card {
            aspect-ratio: 1;
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            transition: all 0.3s;
            user-select: none;
            position: relative;
        }
        
        .memory-card .memory-back {
            position: absolute;
        }
        
        .memory-card .memory-front {
            position: absolute;
            transition: opacity 0.2s;
        }
        
        .memory-card.flipped .memory-back {
            visibility: hidden;
        }
        
        .memory-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }
        
        .memory-card.flipped {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.15), rgba(247, 147, 30, 0.15));
            border-color: var(--primary);
        }
        
        .memory-card.matched {
            background: linear-gradient(135deg, rgba(6, 214, 160, 0.2), rgba(4, 191, 138, 0.2));
            border-color: var(--success);
            pointer-events: none;
        }
        
        .game-timer {
            font-family: 'Space Mono', monospace;
            font-size: 2em;
            color: var(--primary);
            text-align: center;
            margin: 20px 0;
            font-weight: 700;
        }
        
        .tf-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .tf-btn {
            padding: 30px 60px;
            font-size: 1.5em;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
            color: white;
        }
        
        .tf-btn.true {
            background: var(--success);
        }
        
        .tf-btn.false {
            background: var(--danger);
        }
        
        .tf-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .tf-btn:active {
            transform: scale(0.95);
        }
        
        /* FLASHCARDS */
        .flashcard-container {
            perspective: 1200px;
            max-width: 520px;
            margin: 0 auto;
            min-height: 280px;
            cursor: pointer;
        }
        .flashcard-inner {
            position: relative;
            width: 100%;
            min-height: 260px;
            transition: transform 0.5s ease;
            transform-style: preserve-3d;
        }
        .flashcard-inner.flipped {
            transform: rotateY(180deg);
        }
        .flashcard-front,
        .flashcard-back {
            position: absolute;
            width: 100%;
            min-height: 240px;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 8px 24px var(--shadow);
            background: var(--surface);
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .flashcard-front { font-size: 1.15em; line-height: 1.6; color: var(--text); }
        .flashcard-back {
            transform: rotateY(180deg);
            text-align: center;
            font-size: 1.12em;
            line-height: 1.6;
            padding: 32px;
        }
        .flashcard-back .fc-text {
            color: var(--text);
            margin: 0;
            max-width: 100%;
            padding: 0 0.5em;
        }
        
        /* Impression */
        @media print {
            body.print-memo .header,
            body.print-memo .nav-tabs,
            body.print-memo .theme-toggle-wrap,
            body.print-memo .sound-toggle,
            body.print-memo .footer,
            body.print-memo .tab-content:not(#memo) { display: none !important; }
            body.print-memo #memo { display: block !important; }
            body.print-memo .container { max-width: 100%; }
            body.print-course .header,
            body.print-course .nav-tabs,
            body.print-course .theme-toggle-wrap,
            body.print-course .sound-toggle,
            body.print-course .footer,
            body.print-course .tab-content:not(#courses) { display: none !important; }
            body.print-course #courses { display: block !important; }
            body.print-course #courseList { display: none !important; }
            body.print-course #courseDetail { display: block !important; }
            body.print-course .btn { display: none !important; }
            body.print-course .container { max-width: 100%; }
        }
        
        /* FOOTER */
        .footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
            font-size: 0.9em;
            border-top: 2px solid var(--border);
            margin-top: 60px;
        }
        
        .footer a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .legal-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .legal-modal.active {
            display: flex;
            animation: fadeIn 0.3s;
        }
        
        .legal-modal-content {
            background: var(--surface);
            border-radius: 20px;
            padding: 40px;
            max-width: 560px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }
        
        .legal-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            color: var(--text-light);
        }
        
        .legal-modal-content h3 {
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .legal-modal-content p {
            margin-bottom: 12px;
            font-size: 0.95em;
            line-height: 1.6;
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .logo {
                font-size: 2.5em;
            }
            
            .card-grid {
                grid-template-columns: 1fr;
            }
            
            .course-content {
                padding: 25px;
            }
            
            .exam-timer {
                font-size: 2em;
            }
            
            .results-score {
                font-size: 3.5em;
            }
            
            .theme-toggle-wrap {
                top: 10px;
                right: 10px;
            }
            .theme-toggle {
                padding: 8px 14px;
                font-size: 0.9em;
            }
        }
    </style>
    <script>
        (function() {
            var saved = localStorage.getItem('codeRouteProTheme');
            var theme = (saved === 'dark' || saved === 'light') ? saved : 'light';
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
</head>
<body>
    <script>
        (function() {
            function removeReminder() {
                var target = 'enleve le quizz priorite';
                document.querySelectorAll('*').forEach(function(el) {
                    var t = el.textContent ? el.textContent.replace(/\s+/g, ' ').trim().toLowerCase() : '';
                    if (el.children.length === 0 && t === target) el.remove();
                });
            }
            if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', removeReminder);
            else removeReminder();
        })();
    </script>
    <!-- MODAL MENTIONS L√âGALES -->
    <div class="legal-modal" id="legalModal" onclick="if(event.target===this) closeLegalModal()">
        <div class="legal-modal-content" style="position: relative;">
            <button class="legal-modal-close" onclick="closeLegalModal()" aria-label="Fermer">√ó</button>
            <h3>üìã Mentions l√©gales</h3>
            <p><strong>√âditeur du site</strong><br>
            Aaron Soke ‚Äî Particulier (personne physique).<br>
            Contact : <a href="mailto:aaronsoke@gmail.com">aaronsoke@gmail.com</a></p>
            <p><strong>Directeur de la publication</strong><br>
            Aaron Soke.</p>
            <p><strong>Objet</strong><br>
            Code Route Pro est une application p√©dagogique d'entra√Ænement au code de la route (examen th√©orique fran√ßais). Les contenus sont √† titre informatif et ne se substituent pas √† la formation officielle ni √† l'examen en centre agr√©√©.</p>
            <p><strong>H√©bergement</strong><br>
            GitHub, Inc., 88 Colin P Kelly Jr Street, San Francisco, CA 94107, √âtats-Unis.<br>
            <a href="https://github.com" target="_blank" rel="noopener">https://github.com</a></p>
            <p><strong>Donn√©es personnelles</strong><br>
            Les scores, pr√©f√©rences (th√®me, son) et la progression sont stock√©s uniquement dans votre navigateur (localStorage). Aucune donn√©e n'est envoy√©e sur un serveur. Vous pouvez effacer ces donn√©es via les param√®tres de votre navigateur.</p>
            <p><strong>Propri√©t√© intellectuelle</strong><br>
            Code Route Pro et son contenu (textes, structure, fonctionnalit√©s) sont prot√©g√©s. Toute reproduction ou exploitation non autoris√©e peut constituer une contrefa√ßon.</p>
            <p><strong>Limitation de responsabilit√©</strong><br>
            L'√©diteur s'efforce d'assurer l'exactitude des contenus mais d√©cline toute responsabilit√© quant aux erreurs ou omissions et √† l'usage fait de l'application.</p>
            <p><strong>Droit applicable</strong><br>
            Le pr√©sent site est soumis au droit fran√ßais.</p>
        </div>
    </div>
    
    <!-- SOUND TOGGLE -->
    <div class="sound-toggle" onclick="toggleSound()" id="soundBtn">üîä</div>
    
    <div class="container">
        <div class="header">
            <div class="theme-toggle-wrap">
                <button type="button" class="theme-toggle" id="themeToggle" onclick="toggleTheme()" aria-label="Changer de th√®me">
                    <span class="icon" id="themeIcon">üåô</span>
                    <span id="themeLabel">Mode sombre</span>
                </button>
            </div>
            <div class="logo">üöó Code Route Pro</div>
            <div class="tagline">Formation compl√®te pour r√©ussir le code !</div>
        </div>
        
        <div class="nav-tabs">
            <button class="tab-btn active" onclick="switchTab('home')">Accueil</button>
            <button class="tab-btn" onclick="switchTab('courses')">Cours</button>
            <button class="tab-btn" onclick="switchTab('exam')">Examen</button>
            <button class="tab-btn" onclick="switchTab('games')">Jeux</button>
            <button class="tab-btn" onclick="switchTab('quiz')">Quiz</button>
            <button class="tab-btn" onclick="switchTab('erreurs')">Erreurs</button>
            <button class="tab-btn" onclick="switchTab('flashcards')">Flashcards</button>
            <button class="tab-btn" onclick="switchTab('memo')">M√©mo</button>
            <button class="tab-btn" onclick="switchTab('candidatlibre')">Candidat libre</button>
            <button class="tab-btn" onclick="switchTab('stats')">Stats</button>
        </div>
        
        <!-- HOME -->
        <div id="home" class="tab-content active">
            <div class="highlight-box">
                <h2>üëã Bienvenue !</h2>
                <p><strong>R√©visez le code de la route</strong> avec nos cours complets, examens blancs et quiz interactifs.</p>
                <p>‚úÖ 10 cours d√©taill√©s ‚Ä¢ ‚úÖ 100+ questions ‚Ä¢ ‚úÖ Quiz th√©matiques ‚Ä¢ ‚úÖ Suivi de progression</p>
                <div style="margin-top: 20px; padding: 16px; background: rgba(255,107,53,0.08); border-radius: 12px; border-left: 4px solid var(--primary);">
                    <strong>üéØ Pour obtenir le code :</strong>
                    <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                        <li>R√©ussir <strong>35 bonnes r√©ponses sur 40</strong> le jour de l'examen</li>
                        <li>R√©viser les <strong>cours</strong>, puis encha√Æner <strong>examens blancs</strong> et <strong>quiz</strong> par th√®me</li>
                        <li>Consulter l'onglet <strong>M√©mo</strong> pour les chiffres cl√©s et le jour J ; l'onglet <strong>Candidat libre</strong> pour la d√©marche et le NEPH</li>
                    </ul>
                </div>
            </div>
            
            <!-- PR√âDICTION IA -->
            <div class="prediction-box" id="homePrediction" style="display:none;">
                <div class="prediction-title">ü§ñ Analyse IA de votre progression</div>
                <div class="prediction-percent" id="homePredictionPercent">---%</div>
                <p style="text-align: center; font-size: 1.1em;" id="homePredictionMsg"></p>
            </div>
            
            <h2 style="margin: 40px 0 20px;">üöÄ Par o√π commencer ?</h2>
            <div class="card-grid">
                <div class="card" onclick="switchTab('courses')">
                    <div class="card-icon">üìö</div>
                    <div class="card-title">Cours th√©oriques</div>
                    <div class="card-desc">10 chapitres pour ma√Ætriser le code de la route</div>
                </div>
                
                <div class="card" onclick="switchTab('exam')">
                    <div class="card-icon">üìù</div>
                    <div class="card-title">Examen blanc</div>
                    <div class="card-desc">40 questions en 30 minutes - conditions r√©elles</div>
                </div>
                
                <div class="card" onclick="switchTab('quiz')">
                    <div class="card-icon">üéØ</div>
                    <div class="card-title">Quiz rapide</div>
                    <div class="card-desc">R√©visions cibl√©es par th√®me</div>
                </div>
                
                <div class="card" onclick="switchTab('games')">
                    <div class="card-icon">üéÆ</div>
                    <div class="card-title">Jeux</div>
                    <div class="card-desc">Priorit√©, chiffres cl√©s, quiz chrono ‚Äî apprendre en s'amusant</div>
                </div>
            </div>
        </div>
        
        <!-- COURSES -->
        <div id="courses" class="tab-content">
            <div id="courseList">
                <div class="highlight-box success" style="margin-bottom: 25px;">
                    <strong>üìñ Contenu p√©dagogique</strong> ‚Äî Ces cours sont con√ßus pour r√©viser le Code de la route. Ils s‚Äôappuient sur les textes officiels  Bonne r√©vision !
                </div>
                <h2 style="margin-bottom: 30px;">üìö Les 10 Cours du Code</h2>
                <div class="card-grid" id="coursesGrid"></div>
            </div>
            
            <div id="courseDetail" style="display: none;">
                <button class="btn" onclick="backToCourses()">‚Üê Retour aux cours</button>
                <div class="course-content" id="courseDetailContent"></div>
                <div class="btn-group" id="courseDetailActions">
                    <button class="btn" onclick="printCourse()">üñ®Ô∏è Imprimer ce cours</button>
                    <button class="btn" onclick="markCourseComplete()">‚úì Marquer termin√©</button>
                    <button class="btn" onclick="backToCourses()">‚Üê Retour</button>
                </div>
            </div>
        </div>
        
        <!-- EXAM -->
        <div id="exam" class="tab-content">
            <div id="examStart">
                <div class="highlight-box">
                    <h2>üìù Examen Blanc</h2>
                    <p><strong>Format officiel :</strong> 40 questions ‚Ä¢ 30 minutes ‚Ä¢ <strong>35/40</strong> pour r√©ussir</p>
                    <p style="margin-top: 12px;"><strong>Conseils :</strong></p>
                    <ul style="margin: 8px 0 0 20px; line-height: 1.7;">
                        <li>Installez-vous au calme, sans interruption (comme au centre d'examen)</li>
                        <li>Lisez bien chaque question et toutes les r√©ponses avant de choisir</li>
                        <li>Environ 45 secondes par question ‚Äî gardez un rythme r√©gulier</li>
                        <li>Apr√®s l'examen, relisez les explications des questions rat√©es</li>
                    </ul>
                </div>
                <button class="btn" onclick="startExam()">üöÄ Commencer l'examen</button>
            </div>
            
            <div id="examContent" style="display: none;">
                <div class="exam-header">
                    <div id="examProgress">Question 1/40</div>
                    <div class="exam-timer" id="examTimer">30:00</div>
                </div>
                <div id="examQuestion"></div>
            </div>
            
            <div id="examResults" style="display: none;"></div>
        </div>
        
        <!-- QUIZ -->
        <div id="quiz" class="tab-content">
            <div id="quizThemesWrap">
                <h2 style="margin-bottom: 30px;">üéØ Quiz par Th√®me</h2>
                <p style="margin-bottom: 30px; color: var(--text-light);">Choisissez un th√®me et testez vos connaissances</p>
                <div class="card-grid" id="quizThemes"></div>
            </div>
            <div id="quizRunContainer" style="display: none;">
                <button class="btn" onclick="resetQuizRun()" style="margin-bottom: 20px;">‚Üê Retour aux th√®mes</button>
                <div class="exam-header" style="justify-content: flex-start;">
                    <div id="quizProgress">Question 1/10</div>
                </div>
                <div id="quizQuestion"></div>
                <div id="quizResults" style="display: none;"></div>
            </div>
        </div>
        
        <!-- ERREURS (cumul quiz + examen) -->
        <div id="erreurs" class="tab-content">
            <h2 style="margin-bottom: 30px;">‚ùå Mes erreurs</h2>
            <p style="margin-bottom: 24px; color: var(--text-light);">Toutes les questions auxquelles vous avez r√©pondu incorrectement (quiz et examen) sont enregistr√©es ici. Refaites un quiz avec uniquement ces questions pour vous entra√Æner.</p>
            <div id="erreursHome">
                <div class="highlight-box" id="erreursMessage"></div>
                <div id="erreursActions" style="margin-top: 20px;"></div>
            </div>
            <div id="erreursRun" style="display: none;">
                <button class="btn" onclick="resetErreursRun()" style="margin-bottom: 20px;">‚Üê Retour</button>
                <div class="exam-header" style="justify-content: flex-start;">
                    <div id="erreursProgress">Question 1/0</div>
                </div>
                <div id="erreursQuestion"></div>
                <div id="erreursResults" style="display: none;"></div>
            </div>
        </div>
        
        <!-- FLASHCARDS -->
        <div id="flashcards" class="tab-content">
            <h2 style="margin-bottom: 30px;">üÉè Flashcards</h2>
            <p style="margin-bottom: 24px; color: var(--text-light);">Choisissez un th√®me et r√©visez avec des cartes : question au recto, r√©ponse et explication au verso.</p>
            <div id="flashcardsThemesWrap">
                <div class="card-grid" id="flashcardsThemes"></div>
            </div>
            <div id="flashcardsRun" style="display: none;">
                <button class="btn" onclick="backToFlashcardsThemes()" style="margin-bottom: 20px;">‚Üê Retour aux th√®mes</button>
                <div style="text-align: center; margin-bottom: 16px; font-family: 'Space Mono', monospace; color: var(--primary);">
                    Carte <span id="flashcardNum">1</span> / <span id="flashcardTotal">0</span>
                </div>
                <div class="flashcard-container" id="flashcardContainer" onclick="flipFlashcard()">
                    <div class="flashcard-inner" id="flashcardInner">
                        <div class="flashcard-front" id="flashcardFront"></div>
                        <div class="flashcard-back" id="flashcardBack"></div>
                    </div>
                </div>
                <div class="btn-group" style="margin-top: 24px; justify-content: center;">
                    <button class="btn" onclick="prevFlashcard()">‚Üê Pr√©c√©dent</button>
                    <button class="btn" onclick="flipFlashcard()">üîÑ Retourner</button>
                    <button class="btn" onclick="nextFlashcard()">Suivant ‚Üí</button>
                </div>
            </div>
        </div>
        
        <!-- MINI-JEUX -->
        <div id="games" class="tab-content">
            <h2 style="margin-bottom: 30px;">üéÆ Mini-Jeux Ludiques</h2>
            
            <div id="gamesMenu">
                <div class="card-grid">
                    <div class="card" onclick="startPriorite()">
                        <div class="card-icon">üîÑ</div>
                        <div class="card-title">Qui a la priorit√© ?</div>
                        <div class="card-desc">Une situation, une question : qui doit c√©der le passage ? Indispensable pour l'examen et la route.</div>
                    </div>
                    
                    <div class="card" onclick="startSpeedQuiz()">
                        <div class="card-icon">‚è±Ô∏è</div>
                        <div class="card-title">Quiz Chrono</div>
                        <div class="card-desc">10 questions √† choix multiples en 2 minutes. R√©pondez le plus vite possible !</div>
                    </div>
                    
                    <div class="card" onclick="startChiffres()">
                        <div class="card-icon">üî¢</div>
                        <div class="card-title">Chiffres cl√©s</div>
                        <div class="card-desc">Vitesses, distances, points, amendes : m√©morisez les chiffres du code en 10 questions √† choix multiples.</div>
                    </div>
                </div>
            </div>
            
            <!-- JEU QUI A LA PRIORIT√â -->
            <div id="prioriteGame" style="display:none;">
                <button class="btn" onclick="backToGames()">‚Üê Retour</button>
                <div class="course-content">
                    <h3 style="text-align:center; margin-bottom:10px;">üîÑ Qui a la priorit√© ?</h3>
                    <p style="text-align:center; color: var(--text-light); margin-bottom:15px;">Lisez la situation et choisissez qui doit c√©der le passage</p>
                    <div style="text-align:center; margin:15px 0;">
                        <span style="font-family: 'Space Mono', monospace; font-size: 1.3em; color: var(--primary);">Question <span id="prioriteNum">1</span>/10 ‚Ä¢ Score : <span id="prioriteScore">0</span></span>
                    </div>
                    <div id="prioriteContent"></div>
                </div>
            </div>
            
            <!-- SPEED QUIZ -->
            <div id="speedQuizGame" style="display:none;">
                <button class="btn" onclick="backToGames()">‚Üê Retour</button>
                <div class="course-content">
                    <h3 style="text-align:center; margin-bottom:20px;">‚è±Ô∏è Quiz Chrono</h3>
                    <div class="game-timer" id="speedTimer">2:00</div>
                    <div id="speedQuizContent"></div>
                </div>
            </div>
            
            <!-- JEU CHIFFRES CL√âS -->
            <div id="chiffresGame" style="display:none;">
                <button class="btn" onclick="backToGames()">‚Üê Retour</button>
                <div class="course-content">
                    <h3 style="text-align:center; margin-bottom:10px;">üî¢ Chiffres cl√©s</h3>
                    <p style="text-align:center; color: var(--text-light); margin-bottom:15px;">Vitesses, distances, points, amendes : trouvez la bonne valeur</p>
                    <div style="text-align:center; margin:15px 0;">
                        <span style="font-family: 'Space Mono', monospace; font-size: 1.3em; color: var(--primary);">Question <span id="chiffresNum">1</span>/10 ‚Ä¢ Score : <span id="chiffresScore">0</span></span>
                    </div>
                    <div id="chiffresContent"></div>
                </div>
            </div>
        </div>
        
        <!-- STATS -->
        <div id="stats" class="tab-content">
            <h2 style="margin-bottom: 30px;">üìä Vos Statistiques</h2>
            
            <!-- PR√âDICTION IA D√âTAILL√âE -->
            <div class="prediction-box">
                <div class="prediction-title">ü§ñ Pr√©diction IA</div>
                <p>Probabilit√© de r√©ussite √† l'examen</p>
                <div class="prediction-percent" id="statsPredictionPercent">---%</div>
                <div id="statsAITips"></div>
            </div>
            
            <div class="stats-grid" id="statsContent"></div>
            <div id="statsDetails"></div>
        </div>
        
        <!-- M√âMO & CONSEILS -->
        <div id="memo" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; margin-bottom: 24px;">
                <h2 style="margin: 0;">üìã M√©mo & Conseils pour obtenir le code</h2>
                <button type="button" class="btn" onclick="printMemo()">üñ®Ô∏è Imprimer le m√©mo</button>
            </div>
            
            <div class="highlight-box success" style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 12px;">‚úÖ Conseils pour r√©ussir</h3>
                <p><strong>Avant l'examen :</strong></p>
                <ul style="margin: 8px 0 12px 20px; line-height: 1.7;">
                    <li>Suivez les 10 cours dans l'ordre, puis testez-vous avec les quiz par th√®me</li>
                    <li>Encha√Ænez les examens blancs jusqu'√† viser r√©guli√®rement 35/40 ou plus</li>
                    <li>R√©visez les th√®mes o√π vous faites le plus d'erreurs (voir Stats)</li>
                    <li>M√©morisez les chiffres cl√©s (vitesses, distances, points) avec le jeu d√©di√©</li>
                </ul>
                <p><strong>Le jour J :</strong></p>
                <ul style="margin: 8px 0 12px 20px; line-height: 1.7;">
                    <li>Pr√©sentez-vous avec votre convocation et une pi√®ce d'identit√© en cours de validit√©</li>
                    <li>√âcoutez bien la vid√©o : une seule diffusion par question</li>
                    <li>Lisez toutes les r√©ponses avant de r√©pondre ; pas de retour en arri√®re</li>
                    <li>Restez concentr√© : 40 questions, environ 30 minutes</li>
                </ul>
            </div>
            
            <h3 style="margin: 28px 0 16px;">üî¢ Chiffres √† retenir</h3>
            <div class="card-grid" style="margin-bottom: 30px;">
                <div class="card" style="cursor: default;">
                    <div class="card-icon">üö¶</div>
                    <div class="card-title">Vitesses (km/h)</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        Agglom√©ration : 50 ‚Ä¢ Zone 30 : 30 ‚Ä¢ Zone rencontre : 20<br>
                        Route 2√ó2 voies : 80 (90 si panneau) ‚Ä¢ 2√ó2 chauss√©es s√©par√©es : 110<br>
                        Autoroute : 130 (sec) / 110 (pluie) ‚Ä¢ Permis &lt;3 ans : 110 autoroute<br>
                        Brouillard visibilit√© &lt;50 m : 50 partout
                    </div>
                </div>
                <div class="card" style="cursor: default;">
                    <div class="card-icon">üìè</div>
                    <div class="card-title">Distances & r√®gles</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        Distance de s√©curit√© : 2 secondes min.<br>
                        D√©passer un cycliste : 1 m (ville) / 1,5 m (hors agglo)<br>
                        Stationnement interdit : 5 m avant un passage pi√©ton<br>
                        Pneus : 1,6 mm min. (sculptures)
                    </div>
                </div>
                <div class="card" style="cursor: default;">
                    <div class="card-icon">üìÑ</div>
                    <div class="card-title">Permis & sanctions</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        Permis probatoire : 6 points au d√©part ‚Ä¢ 12 points max.<br>
                        Alcool : 0,5 g/L (confirm√©) / 0,2 g/L (permis &lt;3 ans)<br>
                        T√©l√©phone en main : 135 ‚Ç¨, 3 points<br>
                        Stage r√©cup. points : 4 points max. (1/an)
                    </div>
                </div>
                <div class="card" style="cursor: default;">
                    <div class="card-icon">üìû</div>
                    <div class="card-title">Num√©ros utiles</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        <strong>112</strong> ‚Äî Urgence europ√©en<br>
                        <strong>18</strong> ‚Äî Pompiers<br>
                        <strong>15</strong> ‚Äî SAMU<br>
                        <strong>17</strong> ‚Äî Police
                    </div>
                </div>
            </div>
            
            <h3 style="margin: 28px 0 16px;">üîÑ Priorit√©s</h3>
            <div class="card-grid" style="margin-bottom: 30px;">
                <div class="card" style="cursor: default;">
                    <div class="card-icon">üõë</div>
                    <div class="card-title">R√®gles de base</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        Priorit√© √† droite (sauf signalisation).<br>
                        Rond-point : priorit√© √† ceux qui sont d√©j√† dessus (sauf panneau).<br>
                        Passage pi√©ton : c√©der si le pi√©ton manifeste l‚Äôintention de traverser.<br>
                        Stop = arr√™t obligatoire. C√©dez le passage = ralentir et c√©der si besoin.
                    </div>
                </div>
                <div class="card" style="cursor: default;">
                    <div class="card-icon">üö®</div>
                    <div class="card-title">V√©hicules prioritaires</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        SAMU, pompiers, police, gendarmerie (gyrophare + 3 tons).<br>
                        S‚Äô√©carter ou s‚Äôarr√™ter pour faciliter le passage.<br>
                        En cas d‚Äôaccident : prot√©ger, alerter (15, 18, 112), secourir (PAS).
                    </div>
                </div>
            </div>
            
            <h3 style="margin: 28px 0 16px;">ü™ß Signalisation</h3>
            <div class="card-grid" style="margin-bottom: 30px;">
                <div class="card" style="cursor: default;">
                    <div class="card-icon">‚ö†Ô∏è</div>
                    <div class="card-title">Formes des panneaux</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        <strong>Triangle</strong> (pointe en haut) = danger.<br>
                        <strong>Rond rouge</strong> = interdiction ou obligation.<br>
                        <strong>Carr√© / rectangle bleu</strong> = indication ou obligation.<br>
                        <strong>Rond bleu</strong> = obligation (ex. direction obligatoire).
                    </div>
                </div>
                <div class="card" style="cursor: default;">
                    <div class="card-icon">üö¶</div>
                    <div class="card-title">Feux et √©clairage</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        Feu vert = passer. Orange = s‚Äôarr√™ter (sauf si passage dangereux). Rouge = stop.<br>
                        Feux : nuit, brouillard, tunnel, visibilit√© &lt;50 m.<br>
                        Croisement : feux de croisement. Route seule : feux de route si pas d‚Äô√©blouissement.
                    </div>
                </div>
            </div>
            
            <h3 style="margin: 28px 0 16px;">üìã Documents & d√©lais</h3>
            <div class="card-grid" style="margin-bottom: 30px;">
                <div class="card" style="cursor: default;">
                    <div class="card-icon">üìÑ</div>
                    <div class="card-title">√Ä avoir en voiture</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        Permis de conduire, carte grise (certificat d‚Äôimmatriculation), attestation d‚Äôassurance.<br>
                        Gilet r√©fl√©chissant et triangle dans le v√©hicule (obligatoires).<br>
                        Assurance : obligatoire (au moins responsabilit√© civile).
                    </div>
                </div>
                <div class="card" style="cursor: default;">
                    <div class="card-icon">üìÖ</div>
                    <div class="card-title">Validit√©s</div>
                    <div class="card-desc" style="text-align: left; font-size: 0.9em;">
                        Permis probatoire : 3 ans (2 ans si conduite accompagn√©e).<br>
                        Permis : validit√© 15 ans (photo √† jour).<br>
                        Carte grise : √† jour (changement de propri√©taire, adresse).
                    </div>
                </div>
            </div>
            
            <div class="highlight-box" style="margin-top: 20px;">
                <p><strong>üí° Rappel :</strong> L'examen comporte 40 questions. Il faut au moins <strong>35 bonnes r√©ponses</strong> sans faute √©liminatoire (alcool, priorit√© pi√©ton, etc.). Entra√Ænez-vous jusqu'√† √™tre √† l'aise sur tous les th√®mes.</p>
            </div>
        </div>
        
        <!-- CANDIDAT LIBRE -->
        <div id="candidatlibre" class="tab-content">
            <h2 style="margin-bottom: 24px;">üìÑ Passer le code en candidat libre</h2>
            
            <p style="margin-bottom: 24px; color: var(--text-light);">Passer le code en <strong>candidat libre</strong> signifie s'inscrire soi-m√™me √† l'examen th√©orique sans passer par une auto-√©cole. Vous r√©visez en autonomie (avec nos cours et examens blancs) puis vous r√©servez une session dans un centre agr√©√©. Voici les √©tapes.</p>
            
            <div class="highlight-box success" style="margin-bottom: 28px;">
                <h3 style="margin-bottom: 14px;">1Ô∏è‚É£ Obtenir le num√©ro NEPH</h3>
                <p><strong>Qu'est-ce que le NEPH ?</strong></p>
                <p>Le <strong>NEPH</strong> (Num√©ro d'Enregistrement Pr√©fectoral Harmonis√©) est le num√©ro de dossier attribu√© √† votre demande de permis de conduire. Il est <strong>obligatoire</strong> pour pouvoir vous inscrire √† une session d'examen du code, que vous passiez en candidat libre ou via une auto-√©cole.</p>
                <p style="margin-top: 14px;"><strong>Comment l'obtenir ?</strong></p>
                <p>Vous devez cr√©er un dossier de demande de permis de conduire sur le site de l'<strong>ANTS</strong> (Agence Nationale des Titres S√©curis√©s). Rendez-vous sur le portail officiel de l'ANTS, rubrique ¬´ Permis de conduire ¬ª, puis ¬´ Cr√©er un dossier ¬ª ou ¬´ Demande de permis ¬ª.</p>
                <ul style="margin: 12px 0 0 20px; line-height: 1.8;">
                    <li><strong>Pi√®ces √† pr√©parer :</strong> pi√®ce d'identit√© en cours de validit√©, justificatif de domicile de moins de 6 mois, photo d'identit√© aux normes (photo num√©rique ou agence agr√©√©e).</li>
                    <li>Apr√®s d√©p√¥t du dossier, l'ANTS vous attribue un <strong>num√©ro NEPH</strong> (souvent par e-mail ou visible dans votre espace). Conservez-le : il vous servira pour r√©server l'examen du code.</li>
                    <li>Si vous avez d√©j√† un permis (cat√©gorie AM, B1, etc.) ou un dossier en cours, vous pouvez d√©j√† avoir un NEPH : v√©rifiez dans votre espace ANTS.</li>
                </ul>
                <p style="margin-top: 12px; font-size: 0.95em; color: var(--text-light);">Le d√©lai de traitement peut varier. Pensez √† faire cette d√©marche suffisamment t√¥t avant la date d'examen souhait√©e.</p>
            </div>
            
            <div class="highlight-box" style="margin-bottom: 28px;">
                <h3 style="margin-bottom: 14px;">2Ô∏è‚É£ S'inscrire √† une session d'examen</h3>
                <p>Une fois en possession de votre <strong>num√©ro NEPH</strong>, vous pouvez r√©server une place √† l'examen th√©orique (code) aupr√®s d'un <strong>centre agr√©√©</strong>. Les organismes qui organisent les sessions d'examen du code (ETG) sont habilit√©s par l'√âtat.</p>
                <p style="margin-top: 12px;">Vous pouvez vous inscrire notamment via :</p>
                <ul style="margin: 8px 0 0 20px; line-height: 1.7;">
                    <li>La Poste (centres d'examen du code)</li>
                    <li>Les r√©seaux d'organismes agr√©√©s (recherchez ¬´ inscription examen code candidat libre ¬ª ou ¬´ r√©server examen code ¬ª pour trouver un centre pr√®s de chez vous)</li>
                </ul>
                <p style="margin-top: 12px;">Sur le site du centre choisi, vous indiquez votre <strong>num√©ro NEPH</strong>, vous s√©lectionnez une date et un lieu de session, puis vous r√©glez les frais d'examen (tarif fix√© par l'√âtat). Vous recevez une <strong>convocation</strong> √† pr√©senter le jour J.</p>
            </div>
            
            <div class="highlight-box" style="margin-bottom: 28px;">
                <h3 style="margin-bottom: 14px;">3Ô∏è‚É£ Le jour de l'examen</h3>
                <p>Pr√©sentez-vous au centre avec :</p>
                <ul style="margin: 8px 0 0 20px; line-height: 1.7;">
                    <li>Votre <strong>convocation</strong></li>
                    <li>Une <strong>pi√®ce d'identit√©</strong> en cours de validit√© (carte d'identit√© ou passeport)</li>
                </ul>
                <p style="margin-top: 12px;">L'√©preuve dure environ 30 minutes (40 questions, 35 bonnes r√©ponses requises). Une fois re√ßu, votre r√©sultat est enregistr√© et vous pourrez, apr√®s obtention du code, vous inscrire √† l'√©preuve pratique (conduite) en candidat libre ou via une auto-√©cole.</p>
            </div>
            
            <div class="highlight-box success" style="margin-top: 20px;">
                <p><strong>üí° En r√©sum√© :</strong> Cr√©ez votre dossier sur le site ANTS pour obtenir le <strong>NEPH</strong> ‚Üí R√©servez une session dans un centre agr√©√© avec ce num√©ro ‚Üí Pr√©sentez-vous le jour J avec convocation et pi√®ce d'identit√©. En attendant, entra√Ænez-vous avec nos examens blancs et le M√©mo pour mettre toutes les chances de votre c√¥t√©.</p>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>üìö Informations v√©rifi√©es selon le Code de la route fran√ßais 2025</p>
        <p style="margin-top: 15px; font-size: 0.85em;">Contenu p√©dagogique original ‚Äî conforme au Code de la route en vigueur.</p>
        <p style="margin-top: 10px;"><a href="#" onclick="openLegalModal(); return false;">Mentions l√©gales</a></p>
    </div>
    
    <script>
        // =============================================
        // DONN√âES - COURS
        // =============================================
        const courses = [
            {
                id: 1,
                icon: '‚ö†Ô∏è',
                title: 'Signalisation',
                desc: 'Panneaux, marquages, feux',
                content: `
                    <h2>‚ö†Ô∏è La Signalisation Routi√®re - Guide Complet</h2>
                    
                    <p><strong>La signalisation routi√®re</strong> est l'ensemble des moyens de communication visuelle utilis√©s pour transmettre des informations aux usagers de la route. Elle comprend les panneaux, les marquages au sol, les feux tricolores et les balises.</p>
                    
                    <h3>üìê Les 4 grandes familles de panneaux</h3>
                    
                    <div class="highlight-box danger">
                        <h4>üî∫ 1. PANNEAUX DE DANGER (Type A)</h4>
                        <p><strong>Forme :</strong> Triangle √©quilat√©ral pointe en haut, bordure rouge, fond blanc</p>
                        <p><strong>Signification :</strong> Signalent un DANGER √† venir. JAMAIS une interdiction !</p>
                        <p><strong>Distance d'implantation :</strong> 150m hors agglom√©ration, 50m en agglom√©ration</p>
                        
                        <p><strong>üìã Liste compl√®te des panneaux de danger :</strong></p>
                        <ul>
                            <li><strong>Virages :</strong> Virage √† droite, virage √† gauche, succession virages, virage dangereux</li>
                            <li><strong>Intersections :</strong> Intersection, carrefour √† sens giratoire, intersection avec priorit√© √† droite</li>
                            <li><strong>Chauss√©e :</strong> Chauss√©e r√©tr√©cie, chauss√©e glissante, dos d'√¢ne, cassis, chauss√©e d√©form√©e</li>
                            <li><strong>Passages :</strong> Passage pi√©tons, enfants, animaux domestiques, animaux sauvages</li>
                            <li><strong>Travaux :</strong> Travaux, chauss√©e r√©tr√©cie temporaire, projection de graviers</li>
                            <li><strong>Obstacles :</strong> Descente dangereuse, mont√©e raide, d√©bouch√© sur quai/berge, vent lat√©ral</li>
                            <li><strong>Circulation :</strong> Circulation dans les 2 sens, chauss√©e r√©tr√©cie par la droite/gauche, ralentisseur</li>
                            <li><strong>Rail :</strong> Passage √† niveau avec/sans barri√®res, tramway</li>
                            <li><strong>Autres :</strong> Passage d'avions, chutes de pierres, risque d'incendie, zone d'avalanche</li>
                        </ul>
</div>
                    
                    <div class="highlight-box danger">
                        <h4>üî¥ 2. PANNEAUX D'INTERDICTION (Type B)</h4>
                        <p><strong>Forme :</strong> Cercle √† bordure rouge, fond blanc (sauf sens interdit)</p>
                        <p><strong>Signification :</strong> Interdiction formelle. Non-respect = contravention</p>
                        
                        <p><strong>üìã Principaux panneaux d'interdiction :</strong></p>
                        <ul>
                            <li><strong>Sens interdit</strong> (rond rouge, barre blanche horizontale)</li>
                            <li><strong>Interdiction de tourner :</strong> √Ä gauche, √† droite, demi-tour</li>
                            <li><strong>Limitations de vitesse :</strong> 30, 50, 70, 80, 90, 110, 130 km/h</li>
                            <li><strong>Interdiction de d√©passer :</strong> Tous v√©hicules, poids lourds uniquement</li>
                            <li><strong>Interdiction de stationner :</strong> Stationnement interdit, arr√™t et stationnement interdits</li>
                            <li><strong>Acc√®s interdit :</strong> Tous v√©hicules, v√©hicules √† moteur, poids lourds, v√©hicules agricoles</li>
                            <li><strong>Dimensions :</strong> Hauteur limit√©e, largeur limit√©e, tonnage limit√©</li>
                            <li><strong>Circulation :</strong> Interdiction de klaxonner (sauf danger imm√©diat)</li>
                            <li><strong>Autres :</strong> Cycles interdits, pi√©tons interdits, animaux interdits, v√©hicules tractant remorque</li>
                        </ul>
                        
                        <p><strong>‚ö†Ô∏è Important :</strong> Une limitation de vitesse reste valable jusqu'au prochain panneau de limitation, ou jusqu'√† l'entr√©e en agglom√©ration, ou apr√®s une intersection avec panneau prioritaire.</p>
</div>
                    
                    <div class="highlight-box success">
                        <h4>üîµ 3. PANNEAUX D'OBLIGATION (Type B)</h4>
                        <p><strong>Forme :</strong> Cercle, fond bleu</p>
                        <p><strong>Signification :</strong> Obligation √† respecter sous peine de contravention</p>
                        
                        <p><strong>üìã Liste des obligations :</strong></p>
                        <ul>
                            <li><strong>Direction obligatoire :</strong> Tout droit, √† gauche, √† droite, tout droit ou gauche, tout droit ou droite</li>
                            <li><strong>Contournement :</strong> Contournement obligatoire par la droite/gauche</li>
                            <li><strong>Giratoire :</strong> Obligation de tourner (sens des fl√®ches)</li>
                            <li><strong>Vitesse minimale :</strong> Ex: 60 km/h minimum sur voie rapide</li>
                            <li><strong>Cha√Ænes :</strong> Cha√Ænes √† neige obligatoires</li>
                            <li><strong>Pistes :</strong> Piste ou bande cyclable obligatoire pour cycles, chemin obligatoire pour pi√©tons</li>
                            <li><strong>Allumage :</strong> Allumage des feux obligatoire (tunnels)</li>
                        </ul>
                        
                        <p><strong>üí° √Ä savoir :</strong> La fin d'obligation est signal√©e par le m√™me panneau barr√© d'une diagonale rouge.</p>
</div>
                    
                    <div class="highlight-box">
                        <h4>‚ÑπÔ∏è 4. PANNEAUX D'INDICATION (Type C, D, E)</h4>
                        <p><strong>Forme :</strong> Variable (carr√©s, rectangles)</p>
                        <p><strong>Couleurs :</strong> Bleu (autoroutes, directions), blanc (routes), vert (grands axes), jaune (temporaire)</p>
                        
                        <p><strong>üìã Types de panneaux d'indication :</strong></p>
                        <ul>
                            <li><strong>Priorit√© :</strong> Panneau prioritaire (losange jaune), fin de priorit√©, c√©dez le passage, STOP</li>
                            <li><strong>Directions :</strong> Pr√©signalisation, direction, confirmation</li>
                            <li><strong>Localisation :</strong> Entr√©e/sortie agglom√©ration, autoroute, zone 30, aire pi√©tonne</li>
                            <li><strong>Services :</strong> H√¥pital, t√©l√©phone, essence, h√¥tel, restaurant, parking</li>
                            <li><strong>Zones :</strong> Zone de rencontre, aire pi√©tonne, zone 30, zone de stationnement</li>
                            <li><strong>Indications :</strong> Voie r√©serv√©e bus/taxi, passage pi√©tons, ralentisseur</li>
                        </ul>
</div>
                    
                    <h3>üõ£Ô∏è Marquages au sol - Guide exhaustif</h3>
                    
                    <div class="highlight-box">
                        <h4>Les lignes longitudinales</h4>
                        
                        <p><strong>1Ô∏è‚É£ Ligne continue (T1)</strong></p>
                        <ul>
                            <li>Largeur : 3 cm ou plus selon importance</li>
                            <li><strong>Signification :</strong> Franchissement INTERDIT dans les deux sens</li>
                            <li><strong>Usage :</strong> S√©parer les voies de circulation oppos√©es, d√©limiter voies</li>
                            <li>‚ö†Ô∏è Franchir = 135‚Ç¨ + 3 points (m√™me pour d√©passer un v√©lo !)</li>
                        </ul>
                        
                        <p><strong>2Ô∏è‚É£ Ligne discontinue (T3)</strong></p>
                        <ul>
                            <li>Traits de 3m, espac√©s de 10m</li>
                            <li><strong>Signification :</strong> Franchissement autoris√© si s√©curit√© assur√©e</li>
                            <li><strong>Usage :</strong> S√©parer les voies, d√©limiter couloirs</li>
                        </ul>
                        
                        <p><strong>3Ô∏è‚É£ Ligne mixte</strong></p>
                        <ul>
                            <li>Ligne continue + discontinue c√¥te √† c√¥te</li>
                            <li><strong>R√®gle :</strong> On ne peut franchir QUE si la ligne discontinue est de NOTRE c√¥t√©</li>
                            <li><strong>Exemple :</strong> En mont√©e, ligne continue c√¥t√© montant (pas de d√©passement), discontinue c√¥t√© descendant (d√©passement autoris√©)</li>
                        </ul>
                        
                        <p><strong>4Ô∏è‚É£ Ligne de rive (continue fine)</strong></p>
                        <ul>
                            <li>D√©limite la chauss√©e de l'accotement</li>
                            <li>Franchissement autoris√© en cas de n√©cessit√© (√©viter obstacle)</li>
                        </ul>
                        
                        <p><strong>5Ô∏è‚É£ Ligne d'arr√™t (stop)</strong></p>
                        <ul>
                            <li>Large barre blanche continue</li>
                            <li>Positionn√©e avant STOP ou feu rouge</li>
                            <li>Arr√™t obligatoire AVANT cette ligne</li>
                        </ul>
                        
                        <p><strong>6Ô∏è‚É£ Ligne d'effet (c√©dez le passage)</strong></p>
                        <ul>
                            <li>Ligne discontinue de gros traits</li>
                            <li>Avant "C√©dez le passage"</li>
                            <li>Ralentissement obligatoire, c√©der le passage</li>
                        </ul>
</div>
                    
                    <div class="highlight-box">
                        <h4>Les marquages sp√©ciaux</h4>
                        
                        <ul>
                            <li><strong>Fl√®ches directionnelles :</strong> Indiquent les directions autoris√©es par voie</li>
                            <li><strong>Z√©bras (√Ælot) :</strong> Zone neutre, franchissement interdit sauf urgence</li>
                            <li><strong>Passages pi√©tons :</strong> Bandes blanches parall√®les √† la chauss√©e</li>
                            <li><strong>Zones hachur√©es :</strong> Stationnement et circulation interdits</li>
                            <li><strong>Zig-zag :</strong> Arr√™t de bus, arr√™t et stationnement interdits</li>
                            <li><strong>Ligne jaune :</strong> Stationnement ET arr√™t interdits (g√©n√©ralement arr√™t de bus)</li>
                            <li><strong>Bande cyclable :</strong> D√©limit√©e par ligne discontinue, r√©serv√©e cycles</li>
                            <li><strong>Voie bus :</strong> Marquage "BUS" au sol, r√©serv√©e transports en commun</li>
                            <li><strong>Cases motos :</strong> Zone avanc√©e pour deux-roues aux feux</li>
                        </ul>
</div>
                    
                    <h3>üö¶ Les feux tricolores et signaux lumineux</h3>
                    
                    <div class="highlight-box">
                        <h4>Feux de circulation (R11, R12)</h4>
                        
                        <p><strong>üî¥ Feu ROUGE fixe</strong></p>
                        <ul>
                            <li>Arr√™t OBLIGATOIRE avant la ligne d'arr√™t (ou avant le feu si pas de ligne)</li>
                            <li>Attendre le feu vert pour repartir</li>
                            <li>Griller feu rouge = 135‚Ç¨ + 4 points + suspension possible</li>
                        </ul>
                        
                        <p><strong>üü† Feu ORANGE (ambre) fixe</strong></p>
                        <ul>
                            <li>Arr√™t obligatoire SI on peut s'arr√™ter en s√©curit√©</li>
                            <li>Passage autoris√© si arr√™t impossible sans danger</li>
                            <li>Dur√©e : 3 √† 5 secondes selon vitesse autoris√©e</li>
                        </ul>
                        
                        <p><strong>üü¢ Feu VERT fixe</strong></p>
                        <ul>
                            <li>Passage autoris√©</li>
                            <li>MAIS rester vigilant (pi√©tons retardataires, v√©hicules bloqu√©s)</li>
                            <li>C√©der passage aux v√©hicules encore engag√©s dans l'intersection</li>
                        </ul>
                        
                        <p><strong>üü† Feu ORANGE clignotant</strong></p>
                        <ul>
                            <li>Prudence, danger √† proximit√©</li>
                            <li>Souvent sur carrefours dangereux la nuit</li>
                            <li>R√®gles de priorit√© normales s'appliquent</li>
                        </ul>
                        
                        <p><strong>‚û°Ô∏è Fl√®ches directionnelles</strong></p>
                        <ul>
                            <li>Fl√®che verte : Autorisation de circuler dans cette direction uniquement</li>
                            <li>Fl√®che rouge : Interdiction direction</li>
                            <li>Fl√®che orange : S'arr√™ter si possible</li>
                        </ul>
</div>
                    
                    <div class="highlight-box danger">
                        <h4>Feux sp√©ciaux</h4>
                        
                        <ul>
                            <li><strong>Feux clignotants jaunes :</strong> Attention, danger (√©coles, passages pi√©tons)</li>
                            <li><strong>Feu rouge R24 :</strong> Signalisation temporaire (travaux, p√©ages)</li>
                            <li><strong>Feux pi√©tons :</strong> Bonhomme vert/rouge</li>
                            <li><strong>Feux pour cyclistes :</strong> Petit v√©lo vert/rouge</li>
                            <li><strong>Feux tramway :</strong> Barre blanche verticale/horizontale</li>
                            <li><strong>Panneaux √† messages variables :</strong> Informations en temps r√©el (bouchons, accidents, limitations temporaires)</li>
                        </ul>
                    </div>
                    
                    <h3>‚öñÔ∏è Hi√©rarchie de la signalisation</h3>
                    
                    <p>En cas de contradiction entre plusieurs signalisations, l'ordre de priorit√© est :</p>
                    
                    <ol>
                        <li><strong>üöî Agent de police / Gendarme</strong>
                            <ul>
                                <li>Les gestes des forces de l'ordre pr√©valent sur TOUT</li>
                                <li>Bras lev√© = arr√™t pour tous</li>
                                <li>Bras tendu = circulation perpendiculaire au bras</li>
                            </ul>
                        </li>
                        <li><strong>üö¶ Feux tricolores</strong>
                            <ul>
                                <li>Pr√©valent sur panneaux et marquages</li>
                                <li>Si feu en panne : appliquer les r√®gles des panneaux/priorit√©s</li>
                            </ul>
                        </li>
                        <li><strong>üõë Panneaux de signalisation</strong>
                            <ul>
                                <li>Pr√©valent sur marquages au sol</li>
                                <li>Temporaires (jaunes) > permanents</li>
                            </ul>
                        </li>
                        <li><strong>üõ£Ô∏è Marquages au sol</strong>
                            <ul>
                                <li>Compl√®tent les panneaux</li>
                                <li>Jaunes (temporaires) > blancs (permanents)</li>
                            </ul>
                        </li>
                        <li><strong>üìè R√®gles du code de la route</strong>
                            <ul>
                                <li>R√®gles par d√©faut si aucune signalisation</li>
                                <li>Ex: priorit√© √† droite</li>
                            </ul>
                        </li>
                    </ol>
                    
                    <div class="highlight-box success">
                        <h4>üí° Points cl√©s √† retenir</h4>
                        <ul>
                            <li>Triangle rouge = DANGER (jamais interdiction)</li>
                            <li>Rond rouge = INTERDICTION</li>
                            <li>Rond bleu = OBLIGATION</li>
                            <li>Ligne continue = INTERDIT de franchir</li>
                            <li>Feu orange = S'arr√™ter SI POSSIBLE</li>
                            <li>Agent de police > Tout le reste</li>
                            <li>Signalisation temporaire (jaune) > permanente (blanc)</li>
                        </ul>
                    </div>
`
            },
            {
                id: 2,
                icon: 'üîÑ',
                title: 'Priorit√©s',
                desc: 'Intersections, giratoires, STOP',
                content: `
                    <h2>üîÑ Priorit√©s et Intersections - Guide Exhaustif</h2>
                    
                    <p>Les r√®gles de priorit√© permettent d'organiser la circulation aux intersections et d'√©viter les accidents. Leur non-respect est la cause de 20% des accidents mortels.</p>
                    
                    <h3>üìê La Priorit√© √† Droite - R√®gle Fondamentale</h3>
                    
                    <div class="highlight-box">
                        <h4>Principe de base (Article R415-5)</h4>
                        <p><strong>√Ä une intersection SANS signalisation particuli√®re, vous devez c√©der le passage aux v√©hicules venant de votre DROITE.</strong></p>
                        
                        <p><strong>Conditions d'application :</strong></p>
                        <ul>
                            <li>Intersection de routes de m√™me cat√©gorie (rue/rue, route/route)</li>
                            <li>Absence de signalisation (pas de feu, pas de panneau, pas d'agent)</li>
                            <li>V√©hicule arrivant effectivement de la droite</li>
                            <li>Les deux v√©hicules arrivent en m√™me temps ou presque</li>
                        </ul>
                        
                        <p><strong>Comment appliquer :</strong></p>
                        <ol>
                            <li>Ralentir en approchant l'intersection</li>
                            <li>Regarder √† droite ET √† gauche</li>
                            <li>Si v√©hicule √† droite : s'arr√™ter et c√©der passage</li>
                            <li>Si pas de v√©hicule √† droite : passer avec prudence</li>
                            <li>Rester vigilant m√™me avec priorit√© (l'autre peut ne pas respecter)</li>
                        </ol>
</div>
                    
                    <div class="highlight-box danger">
                        <h4>‚ö†Ô∏è CAS O√ô LA PRIORIT√â √Ä DROITE NE S'APPLIQUE PAS</h4>
                        
                        <p><strong>1. Sortie de lieu priv√© vers voie publique</strong></p>
                        <ul>
                            <li>Parking priv√©, garage, chemin priv√©, propri√©t√© priv√©e</li>
                            <li>Station-service, aire de repos priv√©e</li>
                            <li>‚Üí Vous c√©dez TOUJOURS le passage √† TOUS les v√©hicules sur la voie publique</li>
                            <li>M√™me s'ils viennent de votre gauche !</li>
                        </ul>
                        
                        <p><strong>2. Route prioritaire (panneau losange jaune)</strong></p>
                        <ul>
                            <li>Sur la route prioritaire : vous avez priorit√©</li>
                            <li>Sur route secondaire : vous devez c√©der passage</li>
                            <li>Fin de priorit√© : panneau losange barr√©</li>
                        </ul>
                        
                        <p><strong>3. Pr√©sence de panneaux STOP ou C√©dez le passage</strong></p>
                        <ul>
                            <li>Panneau STOP : arr√™t obligatoire + c√©der passage √† tous</li>
                            <li>Panneau C√©dez le passage : ralentir + c√©der si v√©hicule</li>
                        </ul>
                        
                        <p><strong>4. Giratoire avec panneau "C√©dez le passage"</strong></p>
                        <ul>
                            <li>Priorit√© aux v√©hicules DANS le giratoire</li>
                            <li>Pas de priorit√© √† droite √† l'int√©rieur</li>
                        </ul>
                        
                        <p><strong>5. Pr√©sence de feux tricolores</strong></p>
                        <ul>
                            <li>Feux > panneaux > priorit√© √† droite</li>
                        </ul>
                        
                        <p><strong>6. V√©hicules prioritaires (gyrophare bleu + sir√®ne)</strong></p>
                        <ul>
                            <li>Police, pompiers, SAMU, gendarmerie</li>
                            <li>Priorit√© ABSOLUE sur tous</li>
                        </ul>
</div>
                    
                    <h3>üîÑ Les Giratoires et Ronds-Points</h3>
                    
                    <div class="highlight-box">
                        <h4>Diff√©rence GIRATOIRE vs ROND-POINT</h4>
                        
                        <p><strong>GIRATOIRE (99% des cas en France)</strong></p>
                        <ul>
                            <li><strong>Signalisation :</strong> Panneau "C√©dez le passage" √† l'entr√©e + panneau sens giratoire obligatoire</li>
                            <li><strong>Priorit√© :</strong> V√©hicules DANS le giratoire ont la priorit√©</li>
                            <li><strong>R√®gle :</strong> Vous c√©dez le passage en entrant</li>
                            <li><strong>Circulation :</strong> Sens inverse des aiguilles d'une montre</li>
                            <li><strong>√élot central :</strong> Souvent infranchissable (sauf v√©hicules longs)</li>
                        </ul>
                        
                        <p><strong>ROND-POINT (tr√®s rares)</strong></p>
                        <ul>
                            <li><strong>Signalisation :</strong> Aucun panneau OU panneau prioritaire</li>
                            <li><strong>Priorit√© :</strong> Priorit√© √† droite = v√©hicules ENTRANT ont priorit√©</li>
                            <li><strong>R√®gle :</strong> Ceux dans le rond-point doivent c√©der</li>
                            <li><strong>Quasi inexistants</strong> aujourd'hui (remplac√©s par giratoires)</li>
                        </ul>
                        
                        <p><strong>‚ö†Ô∏è PI√àGE √Ä L'EXAMEN :</strong> Si panneau "C√©dez le passage" ‚Üí GIRATOIRE ‚Üí priorit√© aux v√©hicules DANS</p>
</div>
                    
                    <div class="highlight-box success">
                        <h4>Comment bien n√©gocier un giratoire</h4>
                        
                        <p><strong>AVANT d'entrer :</strong></p>
                        <ol>
                            <li>Ralentir en approchant</li>
                            <li>Regarder √† GAUCHE (v√©hicules dans le giratoire)</li>
                            <li>C√©der le passage si v√©hicule</li>
                            <li>S'engager quand libre</li>
                            <li>Pas de clignotant en entrant (sauf si vous tournez imm√©diatement)</li>
                        </ol>
                        
                        <p><strong>DANS le giratoire :</strong></p>
                        <ul>
                            <li>Rester sur votre voie (ext√©rieure si sortie proche, int√©rieure si loin)</li>
                            <li>Ne pas couper les voies</li>
                            <li>Surveiller angles morts (motos, v√©los)</li>
                            <li>Pas de clignotant tant que vous continuez</li>
                        </ul>
                        
                        <p><strong>SORTIE du giratoire :</strong></p>
                        <ol>
                            <li><strong>Clignotant √† DROITE</strong> d√®s que vous d√©passez la sortie AVANT celle que vous prenez</li>
                            <li>Se rabattre vers la droite</li>
                            <li>V√©rifier angle mort droit</li>
                            <li>Sortir</li>
                        </ol>
                        
                        <p><strong>Cas particuliers :</strong></p>
                        <ul>
                            <li><strong>Voiture longue (camion, bus) :</strong> Peut mordre l'√Ælot central si n√©cessaire</li>
                            <li><strong>Giratoire √† 2 voies :</strong> Voie ext√©rieure = sorties proches, voie int√©rieure = sorties lointaines</li>
                            <li><strong>V√©lo dans giratoire :</strong> M√™me r√®gle, mais restez vigilant (ils sont plus lents)</li>
                        </ul>
                        
                        <p><strong>‚ùå ERREURS FR√âQUENTES :</strong></p>
                        <ul>
                            <li>Clignotant √† gauche en entrant (inutile et perturbant)</li>
                            <li>Ne pas mettre clignotant √† droite pour sortir</li>
                            <li>Couper les voies</li>
                            <li>S'arr√™ter dans le giratoire sans raison</li>
                            <li>Penser qu'on a priorit√© en entrant</li>
                        </ul>
</div>
                    
                    <h3>üõë Le Panneau STOP - Arr√™t Obligatoire</h3>
                    
                    <div class="highlight-box danger">
                        <h4>R√®gles du STOP (Article R415-6)</h4>
                        
                        <p><strong>Forme unique :</strong> Octogone (8 c√¥t√©s) rouge avec "STOP" blanc - seul panneau octogonal</p>
                        
                        <p><strong>Obligation :</strong></p>
                        <ul>
                            <li><strong>ARR√äT COMPLET ET MARQU√â obligatoire</strong></li>
                            <li>Arr√™t AVANT la ligne blanche (si pr√©sente)</li>
                            <li>Arr√™t AVANT le panneau (si pas de ligne)</li>
                            <li>Immobilisation du v√©hicule (roues arr√™t√©es)</li>
                            <li>Dur√©e minimum : ~3 secondes (temps de regarder des 2 c√¥t√©s)</li>
                        </ul>
                        
                        <p><strong>Apr√®s l'arr√™t :</strong></p>
                        <ol>
                            <li>Regarder √† gauche</li>
                            <li>Regarder √† droite</li>
                            <li>Re-regarder √† gauche</li>
                            <li>C√©der le passage √† TOUS les v√©hicules (m√™me venant de gauche)</li>
                            <li>S'engager uniquement quand d√©gag√©</li>
                        </ol>
                        
                        <p><strong>‚ö†Ô∏è Erreurs sanctionn√©es :</strong></p>
                        <ul>
                            <li><strong>Ralentir sans s'arr√™ter :</strong> 135‚Ç¨ + 4 points</li>
                            <li><strong>S'arr√™ter apr√®s le STOP :</strong> 135‚Ç¨ + 4 points</li>
                            <li><strong>Ne pas s'arr√™ter :</strong> 135‚Ç¨ + 4 points + suspension possible</li>
                            <li>STOP = m√™me sanction que feu rouge !</li>
                        </ul>
                        
                        <p><strong>Cas particuliers :</strong></p>
                        <ul>
                            <li><strong>STOP + feu rouge :</strong> S'arr√™ter au feu d'abord, puis respecter STOP si feu devient vert</li>
                            <li><strong>STOP sur autoroute/voie rapide :</strong> N'existe normalement PAS (sauf travaux)</li>
                            <li><strong>Plusieurs v√©hicules au STOP :</strong> Chacun s'arr√™te √† son tour, priorit√© au premier arriv√©</li>
                        </ul>
</div>
                    
                    <h3>‚ö†Ô∏è Le Panneau "C√©dez le Passage" (AB4)</h3>
                    
                    <div class="highlight-box">
                        <h4>Caract√©ristiques</h4>
                        
                        <p><strong>Forme unique :</strong> Triangle pointe EN BAS, bordure rouge, fond blanc - SEUL panneau avec pointe vers le bas</p>
                        
                        <p><strong>Signification :</strong></p>
                        <ul>
                            <li>Ralentir √† l'approche</li>
                            <li>C√©der le passage aux v√©hicules circulant sur la route prioritaire</li>
                            <li><strong>MAIS : arr√™t pas forc√©ment obligatoire</strong> (si route d√©gag√©e, vous pouvez passer sans vous arr√™ter)</li>
                        </ul>
                        
                        <p><strong>Diff√©rence avec STOP :</strong></p>
                        <ul>
                            <li>STOP = arr√™t OBLIGATOIRE m√™me si personne</li>
                            <li>C√©dez = arr√™t UNIQUEMENT si v√©hicule prioritaire</li>
                            <li>C√©dez = 90‚Ç¨ + 4 points si non-respect</li>
                        </ul>
                        
                        <p><strong>Marquage associ√© :</strong></p>
                        <ul>
                            <li>Ligne discontinue de gros traits (ligne d'effet)</li>
                            <li>Indique o√π ralentir/s'arr√™ter si n√©cessaire</li>
                        </ul>
                        
                        <p><strong>Utilisation courante :</strong></p>
                        <ul>
                            <li>Entr√©e de giratoire (99% des cas)</li>
                            <li>Intersection avec route prioritaire</li>
                            <li>Sortie d'autoroute sur route secondaire</li>
                        </ul>
</div>
                    
                    <h3>üö® V√©hicules Prioritaires</h3>
                    
                    <div class="highlight-box danger">
                        <h4>V√©hicules d'urgence (Article R432-1)</h4>
                        
                        <p><strong>Qui sont-ils ?</strong></p>
                        <ul>
                            <li>Police nationale et municipale</li>
                            <li>Gendarmerie</li>
                            <li>Pompiers (SDIS)</li>
                            <li>SAMU / Ambulances agr√©√©es SMUR</li>
                            <li>Douanes (dans certains cas)</li>
                        </ul>
                        
                        <p><strong>Signaux :</strong></p>
                        <ul>
                            <li><strong>Gyrophare bleu</strong> + <strong>sir√®ne deux tons</strong> = priorit√© ABSOLUE</li>
                            <li>Gyrophare seul (sans sir√®ne) = PAS prioritaire (simple signalisation)</li>
                            <li>V√©hicule √† l'arr√™t = PAS prioritaire</li>
                        </ul>
                        
                        <p><strong>Votre obligation :</strong></p>
                        <ol>
                            <li><strong>Faciliter le passage</strong> du v√©hicule prioritaire</li>
                            <li>Se ranger sur le c√¥t√© si possible</li>
                            <li>S'arr√™ter si n√©cessaire</li>
                            <li>Ralentir pour les laisser passer</li>
                            <li><strong>Ne JAMAIS les suivre</strong> pour griller un feu ou passer</li>
                        </ol>
                        
                        <p><strong>‚ö†Ô∏è Ce qui est INTERDIT :</strong></p>
                        <ul>
                            <li>Suivre le v√©hicule prioritaire pour passer un feu rouge</li>
                            <li>Suivre pour contourner bouchon</li>
                            <li>Klaxonner ou faire des appels de phares vers eux</li>
                            <li>G√™ner leur passage volontairement</li>
                        </ul>
                        
                        <p><strong>Sanctions si non-respect :</strong></p>
                        <ul>
                            <li>Non-priorit√© v√©hicule urgence : 135‚Ç¨ + 4 points</li>
                            <li>Suivre v√©hicule prioritaire feu rouge : 135‚Ç¨ + 4 points (feu rouge) + 90‚Ç¨ (non-respect priorit√©)</li>
                        </ul>
                        
                        <p><strong>Cas particuliers :</strong></p>
                        <ul>
                            <li><strong>Convoi exceptionnel :</strong> Gyrophare orange, pas de priorit√© (mais faciliter passage)</li>
                            <li><strong>V√©hicule de s√©curit√© :</strong> Orange, pas prioritaire</li>
                            <li><strong>V√©hicule entretien :</strong> Orange, pas prioritaire</li>
                        </ul>
                    </div>
                    
                    <h3>üö∂ Priorit√©s Pi√©tons</h3>
                    
                    <div class="highlight-box success">
                        <h4>Passages pi√©tons (Article R415-11)</h4>
                        
                        <p><strong>R√®gle absolue :</strong> Le pi√©ton est TOUJOURS prioritaire sur passage pi√©ton</p>
                        
                        <p><strong>Situations :</strong></p>
                        <ul>
                            <li><strong>Pi√©ton engag√© :</strong> Priorit√© ABSOLUE, arr√™t obligatoire</li>
                            <li><strong>Pi√©ton manifeste intention de traverser :</strong> C√©der le passage obligatoire</li>
                            <li><strong>Pi√©ton attend sur trottoir :</strong> Ralentir et √™tre pr√™t √† s'arr√™ter</li>
                        </ul>
                        
                        <p><strong>Sanctions :</strong></p>
                        <ul>
                            <li>Non-respect priorit√© pi√©ton : 135‚Ç¨ + 6 points</li>
                            <li>+ Suspension permis possible</li>
                            <li>Si accident : d√©lit possible</li>
                        </ul>
                        
                        <p><strong>Zones de priorit√© pi√©tonne :</strong></p>
                        <ul>
                            <li><strong>Zone de rencontre :</strong> Pi√©tons prioritaires partout, 20 km/h max</li>
                            <li><strong>Aire pi√©tonne :</strong> Pi√©tons prioritaires, v√©hicules autoris√©s √† vitesse pas (sauf si interdit)</li>
                            <li><strong>Zone 30 :</strong> Pas de priorit√© pi√©ton sauf passage clout√©</li>
                        </ul>
                    </div>
                    
                    <h3>üí° Cas Complexes et Situations Sp√©ciales</h3>
                    
                    <div class="highlight-box">
                        <h4>Intersection √† 4 STOP</h4>
                        <p>Tous les v√©hicules doivent s'arr√™ter. Priorit√© au premier arriv√©. Si arriv√©e simultan√©e : priorit√© √† droite entre eux.</p>
                        
                        <h4>Changement de direction</h4>
                        <ul>
                            <li><strong>Tourner √† gauche :</strong> C√©der passage v√©hicules en face allant tout droit ou tournant √† droite</li>
                            <li><strong>Tourner √† droite :</strong> C√©der passage pi√©tons et cyclistes sur votre droite</li>
                            <li><strong>Demi-tour :</strong> C√©der passage √† TOUS les v√©hicules</li>
                        </ul>
                        
                        <h4>Routes √† chauss√©es s√©par√©es</h4>
                        <p>Chaque chauss√©e = intersection diff√©rente. Traiter s√©par√©ment.</p>
                        
                        <h4>Marche arri√®re</h4>
                        <p>V√©hicule en marche arri√®re n'a JAMAIS la priorit√©. Doit c√©der √† tous.</p>
                        
                        <h4>Sortie de parking / station-service</h4>
                        <p>C√©der passage √† TOUS v√©hicules sur voie publique (m√™me venant de gauche).</p>
                    </div>
                    
                    <div class="highlight-box danger">
                        <h4>‚ö†Ô∏è Points cl√©s √† retenir</h4>
                        <ul>
                            <li>Panneau "C√©dez le passage" √† l'entr√©e de giratoire = priorit√© aux v√©hicules DANS</li>
                            <li>STOP = arr√™t complet OBLIGATOIRE m√™me si personne</li>
                            <li>Triangle pointe en BAS = C√©dez le passage (seul panneau comme √ßa)</li>
                            <li>V√©hicule prioritaire = gyrophare bleu + sir√®ne</li>
                            <li>Pi√©ton sur passage = priorit√© ABSOLUE</li>
                            <li>Sortie parking = c√©der √† TOUS</li>
                            <li>Tourner √† gauche = c√©der aux v√©hicules en face</li>
                        </ul>
                    </div>
`
            },
            {
                id: 3,
                icon: 'üöÄ',
                title: 'Vitesses',
                desc: 'Limitations, distances, freinage',
                content: `
                    <h2>üöÄ Vitesses et Distances - Tout pour ma√Ætriser</h2>
                    
                    <p>La vitesse est la premi√®re cause de mortalit√© sur la route. Conna√Ætre les limites et les distances, c‚Äôest prot√©ger tout le monde. Ce cours reprend les r√®gles du Code de la route (art. R413 et suivants) de fa√ßon ludique.</p>
                    
                    <h3>üèôÔ∏è En agglom√©ration</h3>
                    
                    <div class="highlight-box">
                        <h4>50 km/h par d√©faut</h4>
                        <p>D√®s que vous voyez le panneau blanc avec le nom de la commune, vous √™tes en agglom√©ration : <strong>50 km/h maximum</strong> sauf signalisation contraire.</p>
                        <ul>
                            <li><strong>Zone 30 :</strong> Panneau ou marquage ¬´ zone 30 ¬ª ‚Üí 30 km/h (√©coles, zones r√©sidentielles).</li>
                            <li><strong>Zone de rencontre :</strong> 20 km/h, pi√©tons prioritaires.</li>
                            <li><strong>70 km/h :</strong> Possible sur certaines voies (panneau explicite).</li>
                        </ul>
                        <p><strong>üéØ √Ä retenir :</strong> Pas de panneau = 50 km/h en ville.</p>
                    </div>
                    
                    <h3>üõ£Ô∏è Hors agglom√©ration</h3>
                    
                    <div class="highlight-box">
                        <h4>Routes √† double sens (2 voies)</h4>
                        <p><strong>80 km/h par d√©faut</strong> (r√©forme 2018). Certains d√©partements ont remis 90 km/h par panneau.</p>
                        <ul>
                            <li><strong>Temps sec :</strong> 80 ou 90 km/h selon panneaux.</li>
                            <li><strong>Temps de pluie :</strong> 80 km/h max (m√™me si panneau 90).</li>
                        </ul>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>Routes √† 2 chauss√©es s√©par√©es (4 voies)</h4>
                        <p><strong>110 km/h</strong> temps sec, <strong>100 km/h</strong> par temps de pluie.</p>
                    </div>
                    
                    <div class="highlight-box success">
                        <h4>Autoroutes</h4>
                        <p><strong>130 km/h</strong> temps sec ‚Ä¢ <strong>110 km/h</strong> temps de pluie.</p>
                        <p><strong>Visibilit√© &lt; 50 m (brouillard, neige) :</strong> <strong>50 km/h maximum</strong> sur toutes les routes (y compris autoroute) + feux de brouillard avant si n√©cessaire.</p>
                        <p><strong>üí° Astuce examen :</strong> ¬´ Pluie = -20 km/h sur autoroute et 2√ó2 voies. ¬ª</p>
                    </div>
                    
                    <h3>üÜï Permis probatoire (moins de 3 ans)</h3>
                    <div class="highlight-box danger">
                        <h4>Limitations sp√©cifiques</h4>
                        <ul>
                            <li><strong>Autoroute :</strong> 110 km/h (au lieu de 130).</li>
                            <li><strong>2√ó2 voies :</strong> 100 km/h (au lieu de 110).</li>
                            <li><strong>Disque ¬´ A ¬ª</strong> obligatoire √† l‚Äôarri√®re pendant 1 an (sauf si AAC).</li>
                        </ul>
                        <p><strong>‚ùå Pi√®ge :</strong> M√™me sous la pluie, le jeune conducteur reste √† 110 km/h sur autoroute (pas 100).</p>
                    </div>
                    
                    <h3>üìè Distance de s√©curit√© : la r√®gle des 2 secondes</h3>
                    
                    <div class="highlight-box success">
                        <h4>Minimum l√©gal : 2 secondes (art. R412-12)</h4>
                        <p><strong>Comment la mesurer en pratique ?</strong></p>
                        <ol>
                            <li>Le v√©hicule devant passe un rep√®re fixe (poteau, ombre, marque au sol).</li>
                            <li>Vous comptez : <strong>¬´ 1001, 1002 ¬ª</strong> (2 secondes).</li>
                            <li>Vous ne devez pas atteindre ce rep√®re avant d‚Äôavoir fini.</li>
                        </ol>
                        <p><strong>Pluie, brouillard, fatigue :</strong> Passez √† <strong>3 ou 4 secondes</strong>. Plus vous roulez vite, plus la distance en m√®tres augmente !</p>
                        <p><strong>üéØ En 1 phrase :</strong> 2 secondes = votre file d‚Äôattente de s√©curit√©.</p>
                    </div>
                    
                    <h3>üõë Distances de freinage (ordre de grandeur)</h3>
                    
                    <div class="highlight-box danger">
                        <h4>Temps sec (r√©action 1 s + freinage)</h4>
                        <ul>
                            <li>50 km/h ‚Üí ~28 m (dont ~14 m de freinage)</li>
                            <li>90 km/h ‚Üí ~73 m (dont ~45 m de freinage)</li>
                            <li>130 km/h ‚Üí ~138 m (dont ~93 m de freinage)</li>
                        </ul>
                        <p><strong>‚ö†Ô∏è Par temps de pluie :</strong> distance de freinage environ <strong>√ó 2</strong>.</p>
                        <p><strong>‚ö†Ô∏è Neige / verglas :</strong> jusqu‚Äô√† <strong>√ó 10</strong>. Ralentir fortement et garder les distances.</p>
                        <p><strong>üí° Le saviez-vous ?</strong> Au double de la vitesse, la distance de freinage est environ multipli√©e par 4.</p>
                    </div>
                    
                    <h3>üìã R√©cap ludique</h3>
                    <div class="highlight-box">
                        <h4>üéØ √Ä retenir pour l‚Äôexamen</h4>
                        <ul>
                            <li>Ville = 50 ‚Ä¢ Route 2 voies = 80 ‚Ä¢ 2√ó2 voies = 110 ‚Ä¢ Autoroute = 130.</li>
                            <li>Pluie = -20 km/h sur autoroute et 2√ó2 voies.</li>
                            <li>Distance de s√©curit√© = 2 secondes minimum (3‚Äì4 si pluie).</li>
                            <li>Permis &lt; 3 ans : 110 sur autoroute, 100 sur 2√ó2 voies.</li>
                        </ul>
                    </div>
`
            },
            {
                id: 4,
                icon: 'üÖøÔ∏è',
                title: 'Stationnement',
                desc: 'Arr√™t vs stationnement, interdictions',
                content: `
                    <h2>üÖøÔ∏è Stationnement et Arr√™t - Bien se garer sans infraction</h2>
                    
                    <p>Arr√™t et stationnement ne se d√©finissent pas par la dur√©e, mais par ce que vous faites. Une fois la r√®gle comprise, les questions deviennent faciles (art. R110-2 et R417).</p>
                    
                    <h3>üîÑ Arr√™t vs stationnement : la vraie diff√©rence</h3>
                    
                    <div class="highlight-box danger">
                        <h4>‚ùå PI√àGE EXAMEN : Ce n‚Äôest pas la dur√©e qui compte !</h4>
                        
                        <p><strong>ARR√äT</strong> = immobilisation courte avec le conducteur <strong>aux commandes ou tout √† c√¥t√©</strong>, capable de repartir tout de suite.</p>
                        <ul>
                            <li>Monter / descendre des personnes.</li>
                            <li>Charger / d√©charger (courte op√©ration).</li>
                            <li>Conducteur reste au volant ou √† proximit√© imm√©diate.</li>
                        </ul>
                        
                        <p><strong>STATIONNEMENT</strong> = toute autre immobilisation.</p>
                        <ul>
                            <li>Conducteur s‚Äô√©loigne (m√™me pour acheter du pain 30 secondes).</li>
                            <li>Moteur coup√©, cl√© en poche = en g√©n√©ral du stationnement.</li>
                            <li><strong>M√™me 1 minute = stationnement si vous quittez la voiture !</strong></li>
                        </ul>
                        <p><strong>üéØ En 1 phrase :</strong> Vous partez du v√©hicule ‚Üí c‚Äôest du stationnement.</p>
                    </div>
                    
                    <h3>üö´ O√π le stationnement est interdit ?</h3>
                    
                    <div class="highlight-box">
                        <h4>Liste √† conna√Ætre (art. R417)</h4>
                        <ul>
                            <li><strong>Passages pi√©tons :</strong> sur le passage et <strong>5 m avant</strong> (pour la visibilit√©).</li>
                            <li><strong>Bouches d‚Äôincendie :</strong> devant et √† proximit√©.</li>
                            <li><strong>Bandes et pistes cyclables.</strong></li>
                            <li><strong>Entr√©es de propri√©t√©s</strong> (garage, portail) sans accord du propri√©taire.</li>
                            <li><strong>Emplacements r√©serv√©s :</strong> handicap, livraison, taxi (sauf si c‚Äôest le v√¥tre).</li>
                            <li><strong>Tunnels.</strong></li>
                            <li><strong>√Ä moins de 5 m d‚Äôun passage pi√©ton</strong> (c√¥t√© approche).</li>
                            <li><strong>√Ä moins de 5 m d‚Äôune intersection</strong> (sauf si marquage autorise).</li>
                            <li><strong>Zig-zag</strong> (arr√™t de bus) : arr√™t et stationnement interdits.</li>
                            <li><strong>Ligne jaune</strong> au sol : arr√™t et stationnement interdits.</li>
                        </ul>
                    </div>
<div class="highlight-box success">
                        <h4>üÖøÔ∏è Trottoir (art. R417-10)</h4>
                        <p><strong>Par d√©faut : stationnement sur trottoir INTERDIT.</strong></p>
                        <p>Autoris√© <strong>uniquement</strong> si :</p>
                        <ul>
                            <li>Un marquage au sol le pr√©voit (places dessin√©es, etc.) ;</li>
                            <li>Et il reste <strong>au moins 1,50 m</strong> pour les pi√©tons.</li>
                        </ul>
                        <p><strong>üí° Astuce :</strong> Pas de marquage = pas de stationnement sur le trottoir.</p>
                    </div>
                    
                    <h3>‚ö†Ô∏è G√™nant vs dangereux : les sanctions</h3>
                    
                    <div class="highlight-box danger">
                        <h4>Stationnement g√™nant (ex. 35 ‚Ç¨)</h4>
                        <p>Exemples : chauss√©e la nuit sans √©clairage, devant une entr√©e, double file, etc.</p>
                        
                        <h4>Stationnement dangereux (135 ‚Ç¨ + 3 points)</h4>
                        <p>Exemples : dans un virage, sur une bande d‚Äôarr√™t d‚Äôurgence (sauf urgence), sur une voie r√©serv√©e, visibilit√© r√©duite pour les autres.</p>
                        
                        <p><strong>Arr√™t et stationnement interdits (panneau) :</strong> 35 ‚Ç¨ (stationnement interdit) ou 135 ‚Ç¨ (arr√™t et stationnement interdits) selon le panneau.</p>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>üéØ R√©cap √† retenir</h4>
                        <ul>
                            <li>Arr√™t = conducteur pr√©sent ou tout √† c√¥t√© ; stationnement = vous vous √©loignez.</li>
                            <li>5 m avant passage pi√©ton et avant intersection (sauf autorisation).</li>
                            <li>Trottoir = interdit sauf marquage + 1,50 m pour pi√©tons.</li>
                            <li>Dangereux = virage, bande d‚Äôarr√™t d‚Äôurgence, etc. ‚Üí 135 ‚Ç¨ + 3 points.</li>
                        </ul>
                    </div>
                `
            },
            {
                id: 5,
                icon: 'üë§',
                title: 'Conducteur',
                desc: 'Alcool, fatigue, t√©l√©phone, points',
                content: `
                    <h2>üë§ Le Conducteur - Alcool, fatigue, t√©l√©phone</h2>
                    
                    <p>Conduire exige d‚Äô√™tre en √©tat physique et mental de le faire. Le Code de la route (art. R234 et suivants) fixe des limites claires : les respecter, c‚Äôest prot√©ger sa vie et celle des autres.</p>
<h3>üç∑ Alcool au volant</h3>
                    
                    <div class="highlight-box danger">
                        <h4>üö® Taux maximum (art. R234-1)</h4>
                        <p><strong>Conducteur confirm√© : 0,5 g/L de sang</strong> (ou 0,25 mg/L d‚Äôair expir√©).</p>
                        <p><strong>Permis probatoire (&lt; 3 ans) : 0,2 g/L</strong> ‚Äî en pratique, <strong>z√©ro alcool</strong> recommand√©.</p>
                        <p>Un seul verre peut suffire √† d√©passer 0,2 g/L. Pour un jeune conducteur : pas d‚Äôalcool du tout.</p>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>Sanctions</h4>
                        <ul>
                            <li><strong>0,5 √† 0,8 g/L :</strong> 135 ‚Ç¨ + 6 points (contravention).</li>
                            <li><strong>√Ä partir de 0,8 g/L :</strong> d√©lit ‚Üí tribunal, amende jusqu‚Äô√† 4 500 ‚Ç¨, retrait de permis, prison possible.</li>
                            <li><strong>Refus de souffler :</strong> assimil√© √† alcool &gt; 0,8 ‚Üí m√™mes sanctions.</li>
                        </ul>
                    </div>
                    
                    <div class="highlight-box success">
                        <h4>üí° Le saviez-vous ?</h4>
                        <ul>
                            <li>Un verre ¬´ standard ¬ª ‚âà 10 g d‚Äôalcool (demi, ballon, shot).</li>
                            <li>L‚Äôorganisme √©limine environ <strong>0,15 g/L par heure</strong>. Seul le temps fait baisser le taux.</li>
                            <li>Caf√©, douche, sport ne font <strong>pas</strong> baisser l‚Äôalcool√©mie.</li>
                        </ul>
                        <p><strong>üéØ √Ä retenir :</strong> Permis &lt; 3 ans = 0,2 g/L max. Confirm√© = 0,5 g/L max.</p>
                    </div>
                    
                    <h3>üì± T√©l√©phone et distracteurs</h3>
                    
                    <div class="highlight-box danger">
                        <h4>Interdictions (art. R412-6-1)</h4>
                        <ul>
                            <li><strong>T√©l√©phone en main</strong> (m√™me √† l‚Äôarr√™t moteur allum√©) : interdit.</li>
                            <li><strong>Oreillette, √©couteurs, casque</strong> (musique ou appel) : interdit.</li>
                        </ul>
                        <p><strong>‚úÖ Autoris√© :</strong> kit mains-libres <strong>int√©gr√© au v√©hicule</strong> (sans tenir le t√©l√©phone).</p>
                        <p><strong>Sanction : 135 ‚Ç¨ + 3 points.</strong> En cas d‚Äôaccident, la responsabilit√© peut √™tre aggrav√©e.</p>
                        <p><strong>‚ùå Pi√®ge examen :</strong> ¬´ Oreillette ¬ª ou ¬´ √©couteur ¬ª = interdit, pas seulement ¬´ t√©l√©phone en main ¬ª.</p>
                    </div>
                    
                    <h3>üò¥ Fatigue</h3>
                    
                    <div class="highlight-box danger">
                        <h4>La fatigue est un facteur d‚Äôaccident majeur</h4>
                        <p><strong>Signes d‚Äôalerte :</strong> b√¢illements, paupi√®res lourdes, regard qui fixe, trajectoire qui d√©rive, oublis (clignotant, vitesse).</p>
                        <p><strong>Seule solution efficace : s‚Äôarr√™ter et se reposer.</strong></p>
                        <ul>
                            <li>Pause toutes les <strong>2 h</strong> minimum.</li>
                            <li>Micro-sieste <strong>15‚Äì20 min</strong> tr√®s efficace (sans d√©passer 30 min pour ne pas tomber en sommeil profond).</li>
                            <li>Le caf√© masque la fatigue mais ne la supprime pas.</li>
                        </ul>
                        <p><strong>üéØ En 1 phrase :</strong> D√®s les premiers signes ‚Üí aire de repos, pas ¬´ encore 50 km ¬ª.</p>
                    </div>
                    
                    <h3>üìÑ Permis √† points</h3>
                    
                    <div class="highlight-box">
                        <h4>Capital de points</h4>
                        <ul>
                            <li><strong>Permis d√©finitif :</strong> 12 points.</li>
                            <li><strong>Permis probatoire :</strong> 6 points au d√©part, puis +2 points par an sans infraction (ou +3 si AAC), jusqu‚Äô√† 12 apr√®s 3 ans (ou 2 ans en AAC).</li>
                        </ul>
                        
                        <h4>R√©cup√©ration des points</h4>
                        <ul>
                            <li><strong>Automatique :</strong> apr√®s un d√©lai sans nouvelle infraction (souvent 2 ou 3 ans selon la gravit√©).</li>
                            <li><strong>Stage de r√©cup√©ration :</strong> 4 points max, 1 stage par an, sous conditions.</li>
                        </ul>
                        <p><strong>üí° Astuce :</strong> Consulter son solde de points (t√©l√©points ou service d√©di√©).</p>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>üéØ R√©cap √† retenir</h4>
                        <ul>
                            <li>Alcool : 0,5 g/L (confirm√©), 0,2 g/L (probatoire). Refus de souffler = d√©lit.</li>
                            <li>T√©l√©phone : interdit en main, oreillette et casque interdits. Kit int√©gr√© seul autoris√©.</li>
                            <li>Fatigue : pause 2 h, micro-sieste 15‚Äì20 min. Caf√© ne remplace pas le sommeil.</li>
                            <li>Permis probatoire : 6 points, puis +2 ou +3 par an sans infraction.</li>
                        </ul>
                    </div>
                `
            },
            {
                id: 6,
                icon: 'üö∂',
                title: 'Autres usagers',
                desc: 'Pi√©tons, cyclistes, deux-roues, EDPM',
                content: `
                    <h2>üö∂ Les Autres Usagers - Partager la route</h2>
                    
                    <p>Pi√©tons, cyclistes, deux-roues et EDPM sont plus vuln√©rables. Le Code (art. R412 et R415) leur accorde des priorit√©s et des distances √† respecter. Bien les conna√Ætre = moins de risques et moins d‚Äôinfractions.</p>
<h3>üö∂ Pi√©tons</h3>
                    
                    <div class="highlight-box success">
                        <h4>Priorit√© sur les passages pi√©tons (art. R415-11)</h4>
                        <p><strong>Sur un passage pi√©ton (passage clout√©) :</strong></p>
                        <ul>
                            <li><strong>Pi√©ton engag√© :</strong> priorit√© absolue ‚Üí vous devez vous arr√™ter.</li>
                            <li><strong>Pi√©ton qui manifeste clairement l‚Äôintention de traverser :</strong> vous devez c√©der le passage (ralentir et vous arr√™ter si besoin).</li>
                            <li>Vous ne devez <strong>jamais</strong> d√©passer un v√©hicule qui s‚Äôest arr√™t√© pour un pi√©ton sur un passage.</li>
                            <li>Stationnement interdit <strong>5 m avant</strong> un passage pi√©ton.</li>
                        </ul>
                        <p><strong>Sanction :</strong> non-respect de la priorit√© pi√©ton ‚Üí 135 ‚Ç¨ + 6 points (et plus en cas d‚Äôaccident).</p>
                        <p><strong>Zone de rencontre (20 km/h) :</strong> les pi√©tons peuvent utiliser toute la chauss√©e et sont prioritaires.</p>
                    </div>
                    
                    <h3>üö¥ Cyclistes</h3>
                    
                    <div class="highlight-box">
                        <h4>Distances de d√©passement (art. R414-4)</h4>
                        <ul>
                            <li><strong>En agglom√©ration :</strong> au moins <strong>1 m</strong> entre vous et le cycliste.</li>
                            <li><strong>Hors agglom√©ration :</strong> au moins <strong>1,50 m</strong>.</li>
                        </ul>
                        <p>Si la chauss√©e est trop √©troite pour respecter cette distance, il faut <strong>ralentir</strong> et ne d√©passer que lorsque c‚Äôest possible en s√©curit√© (√©ventuellement en franchissant une ligne discontinue uniquement).</p>
                    </div>
                    
                    <div class="highlight-box danger">
                        <h4>Interdictions</h4>
                        <ul>
                            <li><strong>Franchir une ligne continue</strong> pour d√©passer un v√©lo ‚Üí interdit (m√™me pour laisser 1,50 m). Il faut attendre une zone en ligne discontinue.</li>
                            <li>Klaxonner pour ¬´ faire acc√©l√©rer ¬ª un cycliste (sauf danger imm√©diat).</li>
                            <li>Se rabattre trop t√¥t apr√®s un d√©passement.</li>
                        </ul>
                        <p><strong>üéØ √Ä retenir :</strong> 1 m en ville, 1,50 m hors ville. Ligne continue = pas de d√©passement du v√©lo.</p>
                    </div>
                    
                    <h3>üõ¥ Trottinettes et EDPM</h3>
                    
                    <div class="highlight-box">
                        <h4>EDPM = Engins de d√©placement personnels motoris√©s</h4>
                        <p>Trottinettes √©lectriques, monoroues, gyroroues, etc. (art. R412-43 et suivants).</p>
                        <ul>
                            <li><strong>Vitesse max :</strong> 25 km/h (constructeur). Au-del√†, l‚Äôengin est consid√©r√© comme un cyclomoteur.</li>
                            <li><strong>Assurance :</strong> obligatoire (responsabilit√© civile).</li>
                            <li><strong>O√π circuler :</strong> pistes et bandes cyclables quand il y en a ; sinon chauss√©e (hors agglom√©ration, autoroutes et voies vertes interdites).</li>
                            <li><strong>Trottoirs :</strong> interdits, sauf si la commune l‚Äôautorise (vitesse limit√©e, 6 km/h max) ou moteur coup√©.</li>
                            <li>Port du casque recommand√© ; gilet r√©tro-r√©fl√©chissant obligatoire la nuit hors agglom√©ration.</li>
                        </ul>
                    </div>
                    
                    <h3>üèçÔ∏è Deux-roues motoris√©s (motos, scooters)</h3>
                    
                    <div class="highlight-box danger">
                        <h4>Angles morts</h4>
                        <p>Les deux-roues sont souvent <strong>peu visibles</strong> dans les r√©troviseurs.</p>
                        <ul>
                            <li><strong>Avant de changer de voie ou de tourner :</strong> toujours v√©rifier l‚Äôangle mort (tourner la t√™te).</li>
                            <li>En ville, aux feux et en file : attention aux motos qui remontent entre les files (inter-file selon r√®gles locales).</li>
                        </ul>
                        <p><strong>Cases motos</strong> (zones avanc√©es aux feux) : r√©serv√©es aux deux-roues ; ne pas s‚Äôy engager en voiture.</p>
                    </div>
                    
                    <h3>üöÉ Tramway</h3>
                    <div class="highlight-box">
                        <p>Le tramway a la <strong>priorit√©</strong> sur les autres usagers, sauf signalisation contraire (feu, panneau). Ne pas couper sa trajectoire.</p>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>üéØ R√©cap √† retenir</h4>
                        <ul>
                            <li>Pi√©ton sur passage = priorit√© ; 5 m avant passage = pas de stationnement.</li>
                            <li>V√©lo : 1 m (ville), 1,50 m (hors ville) ; ligne continue = pas de d√©passement.</li>
                            <li>EDPM : 25 km/h max, assurance obligatoire, pas sur trottoir sauf autorisation.</li>
                            <li>Motos : angles morts, toujours v√©rifier avant de tourner ou changer de voie.</li>
                        </ul>
                    </div>
                `
            },
            {
                id: 7,
                icon: 'üåç',
                title: 'Environnement',
                desc: '√âco-conduite, Crit\'Air, ZFE',
                content: `
                    <h2>üåç Environnement et √âco-conduite</h2>
                    
                    <p>Conduire de fa√ßon plus sobre r√©duit la pollution, la consommation et souvent le stress. L‚Äôexamen du code aborde l‚Äô√©co-conduite et les r√®gles en zones √† faibles √©missions (ZFE).</p>
<h3>üíö L‚Äô√©co-conduite</h3>
                    
                    <div class="highlight-box success">
                        <h4>Jusqu‚Äô√† 20 % d‚Äô√©conomie de carburant</h4>
                        <p><strong>10 r√®gles d‚Äôor :</strong></p>
                        <ol>
                            <li><strong>Anticiper</strong> le trafic (feux, ralentissements) pour √©viter freinages et acc√©l√©rations inutiles.</li>
                            <li>Garder une <strong>vitesse stable</strong>.</li>
                            <li><strong>Passer les rapports t√¥t</strong> (vers 2 000‚Äì2 500 tr/min) pour limiter la consommation.</li>
                            <li><strong>Couper le moteur</strong> √† l‚Äôarr√™t si attente &gt; 20 secondes (feu, bouchon).</li>
                            <li>Utiliser le <strong>frein moteur</strong> en d√©c√©l√©ration (d√©brayer le plus tard possible).</li>
                            <li><strong>V√©rifier la pression des pneus</strong> (sous-gonflage = surconsommation et usure).</li>
                            <li><strong>Limiter la climatisation</strong> (fen√™tres ferm√©es sur autoroute, clim mod√©r√©e).</li>
                            <li><strong>Retirer galerie / coffre de toit</strong> quand ils ne servent pas.</li>
                            <li><strong>All√©ger le v√©hicule</strong> (pas de chargement inutile).</li>
                            <li><strong>Respecter les limitations</strong> (vitesse = premier poste de consommation).</li>
                        </ol>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>Facteurs qui augmentent la consommation</h4>
                        <ul>
                            <li>Vitesse +20 km/h ‚âà +20 % de consommation sur autoroute.</li>
                            <li>Acc√©l√©rations brutales ‚âà +40 %.</li>
                            <li>Climatisation ‚âà +10 √† 20 %.</li>
                            <li>Pneus sous-gonfl√©s ‚âà +3 % par 0,3 bar.</li>
                            <li>Coffre de toit / galerie ‚âà +10 √† 15 %.</li>
                        </ul>
                        <p><strong>üéØ √Ä retenir :</strong> Vitesse stable + rapports t√¥t + anticiper = √©co-conduite.</p>
                    </div>
                    
                    <h3>üü¢ Vignette Crit‚ÄôAir et ZFE</h3>
                    
                    <div class="highlight-box">
                        <h4>Vignette Crit‚ÄôAir</h4>
                        <p>Classement des v√©hicules selon leurs √©missions (particules, NOx).</p>
                        <ul>
                            <li><strong>0 :</strong> v√©hicules 100 % √©lectriques ou hydrog√®ne.</li>
                            <li><strong>1 √† 5 :</strong> du moins au plus polluant (essence, diesel, anciens v√©hicules).</li>
                        </ul>
                        <p>La vignette est <strong>obligatoire</strong> dans les <strong>ZFE-m</strong> (zones √† faibles √©missions mobilit√©). Selon la ZFE, certaines cat√©gories sont interdites √† certaines dates.</p>
                        <p><strong>Sans vignette en ZFE (quand obligatoire) :</strong> amende 68 ‚Ç¨ (v√©hicule l√©ger).</p>
                        <p><strong>üí° Astuce :</strong> Commander la vignette Crit'Air aupr√®s du service d√©di√©.</p>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>üéØ R√©cap √† retenir</h4>
                        <ul>
                            <li>√âco-conduite : anticiper, vitesse stable, rapports t√¥t, moteur coup√© si arr√™t &gt; 20 s.</li>
                            <li>Crit‚ÄôAir 0 = √©lectrique/hydrog√®ne ; 5 = plus polluants.</li>
                            <li>ZFE : vignette obligatoire selon les villes ; sans vignette = 68 ‚Ç¨.</li>
                        </ul>
                    </div>
                `
            },
            {
                id: 8,
                icon: 'üîß',
                title: 'M√©canique',
                desc: 'Pneus, freinage, √©clairage, CT',
                content: `
                    <h2>üîß M√©canique et √âquipements du v√©hicule</h2>
                    
                    <p>Un v√©hicule en bon √©tat, c‚Äôest votre s√©curit√© et celle des autres. Le Code de la route et les textes techniques (contr√¥le technique, √©quipements obligatoires) sont souvent abord√©s √† l‚Äôexamen.</p>
<h3>üõû Les pneumatiques</h3>
                    
                    <div class="highlight-box danger">
                        <h4>Pneus = s√©curit√© vitale</h4>
                        <p><strong>Pression (√† froid) :</strong></p>
                        <ul>
                            <li>V√©rifier selon la notice (souvent sur trappe essence ou porti√®re).</li>
                            <li>Contr√¥le recommand√© : avant un long trajet et environ 1 fois par mois.</li>
                            <li><strong>Sous-gonfl√© :</strong> usure acc√©l√©r√©e, surconsommation, risque d‚Äô√©clatement.</li>
                            <li><strong>Surgonfl√© :</strong> moins d‚Äôadh√©rence, usure irr√©guli√®re.</li>
                        </ul>
                        
                        <p><strong>Profondeur des sculptures (art. R314-1) :</strong></p>
                        <ul>
                            <li><strong>Minimum l√©gal : 1,6 mm</strong> sur toute la largeur de la bande de roulement.</li>
                            <li>En pratique : remplacer d√®s <strong>3 mm</strong> pour garder une marge (pluie, freinage).</li>
                            <li>Pneu lisse ou sous la limite : 135 ‚Ç¨ + immobilisation possible.</li>
                        </ul>
                        <p><strong>üéØ √Ä retenir :</strong> 1,6 mm = limite l√©gale. En dessous = interdit.</p>
                    </div>
                    
                    <h3>üõë Freinage : ABS et ESP</h3>
                    
                    <div class="highlight-box">
                        <h4>ABS (Anti-Blocage des roues)</h4>
                        <ul>
                            <li>√âvite le blocage des roues en freinage fort.</li>
                            <li>Vous gardez la direction (√©viter un obstacle tout en freinant).</li>
                            <li>Conduite : <strong>appuyer √† fond sur la p√©dale</strong>, ne pas rel√¢cher ; les vibrations sont normales (pompage).</li>
                        </ul>
                        
                        <h4>ESP (correcteur de trajectoire)</h4>
                        <ul>
                            <li>Limite la perte de contr√¥le (d√©rapage) en freinant certaines roues.</li>
                            <li>Obligatoire sur les v√©hicules neufs (depuis 2014 en Europe).</li>
                        </ul>
                    </div>
                    
                    <h3>üí° √âclairage</h3>
                    
                    <div class="highlight-box">
                        <h4>Quand allumer quoi ?</h4>
                        <ul>
                            <li><strong>Nuit ou visibilit√© &lt; 200 m :</strong> feux de position + feux de croisement obligatoires.</li>
                            <li><strong>Feux de route (pleins phares) :</strong> hors agglom√©ration, la nuit ; repasser en feux de croisement en croisant un v√©hicule ou en suivant un v√©hicule.</li>
                            <li><strong>Feux de brouillard avant :</strong> en compl√©ment (brouillard, neige, forte pluie) avec feux de croisement.</li>
                            <li><strong>Feux de brouillard arri√®re :</strong> <strong>uniquement</strong> si visibilit√© &lt; 100 m (brouillard, neige). Les √©teindre d√®s que la visibilit√© s‚Äôam√©liore (√©blouissement des autres).</li>
                        </ul>
                        <p><strong>‚ùå Pi√®ge :</strong> Brouillard arri√®re interdit par simple pluie ; r√©serv√© √† visibilit√© &lt; 100 m.</p>
                    </div>
                    
                    <h3>üìã Contr√¥le technique</h3>
                    
                    <div class="highlight-box">
                        <p><strong>V√©hicule neuf :</strong> premier contr√¥le avant la date d‚Äôanniversaire des 4 ans.</p>
                        <p><strong>Ensuite :</strong> tous les 2 ans.</p>
                        <p>Circuler sans contr√¥le technique valide : 135 ‚Ç¨ + immobilisation possible.</p>
                        <p><strong>üí° Astuce :</strong> La date est sur le proc√®s-verbal de contr√¥le (vignette ou document).</p>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>üéØ R√©cap √† retenir</h4>
                        <ul>
                            <li>Pneus : 1,6 mm minimum ; pression √† froid selon notice.</li>
                            <li>ABS : freiner √† fond, garder la direction ; ESP = correcteur de trajectoire.</li>
                            <li>Brouillard arri√®re : uniquement si visibilit√© &lt; 100 m.</li>
                            <li>Contr√¥le technique : 1er √† 4 ans, puis tous les 2 ans.</li>
                        </ul>
                    </div>
                `
            },
            {
                id: 9,
                icon: 'üöë',
                title: 'Premiers Secours',
                desc: 'PAS, num√©ros d\'urgence, constat',
                content: `
                    <h2>üöë Premiers Secours et Accident</h2>
                    
                    <p>En cas d‚Äôaccident, l‚Äôordre des actions compte : d‚Äôabord ne pas aggraver la situation (prot√©ger), puis alerter, puis secourir si on est form√©. Ce cours reprend les bonnes pratiques en cas d'accident.</p>
<h3>üÜò La r√®gle PAS : Prot√©ger, Alerter, Secourir</h3>
                    
                    <div class="highlight-box danger">
                        <h4>P = PROT√âGER (soi et les victimes)</h4>
                        <ul>
                            <li>Allumer les <strong>feux de d√©tresse</strong>.</li>
                            <li>Mettre le <strong>gilet jaune</strong> <strong>avant</strong> de sortir du v√©hicule.</li>
                            <li>Placer le <strong>triangle</strong> : environ 30 m en route, 100 m sur autoroute (pour pr√©venir les autres).</li>
                            <li><strong>Couper le contact</strong> des v√©hicules accident√©s (risque d‚Äôincendie).</li>
                            <li>Ne <strong>jamais traverser une autoroute √† pied</strong> ; rester derri√®re la glissi√®re si possible.</li>
                        </ul>
                        
                        <h4>A = ALERTER</h4>
                        <ul>
                            <li><strong>15</strong> (SAMU), <strong>18</strong> (pompiers), <strong>112</strong> (urgence europ√©en). En France, 15 ou 18 selon gravit√© ; 112 fonctionne partout en Europe.</li>
                            <li>Donner : <strong>lieu pr√©cis</strong> (route, PK, sens, ville), <strong>nature</strong> de l‚Äôaccident, <strong>nombre de victimes</strong>, <strong>√©tat</strong> (conscient, saignement, etc.).</li>
                            <li>Ne pas raccrocher avant que le r√©gulateur le demande.</li>
                        </ul>
                        
                        <h4>S = SECOURIR</h4>
                        <ul>
                            <li>√Ä faire <strong>seulement si vous √™tes form√©</strong> (PSC1, SST, etc.).</li>
                            <li><strong>Ne pas d√©placer</strong> une victime sauf danger imm√©diat (incendie, v√©hicule instable).</li>
                            <li><strong>Ne pas retirer le casque</strong> d‚Äôun motard (risque de blessure au cou) ; d√©visser seulement la visi√®re si besoin.</li>
                        </ul>
                        <p><strong>üéØ √Ä retenir :</strong> D‚Äôabord prot√©ger (gilet, triangle, contact coup√©), puis alerter (15/18/112), puis secourir si form√©.</p>
                    </div>
                    
                    <h3>üìû Num√©ros d‚Äôurgence</h3>
                    <div class="highlight-box">
                        <ul>
                            <li><strong>15 :</strong> SAMU (bless√©s, urgence m√©dicale).</li>
                            <li><strong>17 :</strong> Police / Gendarmerie (d√©linquance, circulation).</li>
                            <li><strong>18 :</strong> Pompiers (accident, incendie, secours).</li>
                            <li><strong>112 :</strong> Num√©ro unique urgence europ√©en (tous pays UE).</li>
                            <li><strong>114 :</strong> Urgence sourds / malentendants (SMS, fax).</li>
                        </ul>
                    </div>
                    
                    <h3>üì¶ √âquipements obligatoires dans le v√©hicule</h3>
                    <div class="highlight-box">
                        <ul>
                            <li><strong>Gilet r√©tro-r√©fl√©chissant</strong> (√† port√©e de main, pas dans le coffre).</li>
                            <li><strong>Triangle de pr√©signalisation</strong>.</li>
                            <li><strong>Carte grise</strong> (certificat d‚Äôimmatriculation).</li>
                            <li><strong>Attestation d‚Äôassurance</strong> (ou carte verte).</li>
                            <li><strong>Constat amiable</strong> (en cas d‚Äôaccident mat√©riel avec un autre v√©hicule).</li>
                        </ul>
                        <p>Absence de gilet ou triangle : 135 ‚Ç¨ (amende forfaitaire).</p>
                    </div>
                    
                    <h3>üìÑ Le constat amiable</h3>
                    <div class="highlight-box success">
                        <h4>Comment le remplir (accident avec un autre v√©hicule)</h4>
                        <ol>
                            <li><strong>Date, heure, lieu</strong> pr√©cis.</li>
                            <li><strong>V√©hicules :</strong> marque, immatriculation, assurance de chacun.</li>
                            <li><strong>Circonstances :</strong> cocher les cases qui correspondent (croisement, stationnement, etc.).</li>
                            <li><strong>Croquis :</strong> position des v√©hicules au moment du choc (sens de circulation, rues).</li>
                            <li><strong>Observations :</strong> d√©g√¢ts visibles, t√©moins √©ventuels.</li>
                            <li><strong>Signatures</strong> des deux conducteurs (m√™me en d√©saccord partiel, si vous signez vous validez les √©l√©ments coch√©s).</li>
                        </ol>
                        <p><strong>‚ö†Ô∏è Ne pas signer</strong> si vous n‚Äô√™tes pas d‚Äôaccord avec ce qui est √©crit ; noter vos r√©serves et envoyer √† votre assurance.</p>
                        <p>Envoyer le constat √† votre assurance sous <strong>5 jours</strong> (d√©lai habituel).</p>
                        <p><strong>üéØ √Ä retenir :</strong> Constat = preuve pour les assurances ; bien remplir et ne signer que si les faits sont corrects.</p>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>üéØ R√©cap √† retenir</h4>
                        <ul>
                            <li>PAS : Prot√©ger (gilet, triangle, contact coup√©) ‚Üí Alerter (15/18/112) ‚Üí Secourir si form√©.</li>
                            <li>112 = urgence Europe ; 15 = SAMU ; 18 = pompiers.</li>
                            <li>Gilet + triangle obligatoires, √† port√©e de main.</li>
                            <li>Constat : remplir avec pr√©cision, ne pas signer si d√©saccord, envoyer sous 5 jours.</li>
                        </ul>
                    </div>
                `
            },
            {
                id: 10,
                icon: 'üìÑ',
                title: 'R√©glementation',
                desc: 'Permis, assurance, documents, sanctions',
                content: `
                    <h2>üìÑ R√©glementation - Permis, assurance, sanctions</h2>
                    
                    <p>Permis, assurance et documents obligatoires font partie du Code de la route. Les sanctions (points, amendes) sont souvent demand√©es √† l‚Äôexamen. Ce cours synth√©tise les r√®gles utiles (art. R221 et suivants, Code des assurances).</p>
<h3>ü™™ Le permis de conduire</h3>
                    
                    <div class="highlight-box">
                        <h4>Cat√©gories principales</h4>
                        <ul>
                            <li><strong>AM (ex BSR) :</strong> cyclomoteurs &lt; 50 cm¬≥, quadricycles l√©gers ; d√®s 14 ans.</li>
                            <li><strong>A1 :</strong> motos &lt; 125 cm¬≥, puissance max 11 kW ; d√®s 16 ans.</li>
                            <li><strong>B :</strong> voitures, v√©hicules &lt; 3,5 t ; d√®s 18 ans (17 ans si conduite accompagn√©e).</li>
                        </ul>
                    </div>
                    
                    <div class="highlight-box success">
                        <h4>Permis probatoire (B)</h4>
                        <ul>
                            <li>Dur√©e : <strong>3 ans</strong> (2 ans si conduite accompagn√©e r√©ussie).</li>
                            <li>Capital initial : <strong>6 points</strong>.</li>
                            <li>R√©cup√©ration : +2 points par an sans infraction (+3 si AAC), jusqu‚Äô√† 12.</li>
                            <li>Limitations : 110 km/h autoroute, 100 km/h 2√ó2 voies.</li>
                            <li>Disque ¬´ A ¬ª obligatoire √† l‚Äôarri√®re pendant 1 an (sauf apr√®s AAC).</li>
                            <li>Alcool√©mie max : <strong>0,2 g/L</strong>.</li>
                        </ul>
                        <p><strong>üéØ √Ä retenir :</strong> 6 points au d√©part, 0,2 g/L alcool, vitesses r√©duites.</p>
                    </div>
                    
                    <h3>üõ°Ô∏è L‚Äôassurance automobile</h3>
                    
                    <div class="highlight-box danger">
                        <h4>Assurance = obligation l√©gale</h4>
                        <p><strong>Minimum : Responsabilit√© civile (RC)</strong> ‚Äî couvre les dommages que vous causez aux autres (personnes et biens).</p>
                        <p><strong>Circuler sans assurance :</strong> amende jusqu‚Äô√† <strong>3 750 ‚Ç¨</strong> + suspension de permis + confiscation du v√©hicule possible.</p>
                        <p>En cas d‚Äôaccident sans assurance : vous restez responsable des dommages (biens personnels engag√©s).</p>
                    </div>
                    
                    <h3>üìã Documents √† avoir en conduite</h3>
                    <div class="highlight-box">
                        <ul>
                            <li><strong>Permis de conduire</strong> (original, valide).</li>
                            <li><strong>Certificat d‚Äôimmatriculation</strong> (carte grise).</li>
                            <li><strong>Attestation d‚Äôassurance</strong> (ou carte verte) √† jour.</li>
                        </ul>
                        <p>En contr√¥le : pr√©sentation des originaux (ou copie selon ce que demande l‚Äôagent).</p>
                    </div>
                    
                    <h3>‚ö†Ô∏è Principales infractions et sanctions (ordre de grandeur)</h3>
                    
                    <div class="highlight-box">
                        <h4>Vitesse</h4>
                        <ul>
                            <li>Inf√©rieur √† 20 km/h au-dessus de la limite : 68 ‚Ç¨ + 1 point.</li>
                            <li>20 √† 30 km/h : 135 ‚Ç¨ + 2 points.</li>
                            <li>30 √† 40 km/h : 135 ‚Ç¨ + 3 points + suspension possible.</li>
                            <li>50 km/h et plus : d√©lit, amende jusqu‚Äô√† 1 500 ‚Ç¨ + 6 points + confiscation possible.</li>
                        </ul>
                        
                        <h4>Autres (contraventions courantes)</h4>
                        <ul>
                            <li>Alcool 0,5‚Äì0,8 g/L : 135 ‚Ç¨ + 6 points.</li>
                            <li>T√©l√©phone tenu en main / oreillette : 135 ‚Ç¨ + 3 points.</li>
                            <li>Feu rouge / STOP non respect√© : 135 ‚Ç¨ + 4 points.</li>
                            <li>Priorit√© (v√©hicule, pi√©ton) : 135 ‚Ç¨ + 4 ou 6 points selon cas.</li>
                            <li>Ceinture non attach√©e : 135 ‚Ç¨ + 3 points.</li>
                        </ul>
                        <p><strong>üí° Astuce :</strong> Les montants et points peuvent √©voluer ; le principe (vitesse, alcool, priorit√©, ceinture, t√©l√©phone) reste souvent demand√© √† l‚Äôexamen.</p>
                    </div>
                    
                    <div class="highlight-box">
                        <h4>üéØ R√©cap √† retenir</h4>
                        <ul>
                            <li>Permis B : 18 ans (17 si AAC) ; probatoire 3 ans (2 si AAC), 6 points, 0,2 g/L.</li>
                            <li>Assurance RC obligatoire ; sans assurance jusqu‚Äô√† 3 750 ‚Ç¨ + suspension.</li>
                            <li>Documents : permis, carte grise, attestation d‚Äôassurance.</li>
                            <li>Sanctions : vitesse, alcool, priorit√©, t√©l√©phone, ceinture = amendes + points.</li>
                        </ul>
                    </div>
                `
            }
        ];
        
        // =============================================
        // DONN√âES - QUESTIONS (pool √©tendu pour examens blancs et quiz)
        // =============================================
        const questions = [
            // SIGNALISATION
            { theme: 'signalisation', q: 'Que signifie un panneau triangulaire √† bordure rouge ?', answers: ['Une interdiction', 'Un danger', 'Une obligation', 'Une indication'], correct: 1, explanation: 'Les panneaux triangulaires rouges signalent TOUJOURS un danger, jamais une interdiction. Les interdictions sont sur panneaux RONDS rouges.' },
            { theme: 'signalisation', q: 'Pouvez-vous franchir une ligne blanche continue pour d√©passer un cycliste ?', answers: ['Oui, si 1m d\'√©cart', 'Oui, si aucun v√©hicule', 'Non, interdit', 'Oui, √† moins de 30 km/h'], correct: 2, explanation: 'Le franchissement d\'une ligne continue est INTERDIT, m√™me pour d√©passer un v√©lo. Attendre ligne discontinue.' },
            { theme: 'signalisation', q: 'Au feu orange, vous devez :', answers: ['Acc√©l√©rer', 'Vous arr√™ter si possible en s√©curit√©', 'Toujours passer', 'Klaxonner'], correct: 1, explanation: 'Au feu orange : arr√™t obligatoire SI vous pouvez le faire en s√©curit√©. Passage autoris√© uniquement si arr√™t dangereux.' },
            { theme: 'signalisation', q: 'Un panneau rond bleu indique :', answers: ['Une interdiction', 'Une direction', 'Une obligation', 'Un danger'], correct: 2, explanation: 'Les panneaux RONDS BLEUS indiquent une obligation √† respecter (direction obligatoire, vitesse minimum, etc.).' },
            { theme: 'signalisation', q: 'Un feu orange clignotant signifie :', answers: ['Arr√™t obligatoire', 'Passage interdit', 'Prudence, danger', 'Priorit√© √† droite'], correct: 2, explanation: 'Feu orange clignotant = danger, prudence, ralentir. Souvent √† un carrefour dangereux.' },
            
            // PRIORIT√âS
            { theme: 'priorites', q: 'Dans un giratoire avec panneau "C√©dez le passage", qui a la priorit√© ?', answers: ['Les v√©hicules entrant', 'Les v√©hicules dans le giratoire', 'Priorit√© √† droite', 'Le plus rapide'], correct: 1, explanation: 'Dans un GIRATOIRE (le plus courant), priorit√© AUX v√©hicules DANS le giratoire.' },
            { theme: 'priorites', q: 'La priorit√© √† droite s\'applique-t-elle dans un giratoire avec "C√©dez le passage" ?', answers: ['Oui, toujours', 'Non', 'Seulement la nuit', 'Selon la taille'], correct: 1, explanation: 'NON. Dans un giratoire avec panneau "C√©dez le passage", priorit√© aux v√©hicules DANS le giratoire, PAS priorit√© √† droite.' },
            { theme: 'priorites', q: 'Au panneau STOP, vous devez :', answers: ['Ralentir fortement', 'Arr√™t complet obligatoire', 'C√©der passage seulement', 'Klaxonner'], correct: 1, explanation: 'STOP = arr√™t COMPLET et MARQU√â obligatoire, m√™me si aucun v√©hicule. Puis c√©der passage √† TOUS.' },
            { theme: 'priorites', q: 'Vous sortez d\'un parking priv√©, vous devez :', answers: ['Avoir la priorit√©', 'C√©der passage √† tous', 'Klaxonner', 'Priorit√© √† droite'], correct: 1, explanation: 'Sortie parking/chemin priv√©/station-service = vous c√©dez TOUJOURS le passage √† tous les v√©hicules.' },
            { theme: 'priorites', q: 'Panneau "C√©dez le passage" = forme :', answers: ['Triangle pointe haut', 'Triangle pointe bas', 'Rond', 'Octogone'], correct: 1, explanation: 'C√©dez le passage = triangle pointe EN BAS, bordure rouge. Seul panneau avec pointe en bas.' },
            
            // VITESSE
            { theme: 'vitesse', q: 'Vitesse maximum par d√©faut en agglom√©ration :', answers: ['30 km/h', '50 km/h', '70 km/h', '90 km/h'], correct: 1, explanation: '50 km/h par d√©faut en agglom√©ration, sauf panneau indiquant autre chose (30, 70, etc.).' },
            { theme: 'vitesse', q: 'Sur route √† double sens sans s√©parateur, la vitesse est :', answers: ['70 km/h', '80 km/h', '90 km/h', '110 km/h'], correct: 1, explanation: '80 km/h par d√©faut sur routes √† double sens (90 km/h si panneau). R√©forme 2018.' },
            { theme: 'vitesse', q: 'Vitesse maximum autoroute pour permis de moins de 3 ans :', answers: ['100 km/h', '110 km/h', '120 km/h', '130 km/h'], correct: 1, explanation: 'Permis probatoire (< 3 ans) : 110 km/h max sur autoroute (au lieu de 130 km/h).' },
            { theme: 'vitesse', q: 'Distance de s√©curit√© minimum l√©gale :', answers: ['1 seconde', '2 secondes', '3 secondes', '5 secondes'], correct: 1, explanation: '2 secondes minimum entre vous et v√©hicule devant (art. R412-12). Fortement augmenter par mauvais temps.' },
            { theme: 'vitesse', q: 'Par temps de pluie, distance de freinage :', answers: ['Identique', 'Multipli√©e x1,5', 'Multipli√©e x2', 'Multipli√©e x3'], correct: 2, explanation: 'Sur route MOUILL√âE, distance de freinage MULTIPLI√âE PAR 2. Sur neige/verglas : x10 !' },
            { theme: 'vitesse', q: 'Vitesse autoroute par temps de pluie :', answers: ['100 km/h', '110 km/h', '120 km/h', '130 km/h'], correct: 1, explanation: 'Autoroute : 130 km/h temps sec, 110 km/h temps de pluie.' },
            
            // STATIONNEMENT
            { theme: 'stationnement', q: 'Vous vous arr√™tez 30 secondes pour acheter du pain, c\'est :', answers: ['Un arr√™t', 'Un stationnement', 'Ni l\'un ni l\'autre', 'Arr√™t d\'urgence'], correct: 1, explanation: 'Si vous quittez le v√©hicule, m√™me 30 secondes = STATIONNEMENT (pas arr√™t). La dur√©e ne compte pas !' },
            { theme: 'stationnement', q: 'Stationner sur trottoir est :', answers: ['Toujours autoris√©', 'Autoris√© si marquage + 1,50m pi√©tons', 'Toujours interdit', 'Autoris√© la nuit'], correct: 1, explanation: 'Stationnement trottoir INTERDIT par d√©faut. Autoris√© UNIQUEMENT si marquage + laisse 1,50m pour pi√©tons (art. R417-10).' },
            { theme: 'stationnement', q: 'Distance minimum avant passage pi√©ton pour stationner :', answers: ['Imm√©diatement', '2 m√®tres', '5 m√®tres', '10 m√®tres'], correct: 2, explanation: 'Stationnement interdit 5 m√®tres AVANT un passage pi√©ton (pour visibilit√©).' },
            { theme: 'stationnement', q: 'ARR√äT signifie :', answers: ['Moins de 5 minutes', 'Conducteur aux commandes ou √† proximit√©', 'Moteur coup√©', 'Feux d√©tresse allum√©s'], correct: 1, explanation: 'ARR√äT = conducteur RESTE aux commandes ou √† proximit√©, peut d√©placer imm√©diatement. PAS une question de dur√©e !' },
            { theme: 'stationnement', q: 'Marquage au sol : ligne jaune signifie :', answers: ['Stationnement interdit', 'Arr√™t interdit', 'Danger', 'Zone travaux'], correct: 1, explanation: 'Ligne jaune au sol = arr√™t ET stationnement interdits (g√©n√©ralement arr√™t de bus).' },
            
            // CONDUCTEUR
            { theme: 'conducteur', q: 'Taux alcool√©mie maximum permis de moins de 3 ans :', answers: ['0,2 g/L', '0,5 g/L', '0,8 g/L', '1,0 g/L'], correct: 0, explanation: 'Permis probatoire (< 3 ans) : 0,2 g/L maximum (contre 0,5 g/L pour permis confirm√©).' },
            { theme: 'conducteur', q: 'Utiliser t√©l√©phone avec oreillette en conduisant :', answers: ['Est autoris√©', 'Est interdit', 'Autoris√© √† l\'arr√™t', 'Autoris√© < 30 km/h'], correct: 1, explanation: 'Oreillette et √©couteurs INTERDITS au volant (art. R412-6-1). Seul kit int√©gr√© v√©hicule autoris√©. 135‚Ç¨ + 3 points.' },
            { theme: 'conducteur', q: 'Le caf√© permet d\'√©liminer l\'alcool :', answers: ['Vrai', 'Faux', 'Seulement caf√© fort', 'Avec sucre uniquement'], correct: 1, explanation: 'FAUX. Caf√©, douche ne font PAS baisser le taux. Seul le TEMPS √©limine alcool (0,15 g/L par heure).' },
            { theme: 'conducteur', q: 'Principal signe de fatigue au volant :', answers: ['Avoir faim', 'B√¢illements r√©p√©t√©s', 'Avoir froid', 'Mauvaise humeur'], correct: 1, explanation: 'B√¢illements r√©p√©t√©s, paupi√®res lourdes, difficult√© trajectoire = fatigue. SEULE solution : PAUSE !' },
            { theme: 'conducteur', q: 'Capital points permis probatoire au d√©part :', answers: ['3 points', '6 points', '8 points', '12 points'], correct: 1, explanation: 'Permis probatoire : 6 points au d√©part, +2 ou +3 points/an sans infraction jusqu\'√† 12.' },
            { theme: 'conducteur', q: 'R√©cup√©ration automatique points apr√®s combien de temps sans infraction ?', answers: ['6 mois', '1 an', '2 ans', '3 ans'], correct: 2, explanation: '2 ans sans infraction pour infractions mineures, 3 ans pour graves. R√©cup√©ration automatique.' },
            
            // USAGERS
            { theme: 'usagers', q: 'Distance minimum pour d√©passer cycliste EN VILLE :', answers: ['50 cm', '1 m√®tre', '1,50 m√®tre', '2 m√®tres'], correct: 1, explanation: 'En agglom√©ration : 1 m√®tre minimum. Hors agglom√©ration : 1,50 m√®tre minimum.' },
            { theme: 'usagers', q: 'Sur passage pi√©ton, pi√©ton manifeste intention traverser, vous devez :', answers: ['Acc√©l√©rer', 'Klaxonner', 'C√©der le passage', 'Continuer prudemment'], correct: 2, explanation: 'Pi√©ton manifestant intention de traverser = c√©der le passage obligatoire.' },
            { theme: 'usagers', q: 'Un tramway a :', answers: ['Priorit√© absolue sauf signalisation', 'Priorit√© √† droite', 'Pas de priorit√©', 'Priorit√© la nuit'], correct: 0, explanation: 'Tramway = priorit√© ABSOLUE sauf si signalisation contraire.' },
            
            // ENVIRONNEMENT
            { theme: 'environnement', q: '√âco-conduite permet √©conomiser jusqu\'√† :', answers: ['5% carburant', '10% carburant', '20% carburant', '30% carburant'], correct: 2, explanation: '√âco-conduite peut faire √©conomiser jusqu\'√† 20% de carburant avec bonnes pratiques.' },
            { theme: 'environnement', q: 'Vignette Crit\'Air : combien de cat√©gories ?', answers: ['3', '5', '6', '10'], correct: 2, explanation: 'Vignette Crit\'Air : 6 cat√©gories (0 √† 5). 0 = √©lectrique/hydrog√®ne, 5 = plus polluants.' },
            
            // M√âCANIQUE
            { theme: 'mecanique', q: 'Profondeur minimum l√©gale sculptures pneus :', answers: ['0,8 mm', '1,6 mm', '2,5 mm', '3 mm'], correct: 1, explanation: 'Minimum l√©gal : 1,6 mm sur toute largeur. Recommand√© : remplacer d√®s 3 mm pour s√©curit√©.' },
            { theme: 'mecanique', q: 'L\'ABS emp√™che :', answers: ['Vitesse excessive', 'Blocage des roues', 'Consommation', 'Usure freins'], correct: 1, explanation: 'ABS = emp√™che blocage roues au freinage. Permet de conserver direction pendant freinage urgence.' },
            
            // SECOURS
            { theme: 'secours', q: 'Premier geste accident : PAS signifie :', answers: ['Prot√©ger, Alerter, Secourir', 'Pr√©venir, Attendre, Soigner', 'Police, Ambulance, Secours', 'Prudence, Arr√™t, Signal'], correct: 0, explanation: 'PAS = Prot√©ger (la zone), Alerter (les secours), Secourir (si form√©).' },
            { theme: 'secours', q: 'Num√©ro urgence europ√©en :', answers: ['15', '17', '18', '112'], correct: 3, explanation: '112 = num√©ro urgence europ√©en, fonctionne dans tous pays d\'Europe.' },
            
            // R√âGLEMENTATION
            { theme: 'reglementation', q: 'Assurance minimum obligatoire est :', answers: ['Tous risques', 'Vol incendie', 'Responsabilit√© Civile', 'Bris de glace'], correct: 2, explanation: 'Responsabilit√© Civile (RC) = assurance MINIMUM obligatoire. Couvre dommages caus√©s aux tiers.' },
            { theme: 'reglementation', q: 'Circuler sans assurance peut co√ªter jusqu\'√† :', answers: ['135 ‚Ç¨', '750 ‚Ç¨', '1 500 ‚Ç¨', '3 750 ‚Ç¨'], correct: 3, explanation: 'Pas d\'assurance = jusqu\'√† 3 750‚Ç¨ + suspension permis + confiscation v√©hicule possible.' },
            { theme: 'reglementation', q: 'Permis probatoire : combien de points au d√©part ?', answers: ['4 points', '6 points', '8 points', '12 points'], correct: 1, explanation: 'Permis probatoire : 6 points au d√©part, passage √† 12 apr√®s 3 ans sans infraction (2 ans AAC).' },
            // Questions suppl√©mentaires pour varier examens et quiz
            { theme: 'signalisation', q: 'Un panneau carr√© bleu avec une fl√®che indique :', answers: ['Une interdiction', 'Une indication', 'Un danger', 'Une obligation'], correct: 1, explanation: 'Les panneaux CARR√âS BLEUS donnent des indications (direction, parking, etc.).' },
            { theme: 'signalisation', q: 'Ligne blanche discontinue au milieu de la chauss√©e :', answers: ['D√©passement interdit', 'D√©passement autoris√©', 'Arr√™t obligatoire', 'Vitesse max 30'], correct: 1, explanation: 'Ligne discontinue = vous pouvez la franchir pour d√©passer si la voie est libre.' },
            { theme: 'priorites', q: 'Vous √™tes sur une route √† sens unique. Une voiture arrive en face. Qui a tort ?', answers: ['Vous', 'L\'autre v√©hicule', 'Personne', 'Priorit√© √† droite'], correct: 1, explanation: 'Sur une voie √† sens unique, une voiture ¬´ en face ¬ª circule √† contresens : elle a tort.' },
            { theme: 'priorites', q: 'Bus qui quitte un arr√™t signal√© (clignotant) :', answers: ['Vous avez la priorit√©', 'Vous devez c√©der le passage', 'Priorit√© √† droite', 'Klaxonner'], correct: 1, explanation: 'En agglom√©ration, vous devez c√©der le passage aux bus qui quittent un arr√™t signal√©.' },
            { theme: 'vitesse', q: 'Vitesse max en zone de rencontre ?', answers: ['20 km/h', '30 km/h', '50 km/h', '70 km/h'], correct: 0, explanation: 'Zone de rencontre : 20 km/h, pi√©tons autoris√©s sur la chauss√©e et prioritaires.' },
            { theme: 'vitesse', q: 'Visibilit√© inf√©rieure √† 50 m (brouillard) : vitesse max ?', answers: ['30 km/h', '50 km/h', '80 km/h', '90 km/h'], correct: 1, explanation: 'Visibilit√© < 50 m : 50 km/h maximum sur toutes les routes (autoroute comprise).' },
            { theme: 'stationnement', q: 'Stationnement interdit √† moins de 5 m d\'un passage pi√©ton :', answers: ['Avant seulement', 'Apr√®s seulement', 'Avant et apr√®s', 'Uniquement la nuit'], correct: 0, explanation: 'Stationnement interdit 5 m AVANT un passage pi√©ton (pour ne pas masquer la vue).' },
            { theme: 'conducteur', q: 'T√©l√©phone tenu en main au volant (sans accident) :', answers: ['68 ‚Ç¨', '135 ‚Ç¨', '750 ‚Ç¨', '1 500 ‚Ç¨'], correct: 1, explanation: 'T√©l√©phone en main : 135 ‚Ç¨ d\'amende et 3 points de retrait.' },
            { theme: 'conducteur', q: 'Stage de r√©cup√©ration de points : combien de points max ?', answers: ['2 points', '4 points', '6 points', '8 points'], correct: 1, explanation: 'Un stage de r√©cup√©ration peut rendre au maximum 4 points (1 stage par an).' },
            { theme: 'usagers', q: 'Distance min pour d√©passer un cycliste en agglom√©ration ?', answers: ['0,5 m', '1 m', '1,5 m', '2 m'], correct: 1, explanation: 'En agglom√©ration : 1 m minimum entre votre v√©hicule et le cycliste.' },
            { theme: 'usagers', q: 'Trottinette √©lectrique (EDPM) : vitesse max autoris√©e ?', answers: ['6 km/h', '25 km/h', '45 km/h', '50 km/h'], correct: 1, explanation: 'EDPM (trottinette √©lectrique, etc.) : 25 km/h maximum (vitesse constructeur).' },
            { theme: 'environnement', q: 'ZFE signifie :', answers: ['Zone de forte √©mission', 'Zone √† faibles √©missions', 'Zone de freinage d\'urgence', 'Zone de formation √©largie'], correct: 1, explanation: 'ZFE = Zone √† Faibles √âmissions (mobilit√©). Vignette Crit\'Air peut y √™tre obligatoire.' },
            { theme: 'mecanique', q: 'Feux de brouillard arri√®re : quand les allumer ?', answers: ['D√®s qu\'il pleut', 'Visibilit√© < 200 m', 'Visibilit√© < 100 m', 'Jamais sur autoroute'], correct: 2, explanation: 'Feux de brouillard arri√®re : uniquement si visibilit√© inf√©rieure √† 100 m (brouillard, neige).' },
            { theme: 'mecanique', q: 'Contr√¥le technique : p√©riodicit√© apr√®s le premier ?', answers: ['Tous les ans', 'Tous les 2 ans', 'Tous les 3 ans', 'Tous les 5 ans'], correct: 1, explanation: 'Apr√®s le premier contr√¥le (√† 4 ans), le CT est √† refaire tous les 2 ans.' },
            { theme: 'secours', q: 'Num√©ro pour alerter les pompiers ?', answers: ['15', '17', '18', '112'], correct: 2, explanation: '18 = pompiers (accident, incendie, secours). 15 = SAMU, 17 = police.' },
            { theme: 'secours', q: 'En cas d\'accident, apr√®s avoir prot√©g√© et alert√© :', answers: ['D√©placer les bless√©s', 'Donner √† boire', 'Secourir si on est form√©', 'Partir rapidement'], correct: 2, explanation: 'S = Secourir uniquement si on est form√© (PSC1, etc.). Ne pas d√©placer un bless√© sauf danger.' },
            { theme: 'reglementation', q: 'Document obligatoire en circulation ?', answers: ['Permis et assurance uniquement', 'Permis, assurance, carte grise', 'Assurance uniquement', 'Carte grise uniquement'], correct: 1, explanation: '√Ä avoir : permis de conduire, attestation d\'assurance, carte grise (certificat d\'immatriculation).' },
            { theme: 'reglementation', q: 'Conduite sans permis (jamais obtenu) :', answers: ['Contravention', 'D√©lit', 'Amende seule', 'Avertissement'], correct: 1, explanation: 'Conduire sans avoir le permis est un d√©lit (tribunal, amende, prison possible).' },
            { theme: 'signalisation', q: 'Panneau rond rouge avec une barre blanche :', answers: ['Interdiction d\'acc√®s', 'Obligation', 'Indication', 'Danger'], correct: 0, explanation: 'Panneau rond rouge √† barre blanche = interdiction d\'acc√®s (souvent sens interdit).' },
            { theme: 'priorites', q: 'Vous sortez d\'un chemin de terre sur une route. Qui doit c√©der ?', answers: ['Les v√©hicules sur la route', 'Vous', 'Priorit√© √† droite', 'Le plus rapide'], correct: 1, explanation: 'En quittant un chemin non ouvert √† la circulation publique, on c√®de le passage √† tous.' },
            // Contenu original ‚Äî formulations uniques (non copi√©es)
            { theme: 'signalisation', q: 'Triangle rouge bord√© de blanc, pointe en l\'air : quel type de message ?', answers: ['Obligation', 'Indication', 'Avertissement d\'un danger', 'Interdiction'], correct: 2, explanation: 'C‚Äôest le panneau d‚Äôavertissement de danger. Les interdictions passent par les ronds rouges.' },
            { theme: 'signalisation', q: 'Vous roulez et une ligne blanche continue s√©pare les voies. D√©passer est-il permis ?', answers: ['Oui si on klaxonne', 'Non', 'Oui √† moins de 50 km/h', 'Oui de nuit seulement'], correct: 1, explanation: 'Franchir une ligne continue pour d√©passer est interdit. Il faut attendre une section en pointill√©s.' },
            { theme: 'signalisation', q: 'Le feu passe √† l‚Äôorange alors que vous pouvez encore vous arr√™ter sans risque. Que faire ?', answers: ['Acc√©l√©rer pour passer', 'S‚Äôarr√™ter', 'Klaxonner', 'Continuer √† m√™me allure'], correct: 1, explanation: 'Orange = arr√™t si l‚Äôarr√™t est possible en s√©curit√©. Sinon, traverser sans s‚Äôarr√™ter au milieu.' },
            { theme: 'signalisation', q: 'Un panneau circulaire √† fond bleu impose en g√©n√©ral :', answers: ['Une interdiction', 'Une obligation', 'Un simple conseil', 'Un danger'], correct: 1, explanation: 'Rond + bleu = obligation (sens obligatoire, vitesse minimale, etc.).' },
            { theme: 'signalisation', q: 'Orange clignotant isol√© (sans feu vert/rouge) : que faire ?', answers: ['Arr√™t obligatoire', 'Ralentir et faire attention', 'Priorit√© absolue', 'Contourner par la droite'], correct: 1, explanation: 'Orange clignotant = danger ou carrefour particulier : on ralentit et on adapte sa conduite.' },
            { theme: 'priorites', q: 'Dans un rond-point avec ¬´ C√©dez le passage ¬ª √† l‚Äôentr√©e, la priorit√© revient √† :', answers: ['Ceux qui entrent', 'Ceux qui sont d√©j√† dans l‚Äôanneau', 'Celui qui va le plus vite', 'Priorit√© √† droite'], correct: 1, explanation: 'Dans ce type de giratoire, ceux qui circulent d√©j√† sur l‚Äôanneau sont prioritaires.' },
            { theme: 'priorites', q: 'Au rond-point avec ¬´ C√©dez le passage ¬ª, la r√®gle ¬´ priorit√© √† droite ¬ª s‚Äôapplique-t-elle ?', answers: ['Oui', 'Non', 'Seulement la nuit', 'Seulement en ville'], correct: 1, explanation: 'Non : c‚Äôest le ¬´ C√©dez le passage ¬ª qui s‚Äôapplique, pas la priorit√© √† droite.' },
            { theme: 'priorites', q: '√Ä un STOP, m√™me sans aucun v√©hicule en vue, que dit la r√®gle ?', answers: ['Ralentir puis passer', 'Marquer un arr√™t complet', 'Klaxonner une fois', 'Passer en deuxi√®me'], correct: 1, explanation: 'Le STOP exige un arr√™t complet et visible, m√™me si la chauss√©e est libre.' },
            { theme: 'priorites', q: 'En sortant d‚Äôune station-service vers la route, qui doit laisser passer l‚Äôautre ?', answers: ['Les v√©hicules sur la route', 'Vous', 'Le plus charg√©', 'Celui qui klaxonne'], correct: 1, explanation: 'Quitter un lieu priv√© (station, parking, cour) impose de c√©der le passage √† la route.' },
            { theme: 'priorites', q: 'Quelle forme a le panneau ¬´ C√©dez le passage ¬ª ?', answers: ['Triangle pointe en haut', 'Triangle pointe en bas', 'Rond', 'Carr√©'], correct: 1, explanation: 'C‚Äôest le seul triangle avec la pointe vers le bas, bordure rouge.' },
            { theme: 'vitesse', q: 'En entrant en agglom√©ration (panneau de ville), sans autre panneau, limite par d√©faut :', answers: ['30', '50', '70', '90'], correct: 1, explanation: 'En agglom√©ration, 50 km/h sauf zone 30, zone de rencontre ou autre signalisation.' },
            { theme: 'vitesse', q: 'Route √† deux voies, hors agglom√©ration, pas de panneau : limite par d√©faut (r√©forme r√©cente) ?', answers: ['70 km/h', '80 km/h', '90 km/h', '110 km/h'], correct: 1, explanation: 'Depuis la r√©forme, 80 km/h par d√©faut ; certains d√©partements ont remis 90 par panneau.' },
            { theme: 'vitesse', q: 'Permis depuis moins de 3 ans : limite sur autoroute ?', answers: ['100', '110', '120', '130'], correct: 1, explanation: 'Jeune conducteur : 110 km/h sur autoroute au lieu de 130.' },
            { theme: 'vitesse', q: 'Entre vous et le v√©hicule devant, la r√®gle conseill√©e (et souvent rappel√©e) est :', answers: ['1 seconde', '2 secondes', '3 secondes', '5 secondes'], correct: 1, explanation: 'Au moins 2 secondes (compter ¬´ 1001, 1002 ¬ª) ; plus en cas de pluie ou brouillard.' },
            { theme: 'vitesse', q: 'Sur route mouill√©e, la distance de freinage par rapport au sec est environ :', answers: ['Pareille', 'x 1,5', 'x 2', 'x 3'], correct: 2, explanation: 'Sur sol mouill√©, la distance de freinage est environ doubl√©e ; sur neige/verglas bien plus.' },
            { theme: 'vitesse', q: 'Sur autoroute, par temps de pluie, limite en km/h ?', answers: ['100', '110', '120', '130'], correct: 1, explanation: 'Autoroute : 130 temps sec, 110 par temps de pluie.' },
            { theme: 'stationnement', q: 'Vous vous garez 20 secondes, moteur coup√©, pour prendre un colis. C‚Äôest un arr√™t ou un stationnement ?', answers: ['Arr√™t', 'Stationnement', 'Ni l‚Äôun ni l‚Äôautre', 'Arr√™t d‚Äôurgence'], correct: 1, explanation: 'D√®s que vous quittez votre place (m√™me peu de temps), c‚Äôest du stationnement, pas l‚Äôarr√™t.' },
            { theme: 'stationnement', q: 'Peut-on stationner sur le trottoir ?', answers: ['Oui partout', 'Oui si marquage et 1,50 m pour pi√©tons', 'Non jamais', 'Oui la nuit'], correct: 1, explanation: 'Par d√©faut non. Oui seulement si c‚Äôest autoris√© (marquage) et qu‚Äôil reste 1,50 m pour les pi√©tons.' },
            { theme: 'stationnement', q: '√Ä quelle distance minimale d‚Äôun passage pi√©ton le stationnement est-il interdit en amont ?', answers: ['2 m', '5 m', '10 m', '15 m'], correct: 1, explanation: 'Interdit de stationner √† moins de 5 m avant un passage pi√©ton (visibilit√©).' },
            { theme: 'stationnement', q: 'L‚Äô¬´ arr√™t ¬ª se d√©finit surtout par :', answers: ['Une dur√©e courte', 'Conducteur aux commandes ou tout pr√®s', 'Moteur √©teint', 'Feux de d√©tresse'], correct: 1, explanation: 'Arr√™t = vous restez disponible pour repartir tout de suite (volant ou √† proximit√©).' },
            { theme: 'stationnement', q: 'Une ligne jaune peinte au sol en bord de chauss√©e indique en g√©n√©ral :', answers: ['Stationnement autoris√©', 'Arr√™t et stationnement interdits', 'Danger', 'Travaux'], correct: 1, explanation: 'Souvent zone d‚Äôarr√™t de bus : ni arr√™t ni stationnement autoris√©s.' },
            { theme: 'conducteur', q: 'Alcool√©mie maximale autoris√©e pour un permis de moins de 3 ans (en g/L de sang) :', answers: ['0,2', '0,5', '0,8', '1'], correct: 0, explanation: 'Jeune conducteur : 0,2 g/L max. En pratique, z√©ro alcool est le plus s√ªr.' },
            { theme: 'conducteur', q: 'Oreillette ou √©couteurs pour √©couter de la musique en conduisant :', answers: ['Autoris√©', 'Interdit', 'Autoris√© √† l‚Äôarr√™t', 'Autoris√© en ville'], correct: 1, explanation: 'Oreillettes et √©couteurs sont interdits au volant. Seul un kit int√©gr√© au v√©hicule est tol√©r√©.' },
            { theme: 'conducteur', q: 'Est-ce que le caf√© ou la douche font baisser l‚Äôalcool√©mie ?', answers: ['Oui', 'Non', 'Seulement le caf√© fort', 'Seulement la douche froide'], correct: 1, explanation: 'Non. Seul le temps fait diminuer le taux (environ 0,15 g/L par heure).' },
            { theme: 'conducteur', q: 'Quel signe doit vous alerter sur un risque de fatigue ?', answers: ['Faim', 'B√¢illements √† r√©p√©tition', 'Froid', 'Ennui'], correct: 1, explanation: 'B√¢illements, paupi√®res lourdes, trajectoire qui bouge : il faut faire une pause.' },
            { theme: 'conducteur', q: 'Combien de points a un permis probatoire au d√©part ?', answers: ['3', '6', '8', '12'], correct: 1, explanation: '6 points au d√©part, puis r√©cup√©ration progressive (souvent +2 ou +3 par an sans infraction).' },
            { theme: 'conducteur', q: 'R√©cup√©ration automatique de points : apr√®s combien de temps sans nouvelle infraction (ordre de grandeur) ?', answers: ['6 mois', '1 an', '2 √† 3 ans', '5 ans'], correct: 2, explanation: 'Selon la gravit√© : souvent 2 ou 3 ans sans infraction pour r√©cup√©rer automatiquement.' },
            { theme: 'usagers', q: 'En ville, quelle distance garder avec un cycliste quand on le d√©passe ?', answers: ['0,5 m', '1 m', '1,5 m', '2 m'], correct: 1, explanation: 'En agglom√©ration : 1 m minimum. Hors agglom√©ration : 1,50 m.' },
            { theme: 'usagers', q: 'Un pi√©ton montre clairement qu‚Äôil veut traverser sur un passage. Vous devez :', answers: ['Acc√©l√©rer', 'Klaxonner', 'C√©der le passage', 'Ralentir sans vous arr√™ter'], correct: 2, explanation: 'D√®s qu‚Äôil manifeste son intention, vous devez lui c√©der le passage (et vous arr√™ter si besoin).' },
            { theme: 'usagers', q: 'Le tramway a-t-il une priorit√© particuli√®re ?', answers: ['Oui, sauf signalisation contraire', 'Non', 'Priorit√© √† droite', 'Seulement aux feux'], correct: 0, explanation: 'Le tramway est prioritaire sauf si un feu ou un panneau en dispose autrement.' },
            { theme: 'environnement', q: 'En adoptant l‚Äô√©co-conduite, on peut r√©duire la consommation de carburant d‚Äôenviron :', answers: ['5 %', '10 %', '20 %', '40 %'], correct: 2, explanation: 'Anticiper, garder une vitesse stable, passer les rapports t√¥t : jusqu‚Äô√† ~20 % d‚Äô√©conomie.' },
            { theme: 'environnement', q: 'Combien de classes pour la vignette Crit‚ÄôAir ?', answers: ['3', '5', '6', '8'], correct: 2, explanation: '6 classes (0 √† 5). 0 = v√©hicules les plus propres (√©lectrique, hydrog√®ne).' },
            { theme: 'mecanique', q: 'Profondeur minimale des rainures des pneus (l√©gal) :', answers: ['0,8 mm', '1,6 mm', '2,5 mm', '3 mm'], correct: 1, explanation: '1,6 mm sur toute la bande de roulement. En dessous, c‚Äôest une infraction.' },
            { theme: 'mecanique', q: '√Ä quoi sert l‚ÄôABS ?', answers: ['√Ä limiter la vitesse', '√Ä √©viter le blocage des roues au freinage', '√Ä r√©duire la consommation', '√Ä am√©liorer le confort'], correct: 1, explanation: 'L‚ÄôABS limite le blocage des roues en freinage fort et aide √† garder le contr√¥le de la direction.' },
            { theme: 'secours', q: 'Que signifient les lettres P-A-S apr√®s un accident ?', answers: ['Prot√©ger, Alerter, Secourir', 'Pr√©venir, Attendre, Soigner', 'Police, Ambulance, Secours', 'Prudence, Arr√™t, Signal'], correct: 0, explanation: 'D‚Äôabord prot√©ger la zone, puis alerter les secours, puis secourir si on est form√©.' },
            { theme: 'secours', q: 'Quel num√©ro compose-t-on pour une urgence dans tout l‚ÄôUnion europ√©enne ?', answers: ['15', '17', '18', '112'], correct: 3, explanation: 'Le 112 fonctionne dans tous les pays de l‚ÄôUE.' },
            { theme: 'reglementation', q: 'Quelle assurance est obligatoire au minimum pour circuler ?', answers: ['Tous risques', 'Vol et incendie', 'Responsabilit√© civile', 'Bris de glace'], correct: 2, explanation: 'La RC couvre les dommages que vous causez aux autres. C‚Äôest le minimum l√©gal.' },
            { theme: 'reglementation', q: 'Circuler sans assurance peut entra√Æner une amende jusqu‚Äô√† :', answers: ['135 ‚Ç¨', '750 ‚Ç¨', '1 500 ‚Ç¨', '3 750 ‚Ç¨'], correct: 3, explanation: 'En plus : suspension du permis et possible confiscation du v√©hicule.' },
            { theme: 'reglementation', q: 'Permis probatoire : combien de points au d√©part ?', answers: ['4', '6', '8', '12'], correct: 1, explanation: '6 points au d√©part, puis augmentation progressive si pas d‚Äôinfraction.' },
            { theme: 'signalisation', q: 'Panneau bleu avec une fl√®che blanche (carr√©) : type de signal ?', answers: ['Interdiction', 'Indication', 'Danger', 'Obligation'], correct: 1, explanation: 'Carr√© bleu = indication (itin√©raire, parking, etc.).' },
            { theme: 'signalisation', q: 'Ligne axiale blanche en pointill√©s : peut-on la franchir pour d√©passer ?', answers: ['Non', 'Oui si la voie est libre', 'Seulement pour les deux-roues', 'Seulement de jour'], correct: 1, explanation: 'Ligne discontinue = franchissement autoris√© pour d√©passer quand c‚Äôest possible.' },
            { theme: 'priorites', q: 'Une voiture arrive ¬´ en face ¬ª sur une route √† sens unique. Qui est en infraction ?', answers: ['Vous', 'L‚Äôautre v√©hicule', 'Personne', 'Les deux'], correct: 1, explanation: 'Sur une voie √† sens unique, celui qui vient ¬´ en face ¬ª est √† contresens.' },
            { theme: 'priorites', q: 'En ville, un bus repart de son arr√™t (clignotants). Vous devez :', answers: ['Garder la priorit√©', 'C√©der le passage au bus', 'Klaxonner', 'Doubler par la droite'], correct: 1, explanation: 'En agglom√©ration, on laisse la priorit√© aux bus qui quittent un arr√™t signal√©.' },
            { theme: 'vitesse', q: 'Zone de rencontre : limite de vitesse ?', answers: ['20 km/h', '30 km/h', '50 km/h', '70 km/h'], correct: 0, explanation: '20 km/h ; les pi√©tons peuvent utiliser la chauss√©e et sont prioritaires.' },
            { theme: 'vitesse', q: 'Brouillard, visibilit√© sous les 50 m : limite sur toute route ?', answers: ['30', '50', '80', '90'], correct: 1, explanation: 'Visibilit√© < 50 m : 50 km/h max partout, y compris autoroute.' },
            { theme: 'stationnement', q: 'Interdit de stationner √† moins de 5 m d‚Äôun passage pi√©ton :', answers: ['Avant uniquement', 'Apr√®s uniquement', 'Avant et apr√®s', 'La nuit seulement'], correct: 0, explanation: 'Interdit en amont (avant) pour ne pas cacher le passage aux autres usagers.' },
            { theme: 'conducteur', q: 'Amende pour t√©l√©phone en main au volant (hors accident) ?', answers: ['68 ‚Ç¨', '135 ‚Ç¨', '375 ‚Ç¨', '750 ‚Ç¨'], correct: 1, explanation: '135 ‚Ç¨ et 3 points. En cas d‚Äôaccident, la sanction peut √™tre plus lourde.' },
            { theme: 'conducteur', q: 'Combien de points peut-on r√©cup√©rer au maximum avec un stage ?', answers: ['2', '4', '6', '8'], correct: 1, explanation: 'Un stage de r√©cup√©ration peut rendre au maximum 4 points (une fois par an, sous conditions).' },
            { theme: 'usagers', q: 'En agglom√©ration, distance minimale pour d√©passer un cycliste ?', answers: ['0,5 m', '1 m', '1,5 m', '2 m'], correct: 1, explanation: '1 m en ville, 1,50 m hors agglom√©ration.' },
            { theme: 'usagers', q: 'Vitesse maximale r√©glementaire pour une trottinette √©lectrique (EDPM) ?', answers: ['6 km/h', '25 km/h', '45 km/h', '50 km/h'], correct: 1, explanation: '25 km/h (vitesse maximale par construction).' },
            { theme: 'environnement', q: 'Que veut dire l‚Äôacronyme ZFE (en mobilit√©) ?', answers: ['Zone de forte √©mission', 'Zone √† faibles √©missions', 'Zone de freinage d‚Äôurgence', 'Zone de formation'], correct: 1, explanation: 'Zone √† faibles √©missions. La vignette Crit‚ÄôAir peut y √™tre exig√©e.' },
            { theme: 'mecanique', q: 'Feux de brouillard arri√®re : dans quels cas les utiliser ?', answers: ['D√®s qu‚Äôil pleut', 'Visibilit√© < 200 m', 'Visibilit√© < 100 m', 'Sur autoroute uniquement'], correct: 2, explanation: 'Uniquement si la visibilit√© est inf√©rieure √† 100 m (brouillard, neige). Les √©teindre d√®s que √ßa s‚Äôam√©liore.' },
            { theme: 'mecanique', q: 'Apr√®s le premier contr√¥le technique (v√©hicule neuf), la p√©riodicit√© est :', answers: ['Tous les ans', 'Tous les 2 ans', 'Tous les 3 ans', 'Tous les 5 ans'], correct: 1, explanation: 'Premier CT avant 4 ans, puis tous les 2 ans.' },
            { theme: 'secours', q: 'Quel num√©ro pour les pompiers ?', answers: ['15', '17', '18', '112'], correct: 2, explanation: '18 = pompiers. 15 = SAMU, 17 = police, 112 = urgence europ√©en.' },
            { theme: 'secours', q: 'Apr√®s avoir prot√©g√© et alert√© sur un accident, que faire si on n‚Äôest pas form√© aux gestes ?', answers: ['D√©placer les bless√©s', 'Donner √† boire', 'Secourir seulement si form√©', 'Partir'], correct: 2, explanation: 'Le S de PAS = secourir si on a une formation (PSC1, etc.). Sinon, ne pas d√©placer un bless√© sauf danger vital.' },
            { theme: 'reglementation', q: 'Quels documents doit-on avoir en conduisant ?', answers: ['Permis + assurance', 'Permis + assurance + carte grise', 'Assurance seule', 'Carte grise seule'], correct: 1, explanation: 'Permis, attestation d‚Äôassurance et carte grise (certificat d‚Äôimmatriculation).' },
            { theme: 'reglementation', q: 'Conduire alors qu‚Äôon n‚Äôa jamais eu le permis est :', answers: ['Une contravention', 'Un d√©lit', 'Une simple amende', 'Un avertissement'], correct: 1, explanation: 'Conduite sans permis (jamais obtenu) = d√©lit, passage devant le tribunal possible.' },
            { theme: 'signalisation', q: 'Rond rouge avec une barre horizontale blanche : que signifie-t-il ?', answers: ['Interdiction d‚Äôacc√®s', 'Obligation', 'Indication', 'Danger'], correct: 0, explanation: 'Souvent ¬´ sens interdit ¬ª ou interdiction d‚Äôacc√®s.' },
            { theme: 'priorites', q: 'Vous quittez un chemin non goudronn√© pour rejoindre une route. Qui c√®de ?', answers: ['Les v√©hicules sur la route', 'Vous', 'Priorit√© √† droite', 'Le premier arriv√©'], correct: 1, explanation: 'En sortant d‚Äôune voie non ouverte √† la circulation publique, on c√®de le passage √† tous.' },
            { theme: 'signalisation', q: 'Un panneau bleu avec un v√©lo et un pi√©ton indique :', answers: ['Interdiction aux v√©los', 'Voie r√©serv√©e aux cyclistes et pi√©tons', 'Danger cyclistes', 'Parking v√©los'], correct: 1, explanation: 'Panneau carr√© bleu = indication. Ce type signale une bande ou voie partag√©e cyclistes et pi√©tons.' },
            { theme: 'signalisation', q: 'Vous voyez un panneau ¬´ Fin de limitation ¬ª (noir sur blanc). Vous devez :', answers: ['Rester √† la vitesse indiqu√©e', 'Respecter la limite par d√©faut de la route', 'Acc√©l√©rer imm√©diatement', 'Allumer les feux'], correct: 1, explanation: 'La fin de limitation signifie que la limite pr√©c√©dente ne s\'applique plus ; la r√®gle par d√©faut reprend (50 en ville, 80 ou 90 hors agglo).' },
            { theme: 'priorites', q: 'Un tramway quitte un arr√™t et reprend sa marche. Vous √™tes en voiture sur la chauss√©e.', answers: ['Vous avez la priorit√©', 'Vous devez c√©der le passage au tramway', 'Priorit√© √† droite', 'Le tramway doit s\'arr√™ter'], correct: 1, explanation: 'Le tramway est prioritaire sauf signalisation contraire ; en repartant d\'un arr√™t, il doit pouvoir s\'ins√©rer.' },
            { theme: 'priorites', q: 'Vous traversez une place sans marquage ni feu. Plusieurs v√©hicules arrivent de diff√©rentes directions.', answers: ['Celui qui va le plus vite', 'Priorit√© √† droite s\'applique', 'Tout le monde doit s\'arr√™ter', 'Priorit√© aux v√©hicules lourds'], correct: 1, explanation: 'En l\'absence de signalisation, la priorit√© √† droite s\'applique sur les carrefours et places.' },
            { theme: 'vitesse', q: 'Sur une route √† chauss√©e s√©par√©e (2 x 2 voies) hors agglom√©ration, limite par d√©faut :', answers: ['80 km/h', '90 km/h', '110 km/h', '130 km/h'], correct: 2, explanation: 'Route √† chauss√©e s√©par√©e (type 2 x 2 voies) hors agglo : 110 km/h par d√©faut.' },
            { theme: 'vitesse', q: 'Un panneau indique ¬´ 70 ¬ª. Cela signifie :', answers: ['Vitesse minimum 70', 'Vitesse maximum 70 km/h', 'Route num√©ro 70', '70 m√®tres avant danger'], correct: 1, explanation: 'Panneau rond avec chiffre = limitation de vitesse maximale autoris√©e (70 km/h).' },
            { theme: 'stationnement', q: 'Stationner sur un emplacement r√©serv√© aux v√©hicules √©lectriques en recharge, sans recharger :', answers: ['Autoris√© si court', 'Interdit', 'Autoris√© la nuit', 'Autoris√© si pas de borne'], correct: 1, explanation: 'Les emplacements de recharge sont r√©serv√©s aux v√©hicules en cours de recharge ; stationner sans recharger est interdit.' },
            { theme: 'stationnement', q: 'Vous vous garez devant une bouche d\'incendie. C\'est :', answers: ['Autoris√© moins de 5 min', 'Interdit', 'Autoris√© si pas de panneau', 'Autoris√© la nuit'], correct: 1, explanation: 'Stationnement interdit √† moins de 5 m d\'une bouche d\'incendie (visibilit√© et acc√®s).' },
            { theme: 'conducteur', q: 'Conduire apr√®s avoir consomm√© du cannabis est :', answers: ['Tol√©r√© en petite quantit√©', 'Interdit', 'Autoris√© en journ√©e', 'Sanctionn√© seulement en cas d\'accident'], correct: 1, explanation: 'Conduire sous l\'influence de stup√©fiants (dont cannabis) est interdit, quel que soit le taux.' },
            { theme: 'conducteur', q: 'Combien de points peut-on perdre pour un exc√®s de vitesse sup√©rieur √† 40 km/h en agglo ?', answers: ['2 points', '4 points', '6 points', '8 points'], correct: 1, explanation: 'Exc√®s de vitesse > 40 km/h en agglom√©ration : 4 points (et amende, suspension possible).' },
            { theme: 'conducteur', q: 'Le disque ¬´ A ¬ª (jeune conducteur) doit √™tre affich√© combien de temps apr√®s l\'obtention du permis ?', answers: ['6 mois', '1 an', '2 ans', '3 ans'], correct: 3, explanation: 'Disque A obligatoire pendant 3 ans (ou 2 ans si conduite accompagn√©e) apr√®s l\'obtention du permis.' },
            { theme: 'usagers', q: 'Un cycliste roule sur une piste cyclable √† votre droite. Vous tournez √† droite.', answers: ['Vous avez la priorit√©', 'Vous devez c√©der le passage au cycliste', 'Priorit√© √† droite', 'Le cycliste doit s\'arr√™ter'], correct: 1, explanation: 'En tournant √† droite, vous coupez la piste cyclable : vous devez c√©der le passage aux cyclistes qui la suivent.' },
            { theme: 'usagers', q: 'Un pi√©ton traverse en dehors d\'un passage, sur une route. Vous devez :', answers: ['Klaxonner et acc√©l√©rer', 'Ne pas lui c√©der', 'Ralentir et c√©der si sa s√©curit√© l\'exige', 'Ignorer'], correct: 2, explanation: 'Hors passage, le pi√©ton n\'a pas la priorit√© mais vous devez ne pas lui faire courir de risque (ralentir, c√©der si besoin).' },
            { theme: 'usagers', q: 'Une trottinette √©lectrique (EDPM) circule sur le trottoir. C\'est :', answers: ['Autoris√© √† 6 km/h max', 'Interdit', 'Autoris√© partout', 'Autoris√© seulement la nuit'], correct: 0, explanation: 'Sur trottoir, l\'EDPM doit rouler √† 6 km/h max et ne pas g√™ner les pi√©tons ; sinon il doit √™tre sur la chauss√©e ou piste.' },
            { theme: 'environnement', q: 'Couper le moteur √† l\'arr√™t prolong√© (plus de 1 minute) en ville :', answers: ['Interdit', 'Recommand√© pour limiter pollution et bruit', 'Obligatoire partout', 'Seulement la nuit'], correct: 1, explanation: 'Couper le moteur √† l\'arr√™t prolong√© limite les √©missions et le bruit ; certaines zones l\'imposent.' },
            { theme: 'environnement', q: 'Quelle vignette Crit\'Air est r√©serv√©e aux v√©hicules 100 % √©lectriques ou hydrog√®ne ?', answers: ['Crit\'Air 1', 'Crit\'Air 2', 'Crit\'Air 0', 'Crit\'Air 5'], correct: 2, explanation: 'Crit\'Air 0 = v√©hicules les plus propres (√©lectrique, hydrog√®ne).' },
            { theme: 'mecanique', q: 'Feux de brouillard avant : quand peut-on les allumer ?', answers: ['Seulement la nuit', 'Brouillard, neige, forte pluie (visibilit√© r√©duite)', 'Jamais sur autoroute', 'Uniquement en ville'], correct: 1, explanation: 'Feux de brouillard avant autoris√©s par temps de brouillard, neige ou forte pluie (visibilit√© r√©duite).' },
            { theme: 'mecanique', q: 'Le t√©moin de pression des pneus s\'allume. Vous devez :', answers: ['Continuer √† vitesse r√©duite', 'Contr√¥ler la pression et r√©parer si besoin', '√âteindre le t√©moin', 'Rouler √† 30 km/h max'], correct: 1, explanation: 'T√©moin de pression = contr√¥le des pneus n√©cessaire (sous-gonflage ou crevaison).' },
            { theme: 'secours', q: 'Sur autoroute, en cas d\'accident, quel num√©ro composer en priorit√© ?', answers: ['Le 15', 'Le 18', 'Le 112 ou borne d\'appel', 'Le 17'], correct: 2, explanation: 'Sur autoroute, utiliser les bornes d\'appel (localisation pr√©cise) ou le 112.' },
            { theme: 'secours', q: '¬´ Prot√©ger ¬ª dans le PAS signifie notamment :', answers: ['Appeler la police', 'S√©curiser la zone (gilets, triangle, couper contact)', 'Donner les premiers soins', 'Prendre des photos'], correct: 1, explanation: 'Prot√©ger = mettre les occupants en s√©curit√©, baliser (triangle, feux), couper les contacts pour √©viter incendie.' },
            { theme: 'reglementation', q: 'Vendre son v√©hicule sans faire le changement de propri√©taire (carte grise) :', answers: ['Autoris√©', 'Interdit ; le vendeur reste responsable', 'Obligatoire apr√®s 1 an', 'Seulement si acheteur √©tranger'], correct: 1, explanation: 'Le vendeur doit faire la d√©claration de cession ; sinon il reste responsable (amendes, infractions).' },
            { theme: 'reglementation', q: 'Refus de remettre le permis apr√®s retrait total :', answers: ['Simple contravention', 'D√©lit', 'Aucune sanction', 'Amende l√©g√®re'], correct: 1, explanation: 'Refuser de remettre son permis apr√®s retrait total est un d√©lit (tribunal, peine possible).' },
            { theme: 'reglementation', q: 'Contr√¥le technique refus√© (d√©faut majeur). D√©lai pour le repasser ?', answers: ['1 mois', '2 mois', 'Aucun d√©lai impos√©', 'Imm√©diatement'], correct: 1, explanation: 'En cas de contre-visite, un d√©lai (souvent 2 mois) est donn√© pour faire r√©parer et repasser le contr√¥le.' },
            { theme: 'signalisation', q: 'Panneau ¬´ Sens interdit ¬ª : forme et couleur typiques :', answers: ['Triangle rouge', 'Rond rouge √† barre blanche', 'Carr√© bleu', 'Rond bleu'], correct: 1, explanation: 'Sens interdit = panneau rond rouge avec une barre horizontale blanche.' },
            { theme: 'priorites', q: 'Vous √™tes sur un passage √† niveau sans barri√®re. Un train approche. Que faire ?', answers: ['Traverser rapidement', 'S\'arr√™ter avant les rails et ne pas s\'engager', 'Klaxonner', 'Priorit√© √† droite'], correct: 1, explanation: '√Ä un passage √† niveau, on ne s\'engage que si la travers√©e est possible sans risque ; si un train approche, on s\'arr√™te.' },
            { theme: 'vitesse', q: 'Rouler √† 45 km/h en zone 30 vous expose √† :', answers: ['Aucune sanction', 'Amende et retrait de points', 'Seulement un avertissement', 'Stage obligatoire'], correct: 1, explanation: 'D√©passement de plus de 15 km/h en zone 30 = amende et retrait de points (exc√®s de vitesse).' },
            { theme: 'stationnement', q: 'Stationnement g√™nant (ex. devant une sortie de garage) :', answers: ['Tol√©r√© si court', 'Interdit et peut entra√Æner fourri√®re', 'Autoris√© la nuit', 'Amende uniquement sans d√©placement'], correct: 1, explanation: 'Stationnement g√™nant (sortie garage, passage) peut donner lieu √† mise en fourri√®re et amende.' },
            { theme: 'conducteur', q: 'Apr√®s une op√©ration des yeux (ex. laser), conduire est autoris√© :', answers: ['D√®s le lendemain', 'D√®s que le m√©decin l\'autorise', 'Apr√®s 1 semaine', 'Sans avis m√©dical'], correct: 1, explanation: 'Apr√®s une op√©ration pouvant affecter la vision, l\'autorisation du m√©decin est n√©cessaire avant de reconduire.' },
            { theme: 'usagers', q: 'Un autocar scolaire fait monter ou descendre des enfants. Il a des feux clignotants. Vous d√©passez par la gauche.', answers: ['Autoris√© √† 30 km/h', 'Interdit ; il faut s\'arr√™ter', 'Autoris√© √† 50 km/h', 'Autoris√© en klaxonnant'], correct: 1, explanation: 'En pr√©sence d\'un car scolaire avec feux clignotants (mont√©e/descente), il faut s\'arr√™ter et ne pas d√©passer.' },
            { theme: 'mecanique', q: 'Niveau d\'huile moteur bas. Vous devez :', answers: ['Rouler √† 50 km/h max', 'Contr√¥ler et compl√©ter avant de repartir', 'Allumer les feux de d√©tresse', 'Ralentir seulement'], correct: 1, explanation: 'Huile insuffisante = risque de casse moteur. Il faut contr√¥ler le niveau et compl√©ter (ou faire r√©parer) avant de repartir.' },
            { theme: 'secours', q: 'En cas de malaise d\'un passager, apr√®s avoir s√©curis√© le v√©hicule, vous devez :', answers: ['Le faire boire', 'Alerter les secours (15 ou 112) et suivre les consignes', 'Le laisser dormir', 'Conduire √† l\'h√¥pital sans appeler'], correct: 1, explanation: 'Alerter les secours (15 SAMU ou 112) et suivre leurs instructions ; ne pas d√©placer un malade sans avis.' },
            { theme: 'reglementation', q: 'Pr√™t de son v√©hicule √† un ami sans permis :', answers: ['Autoris√© sur court trajet', 'Interdit ; le pr√™teur peut √™tre sanctionn√©', 'Autoris√© avec assurance', 'Tol√©r√© en zone rurale'], correct: 1, explanation: 'Pr√™ter son v√©hicule √† une personne sans permis peut engager la responsabilit√© du pr√™teur (complicit√©).' },
            // Questions suppl√©mentaires pour Quiz rapide (Chrono)
            { theme: 'signalisation', q: 'Un panneau rond rouge avec un v√©lo barr√© signifie :', answers: ['Zone cyclable', 'Acc√®s cyclistes interdit', 'Piste cyclable obligatoire', 'Attention cyclistes'], correct: 1, explanation: 'Panneau rond rouge = interdiction. V√©lo barr√© = acc√®s interdit aux cyclistes.' },
            { theme: 'vitesse', q: 'Vitesse max en zone 30 ?', answers: ['20 km/h', '30 km/h', '50 km/h', '70 km/h'], correct: 1, explanation: 'Zone 30 : limite de 30 km/h dans les zones r√©sidentielles ou abords d\'√©coles.' },
            { theme: 'priorites', q: 'Vous tournez √† gauche. Un pi√©ton traverse. Qui est prioritaire ?', answers: ['Vous', 'Le pi√©ton', 'Priorit√© √† droite', 'Le plus rapide'], correct: 1, explanation: 'Le pi√©ton traversant r√©guli√®rement (passage ou carrefour) est toujours prioritaire.' },
            { theme: 'conducteur', q: 'Combien de points pour un permis invalid√© (retrait total) ?', answers: ['0 point', '6 points', '8 points', '12 points'], correct: 0, explanation: 'Permis invalid√© = 0 point. Il faut repasser l\'examen pour retrouver un permis.' },
            { theme: 'stationnement', q: 'Marcher arri√®re pour stationner : limite de distance ?', answers: ['5 m', '15 m', '50 m', 'Pas de limite l√©gale'], correct: 3, explanation: 'Pas de distance max l√©gale en marche arri√®re, mais il faut rester raisonnable et s√©curis√©.' },
            { theme: 'usagers', q: 'Un cheval mont√© sur la route. Distance min pour le d√©passer ?', answers: ['1 m', '1,50 m', '2 m', '3 m'], correct: 1, explanation: 'Hors agglo : 1,50 m minimum pour d√©passer un cheval ou v√©lo. En ville : 1 m.' },
            { theme: 'mecanique', q: 'Feux diurnes (diurnes) : obligatoires de jour ?', answers: ['Oui, toujours', 'Non', 'Seulement hors agglo', 'Seulement sur autoroute'], correct: 1, explanation: 'Les feux diurnes ne sont pas obligatoires ; les feux de croisement ou diurnes am√©liorent la visibilit√©.' },
            { theme: 'secours', q: 'Triangle de pr√©signalisation : √† quelle distance le placer ?', answers: ['10 m', '30 m', '50 m', '100 m'], correct: 1, explanation: 'En cas d\'arr√™t d\'urgence, placer le triangle √† environ 30 m (voire plus sur autoroute).' },
            { theme: 'reglementation', q: 'Gilet jaune : quand doit-on le porter ?', answers: ['En permanence en conduisant', 'Seulement la nuit', 'En cas d\'arr√™t d\'urgence hors v√©hicule', 'Sur autoroute uniquement'], correct: 2, explanation: 'Le gilet doit √™tre port√© d√®s qu\'on sort du v√©hicule en cas d\'arr√™t d\'urgence sur la chauss√©e.' },
            { theme: 'environnement', q: 'Rouler fen√™tres ouvertes √† 130 km/h : impact sur la consommation ?', answers: ['N√©gligeable', 'Augmente d\'environ 5 %', 'Diminue la conso', 'Aucun impact'], correct: 1, explanation: 'Les fen√™tres ouvertes augmentent la r√©sistance √† l\'air et donc la consommation.' },
            { theme: 'vitesse', q: 'Autoroute : temps sec, limite pour permis probatoire ?', answers: ['100 km/h', '110 km/h', '120 km/h', '130 km/h'], correct: 1, explanation: 'Permis de moins de 3 ans : 110 km/h max sur autoroute (au lieu de 130).' },
            { theme: 'conducteur', q: 'Conduire avec un taux d\'alcool entre 0,5 et 0,8 g/L (permis confirm√©) :', answers: ['Pas de sanction', 'Amende et retrait de points', 'Permis invalid√©', 'Prison uniquement'], correct: 1, explanation: 'Entre 0,5 et 0,8 g/L : contravention (amende, points). Au-del√† de 0,8 : d√©lit.' },
            { theme: 'signalisation', q: 'Panneau ¬´ Passage pi√©ton ¬ª : forme typique ?', answers: ['Triangle rouge', 'Rond bleu', 'Carr√© bleu avec bandes', 'Rond rouge'], correct: 2, explanation: 'Passage pi√©ton = panneau carr√© bleu avec le pictogramme blanc du pi√©ton sur bandes.' },
            { theme: 'priorites', q: 'Vous √™tes en train de traverser un carrefour. Le feu passe √† l\'orange puis au rouge. Que faire ?', answers: ['Faire demi-tour', 'Continuer pour lib√©rer le carrefour', 'S\'arr√™ter au milieu', 'Klaxonner'], correct: 1, explanation: 'Si vous avez d√©j√† commenc√© √† traverser, terminez le passage pour ne pas bloquer le carrefour.' },
            { theme: 'signalisation', q: 'Un panneau ¬´ Bouchon ¬ª ou ¬´ Embouteillage ¬ª vous indique :', answers: ['Une interdiction', 'Un danger √† anticiper', 'Une obligation de ralentir √† 30', 'Une sortie d\'autoroute'], correct: 1, explanation: 'Panneau d\'avertissement : risque de ralentissement ou bouchon ; adapter la vitesse et la distance.' },
            { theme: 'vitesse', q: 'Sur autoroute, par temps de pluie, vous devez :', answers: ['Rouler √† 130 km/h', 'Limiter √† 110 km/h et augmenter les distances', 'Allumer les feux de brouillard arri√®re', 'Rouler sur la bande d\'arr√™t d\'urgence'], correct: 1, explanation: 'Pluie sur autoroute : 110 km/h max et distance de s√©curit√© augment√©e.' },
            { theme: 'stationnement', q: 'Stationnement interdit devant une bouche d\'incendie : √† moins de ?', answers: ['2 m', '5 m', '10 m', '15 m'], correct: 1, explanation: 'Stationnement interdit √† moins de 5 m d\'une bouche d\'incendie.' },
            { theme: 'conducteur', q: 'Conduire sous l\'influence de stup√©fiants (cannabis, etc.) :', answers: ['Tol√©r√© en faible quantit√©', 'Interdit quel que soit le taux', 'Sanctionn√© seulement en cas d\'accident', 'Amende sans retrait de points'], correct: 1, explanation: 'Stup√©fiants au volant : interdit, contr√¥le possible, sanctions lourdes (points, suspension, d√©lit).' },
            { theme: 'usagers', q: 'Vous d√©passez un groupe de cyclistes. Vous devez :', answers: ['Klaxonner pour les pr√©venir', 'Les d√©passer un par un en gardant 1 m (ville) ou 1,50 m (hors agglo)', 'Rouler √† 30 km/h max', 'Ne jamais les d√©passer'], correct: 1, explanation: 'Distance min : 1 m en agglo, 1,50 m hors agglo. On peut d√©passer en une fois si la voie est assez large.' },
            { theme: 'mecanique', q: 'Le voyant ¬´ pression des pneus ¬ª s\'allume. Vous devez :', answers: ['Continuer √† vitesse r√©duite', 'Contr√¥ler la pression et r√©parer si besoin', '√âteindre le voyant', 'Rouler √† 50 km/h max'], correct: 1, explanation: 'Voyant pression = sous-gonflage ou crevaison ; contr√¥ler et corriger avant de repartir.' },
            { theme: 'secours', q: 'Sur autoroute, en cas d\'accident, vous devez en priorit√© :', answers: ['Appeler le 15', 'Utiliser les bornes d\'appel ou le 112 (localisation pr√©cise)', 'Faire des signes aux autres v√©hicules', 'Repartir pour √©viter un sur-accident'], correct: 1, explanation: 'Les bornes d\'appel permettent de localiser pr√©cis√©ment ; sinon 112 en indiquant le point kilom√©trique.' },
            { theme: 'reglementation', q: 'Assurance au tiers (RC) couvre :', answers: ['Votre v√©hicule et les tiers', 'Uniquement les dommages que vous causez aux autres', 'Le vol et l\'incendie', 'Les d√©g√¢ts √† votre voiture'], correct: 1, explanation: 'RC = responsabilit√© civile : dommages caus√©s aux autres. Pas les d√©g√¢ts √† votre propre v√©hicule.' },
            { theme: 'environnement', q: 'En zone √† faibles √©missions (ZFE), que peut exiger la r√©glementation ?', answers: ['Rien', 'Vignette Crit\'Air selon le v√©hicule', 'V√©hicule √©lectrique uniquement', 'Interdiction totale de circuler'], correct: 1, explanation: 'En ZFE, la vignette Crit\'Air peut √™tre obligatoire ; les v√©hicules les plus polluants peuvent √™tre interdits.' },
            { theme: 'priorites', q: 'Vous entrez dans un giratoire. Un v√©hicule est d√©j√† dans l\'anneau. Qui a la priorit√© ?', answers: ['Vous', 'Le v√©hicule dans le giratoire', 'Priorit√© √† droite', 'Celui qui klaxonne'], correct: 1, explanation: 'Dans un giratoire avec ¬´ C√©dez le passage ¬ª, priorit√© aux v√©hicules d√©j√† engag√©s dans l\'anneau.' },
            { theme: 'signalisation', q: 'Panneau ¬´ Fin d\'interdiction de d√©passer ¬ª : vous pouvez :', answers: ['Toujours d√©passer', 'D√©passer si la voie est libre et la visibilit√© suffisante', 'D√©passer seulement les deux-roues', 'Ne jamais d√©passer'], correct: 1, explanation: 'Fin d\'interdiction = vous pouvez √† nouveau d√©passer si les conditions de s√©curit√© sont r√©unies.' },
            { theme: 'vitesse', q: 'En agglom√©ration, sans panneau, la limite par d√©faut est :', answers: ['30 km/h', '50 km/h', '70 km/h', '90 km/h'], correct: 1, explanation: 'En ville, 50 km/h sauf zone 30, zone de rencontre ou autre signalisation.' },
            { theme: 'conducteur', q: 'Fatigue : la meilleure solution est :', answers: ['Ouvrir la fen√™tre', 'Faire une pause ou changer de conducteur', 'Boire un caf√©', 'Augmenter le volume de la radio'], correct: 1, explanation: 'Seule une vraie pause (repos, sommeil court) ou un changement de conducteur est efficace.' },
            { theme: 'usagers', q: 'Un pi√©ton traverse en dehors d\'un passage. Vous devez :', answers: ['Klaxonner et acc√©l√©rer', 'Ne pas lui c√©der', 'Ralentir et ne pas le mettre en danger', 'L\'ignorer'], correct: 2, explanation: 'Hors passage il n\'a pas la priorit√©, mais vous devez √©viter de le mettre en danger.' },
            { theme: 'mecanique', q: 'P√©riodicit√© du contr√¥le technique apr√®s le premier (v√©hicule neuf) ?', answers: ['Tous les ans', 'Tous les 2 ans', 'Tous les 3 ans', 'Tous les 5 ans'], correct: 1, explanation: 'Premier CT avant 4 ans, puis tous les 2 ans.' },
            { theme: 'secours', q: '¬´ Alerter ¬ª dans le PAS signifie :', answers: ['Prot√©ger la zone', 'Appeler les secours (15, 18, 112‚Ä¶)', 'Donner les premiers soins', 'Prendre des photos'], correct: 1, explanation: 'A = Alerter : composer le 15 (SAMU), 18 (pompiers) ou 112 en pr√©cisant lieu et situation.' },
            { theme: 'reglementation', q: 'Document √† pr√©senter en cas de contr√¥le par les forces de l\'ordre ?', answers: ['Permis uniquement', 'Permis, carte grise, attestation d\'assurance', 'Carte grise uniquement', 'Assurance uniquement'], correct: 1, explanation: 'Permis de conduire, certificat d\'immatriculation (carte grise), attestation d\'assurance.' },
            { theme: 'stationnement', q: 'Ligne jaune en bord de chauss√©e (souvent arr√™t de bus) :', answers: ['Stationnement autoris√©', 'Arr√™t et stationnement interdits', 'Arr√™t autoris√© moins de 3 min', 'R√©serv√© bus uniquement la journ√©e'], correct: 1, explanation: 'Ligne jaune = arr√™t et stationnement interdits (souvent zone d\'arr√™t de bus).' }
        ];
        
        // R√©partition : examen blanc et quiz par th√®me n'utilisent pas les m√™mes questions
        const questionsExam = questions.filter((_, i) => i % 2 === 0);
        const questionsQuiz = questions.filter((_, i) => i % 2 === 1);
        
        // Illustrations uniques pour l'examen blanc (index = index dans questions[], une image par question si d√©finie)
        function svgExam(s) {
            if (s.indexOf('viewBox="0 0 120 80"') !== -1 && s.indexOf('<rect fill="#f8f9fa"') === -1 && s.indexOf('<rect fill="#e9ecef"') === -1 && s.indexOf('<rect fill="#f0f2f5"') === -1)
                s = s.replace('viewBox="0 0 120 80">', 'viewBox="0 0 120 80"><rect fill="#f0f2f5" width="120" height="80"/>');
            return 'data:image/svg+xml,' + encodeURIComponent(s);
        }
        function sceneExam(i) {
            var q = questions[i], t = q.theme, qtext = (q.q||'').toLowerCase();
            var has=function(){for(var j=0;j<arguments.length;j++) if(qtext.indexOf(arguments[j])!==-1) return true; return false;};
            var s = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 160 100">'+
            '<defs><linearGradient id="roadG" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#2d3748"/><stop offset="0.15" stop-color="#374151"/><stop offset="0.35" stop-color="#4b5563"/><stop offset="0.5" stop-color="#3d4852"/><stop offset="0.7" stop-color="#4a5568"/><stop offset="0.85" stop-color="#374151"/><stop offset="1" stop-color="#1f2937"/></linearGradient>'+
            '<linearGradient id="skyG" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#475569"/><stop offset="0.2" stop-color="#64748b"/><stop offset="0.45" stop-color="#94a3b8"/><stop offset="0.7" stop-color="#cbd5e1"/><stop offset="0.88" stop-color="#e2e8f0"/><stop offset="1" stop-color="#f1f5f9"/></linearGradient>'+
            '<linearGradient id="grassG" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#4a6b1f"/><stop offset="0.25" stop-color="#4d7c23"/><stop offset="0.5" stop-color="#42631e"/><stop offset="0.75" stop-color="#365318"/><stop offset="1" stop-color="#2d4a14"/></linearGradient>'+
            '<radialGradient id="sunG" cx="0.5" cy="0.4" r="0.8"><stop offset="0" stop-color="#fffef0"/><stop offset="0.25" stop-color="#fef9c3"/><stop offset="0.5" stop-color="#fde68a" stop-opacity="0.95"/><stop offset="0.75" stop-color="#fcd34d" stop-opacity="0.6"/><stop offset="1" stop-color="#fbbf24" stop-opacity="0"/></radialGradient>'+
            '<radialGradient id="vignetteG" cx="0.5" cy="0.5" r="0.85"><stop offset="0" stop-color="#000" stop-opacity="0"/><stop offset="0.7" stop-color="#000" stop-opacity="0"/><stop offset="1" stop-color="#000" stop-opacity="0.4"/></radialGradient>'+
            '<linearGradient id="metalG" x1="0" y1="0" x2="1" y2="0"><stop offset="0" stop-color="#3f3f46"/><stop offset="0.2" stop-color="#52525b"/><stop offset="0.5" stop-color="#a1a1aa"/><stop offset="0.8" stop-color="#52525b"/><stop offset="1" stop-color="#3f3f46"/></linearGradient>'+
            '<filter id="blurSh" x="-20%" y="-20%" width="140%" height="140%"><feGaussianBlur in="SourceAlpha" stdDeviation="2"/><feOffset dx="2" dy="3" result="off"/><feFlood flood-color="#0f172a" flood-opacity="0.45"/><feComposite in2="off" operator="in"/><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>'+
            '<filter id="softSh" x="-30%" y="-10%" width="160%" height="120%"><feDropShadow dx="0" dy="2" stdDeviation="2.5" flood-color="#0f172a" flood-opacity="0.4"/></filter></defs>'+
            '<rect fill="url(#skyG)" width="160" height="100"/>'+
            '<ellipse cx="130" cy="18" rx="38" ry="22" fill="url(#sunG)" opacity="0.92"/>'+
            '<ellipse cx="128" cy="20" rx="22" ry="14" fill="#fefce8"/>'+
            '<ellipse cx="126" cy="19" rx="12" ry="8" fill="#fef9c3"/>'+
            '<rect x="0" y="54" width="160" height="46" fill="url(#grassG)"/>'+
            '<path d="M0 56 Q20 55 40 56 Q60 55 80 56 Q100 55 120 56 Q140 55 160 56 L160 100 L0 100 Z" fill="#3d6220" opacity="0.5"/>'+
            '<path d="M0 57 Q50 56 80 57 Q110 56 160 57 L160 100 L0 100 Z" fill="#2d4a14" opacity="0.35"/>'+
            '<rect x="0" y="48" width="160" height="10" fill="#374151"/>'+
            '<rect x="0" y="46" width="160" height="2" fill="#1f2937"/>'+
            '<rect x="0" y="42" width="160" height="28" fill="url(#roadG)"/>'+
            '<rect x="0" y="42" width="160" height="1" fill="#1e293b"/>'+
            '<rect x="0" y="69" width="160" height="1" fill="#111827"/>'+
            '<path d="M0 46 L160 47 M0 49 L160 50 M0 52 L160 53 M0 55 L160 56 M0 58 L160 59 M0 62 L160 63 M0 65 L160 66 M0 68 L160 69" stroke="#334155" stroke-width="0.25" opacity="0.5"/>'+
            '<rect x="0" y="0" width="160" height="100" fill="url(#vignetteG)"/>';
            var L=function(){return '';};
            var pole='';
            if(has('franchir une ligne blanche continue','ligne blanche continue','ligne blanche continue s√©pare','d√©passer')&&has('ligne')){
                s+='<rect x="0" y="36" width="160" height="28" fill="url(#roadG)"/>'+
                '<path d="M0 38 L160 39 M0 41 L160 42 M0 44 L160 45 M0 47 L160 48 M0 54 L160 55 M0 57 L160 58 M0 61 L160 62" stroke="#2d3748" stroke-width="0.35" opacity="0.4"/>'+
                '<rect x="0" y="36" width="160" height="2" fill="#1f2937"/>'+
                '<rect x="0" y="62" width="160" height="2" fill="#1f2937"/>'+
                '<path d="M0 50 L160 50" stroke="#374151" stroke-width="6"/>'+
                '<path d="M0 50 L160 50" stroke="#fff" stroke-width="4.5"/>'+
                '<path d="M0 49.5 L160 49.5" stroke="#fff" stroke-width="2" opacity="0.5"/>'+
                '<path d="M0 50 L160 50" stroke="#f8fafc" stroke-width="2.8"/>';
            }
            else if(has('ligne blanche discontinue','ligne discontinue','d√©passement autoris√©','pointill','axiale')){
                s+='<rect x="0" y="38" width="160" height="24" fill="url(#roadG)"/>'+
                '<path d="M0 39 L160 40 M0 43 L160 44 M0 47 L160 48 M0 55 L160 56 M0 59 L160 60" stroke="#2d3748" stroke-width="0.3" opacity="0.35"/>'+
                '<rect x="0" y="38" width="160" height="1" fill="#374151"/>'+
                '<rect x="0" y="61" width="160" height="1" fill="#1f2937"/>'+
                '<path d="M0 50 L160 50" stroke="#e2e8f0" stroke-width="4.5" stroke-dasharray="14 10" stroke-linecap="round"/>'+
                '<path d="M0 50 L160 50" stroke="#fff" stroke-width="3" stroke-dasharray="14 10" stroke-linecap="round"/>'+
                '<path d="M0 49.5 L160 49.5" stroke="#f8fafc" stroke-width="1.5" stroke-dasharray="14 10" stroke-linecap="round" opacity="0.7"/>';
            }
            else if(has('feu orange clignotant','orange clignotant')){
                s+='<ellipse cx="80" cy="84" rx="14" ry="4" fill="#0f172a" opacity="0.55"/>'+
                '<line x1="80" y1="52" x2="80" y2="80" stroke="#374151" stroke-width="2.5"/>'+
                '<line x1="80" y1="52" x2="80" y2="80" stroke="url(#metalG)" stroke-width="2"/>'+
                '<rect x="60" y="16" width="40" height="64" rx="6" fill="#1e293b" stroke="#1f2937" stroke-width="1"/>'+
                '<rect x="61" y="17" width="38" height="62" rx="5" fill="#0f172a" opacity="0.5"/>'+
                '<rect x="63" y="20" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="29" r="7" fill="#27272a"/><circle cx="80" cy="29" r="5" fill="#6b7280"/><circle cx="78" cy="27" r="1" fill="#9ca3af" opacity="0.5"/>'+
                '<rect x="63" y="39" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="48" r="7" fill="#27272a"/><circle cx="80" cy="48" r="5" fill="#f59e0b"/><circle cx="78" cy="46" r="2" fill="#fbbf24"/><circle cx="79" cy="47" r="0.8" fill="#fef3c7"/>'+
                '<rect x="63" y="58" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="67" r="7" fill="#27272a"/><circle cx="80" cy="67" r="5" fill="#6b7280"/><circle cx="78" cy="65" r="0.8" fill="#9ca3af" opacity="0.4"/>';
            }
            else if(has('feu orange','au feu orange')&&!qtext.includes('clignotant')){
                s+='<ellipse cx="80" cy="84" rx="12" ry="3" fill="#0f172a" opacity="0.5"/>'+
                '<line x1="80" y1="52" x2="80" y2="80" stroke="url(#metalG)" stroke-width="3"/>'+
                '<rect x="60" y="16" width="40" height="64" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1.5"/>'+
                '<rect x="63" y="20" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="29" r="7" fill="#374151"/><circle cx="80" cy="29" r="5" fill="#9ca3af"/>'+
                '<rect x="63" y="39" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="48" r="7" fill="#374151"/><circle cx="80" cy="48" r="5" fill="#f59e0b"/>'+
                '<circle cx="80" cy="47" r="2" fill="#fbbf24"/>'+
                '<rect x="63" y="58" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="66" r="7" fill="#4b5563"/><circle cx="80" cy="66" r="5" fill="#9ca3af"/>';
            }
            else if(has('panneau stop','au panneau stop','√† un stop','arr√™t complet obligatoire','marquer un arr√™t')){
                s+='<ellipse cx="80" cy="90" rx="30" ry="6" fill="#0f172a" opacity="0.55"/>'+
                '<line x1="80" y1="54" x2="80" y2="80" stroke="#374151" stroke-width="2.8"/>'+
                '<line x1="80" y1="54" x2="80" y2="80" stroke="url(#metalG)" stroke-width="2.2"/>'+
                '<line x1="80" y1="80" x2="77" y2="86" stroke="#27272a" stroke-width="2.5"/>'+
                '<polygon points="83,27 101,51 83,71 65,51" fill="#0f172a" opacity="0.5"/>'+
                '<polygon points="80,24 98,48 80,70 62,48" fill="#991b1b" stroke="#fff" stroke-width="2.2"/>'+
                '<polygon points="80,26 95,48 80,66 65,48" fill="#b91c1c"/>'+
                '<polygon points="80,28 92,48 80,64 68,48" fill="#dc2626"/>'+
                '<polygon points="79,32 81,30 83,32 80,34" fill="#fecaca" opacity="0.6"/>'+
                '<line x1="66" y1="50" x2="68" y2="48" stroke="#fca5a5" stroke-width="0.6" opacity="0.4"/>';
            }
            else if((has('c√©dez le passage','c√©der le passage','c√©dez le passage')||has('triangle pointe en bas','forme'))&&(has('panneau')||has('passage')||t==='priorites')){
                s+='<ellipse cx="80" cy="88" rx="24" ry="4" fill="#0f172a" opacity="0.45"/>'+
                '<line x1="80" y1="54" x2="80" y2="78" stroke="url(#metalG)" stroke-width="2.5"/>'+
                '<polygon points="83,21 105,79 57,79" fill="#0f172a" opacity="0.35"/>'+
                '<polygon points="80,20 102,76 58,76" fill="#fef08a" stroke="#dc2626" stroke-width="2.2"/>'+
                '<polygon points="80,26 96,70 64,70" fill="#fef9c3"/>'+
                '<polygon points="78,38 82,36 84,40 80,42" fill="#fef3c7" opacity="0.6"/>';
            }
            else if(has('giratoire','rond-point','rond point')&&(has('c√©dez','priorit√©')||t==='priorites')){
                s+='<circle cx="80" cy="52" r="38" fill="url(#roadG)"/>'+
                '<circle cx="80" cy="52" r="38" fill="none" stroke="#374151" stroke-width="2"/>'+
                '<circle cx="80" cy="52" r="24" fill="#4a5568"/>'+
                '<path d="M56 52 A24 24 0 0 1 80 28" stroke="#fff" stroke-width="2.5" fill="none" stroke-dasharray="8 5"/>'+
                '<ellipse cx="80" cy="26" rx="8" ry="6" fill="#1a202c" opacity="0.2"/>'+
                '<polygon points="80,22 94,48 80,72 66,48" fill="#fef08a" stroke="#dc2626" stroke-width="2"/>'+
                '<polygon points="80,26 90,48 80,68 70,48" fill="#fef9c3"/>';
            }
            else if((has('distance de s√©curit√©','2 secondes')&&t==='vitesse')||(has('v√©hicule devant','entre vous')&&has('secondes'))){
                s+='<rect x="25" y="38" width="110" height="28" fill="url(#roadG)"/>'+
                '<path d="M25 52 H135" stroke="#fff" stroke-width="2" stroke-dasharray="8 6"/>'+
                '<rect x="35" y="44" width="28" height="18" rx="2" fill="#2563eb"/><rect x="97" y="44" width="28" height="18" rx="2" fill="#64748b"/>';
            }
            else if(has('zone de rencontre','zone 20')&&(t==='vitesse'||has('vitesse max'))){
                s+='<ellipse cx="80" cy="88" rx="26" ry="4" fill="#0f172a" opacity="0.5"/>'+
                '<line x1="80" y1="54" x2="80" y2="78" stroke="url(#metalG)" stroke-width="2.5"/>'+
                '<rect x="47" y="22" width="66" height="52" rx="4" fill="#fff" stroke="#1f2937" stroke-width="2"/>'+
                '<circle cx="80" cy="48" r="18" fill="#fff" stroke="#dc2626" stroke-width="2.5"/>'+
                '<circle cx="80" cy="48" r="15" fill="#f8fafc"/>'+
                '<circle cx="78" cy="46" r="4" fill="#e2e8f0" opacity="0.8"/>';
            }
            else if((has('5 m','5 m√®tres','passage pi√©ton')&&t==='stationnement')||(has('stationnement interdit')&&has('passage pi√©ton'))){
                s+='<rect x="15" y="35" width="130" height="32" fill="url(#roadG)"/>'+
                '<rect x="48" y="38" width="64" height="26" fill="#fff" stroke="#1f2937" stroke-width="0.5"/>'+
                '<line x1="52" y1="38" x2="52" y2="64" stroke="#1f2937" stroke-width="2"/>'+
                '<line x1="62" y1="38" x2="62" y2="64" stroke="#1f2937" stroke-width="2"/>'+
                '<line x1="72" y1="38" x2="72" y2="64" stroke="#1f2937" stroke-width="2"/>'+
                '<line x1="82" y1="38" x2="82" y2="64" stroke="#1f2937" stroke-width="2"/>'+
                '<line x1="92" y1="38" x2="92" y2="64" stroke="#1f2937" stroke-width="2"/>'+
                '<line x1="102" y1="38" x2="102" y2="64" stroke="#1f2937" stroke-width="2"/>'+
                '<circle cx="80" cy="52" r="5" fill="#1e293b"/><line x1="80" y1="57" x2="80" y2="64" stroke="#1e293b" stroke-width="1.5"/>'+
                '<rect x="28" y="42" width="28" height="18" rx="2" fill="#2563eb"/>';
            }
            else if(has('ligne jaune')&&(t==='stationnement'||has('arr√™t interdit','marquage au sol'))){
                s+='<rect x="0" y="36" width="160" height="28" fill="url(#roadG)"/>'+
                '<rect x="0" y="36" width="160" height="1" fill="#374151"/>'+
                '<rect x="0" y="63" width="160" height="1" fill="#1f2937"/>'+
                '<path d="M0 52 L160 52" stroke="#ca8a04" stroke-width="4"/>'+
                '<path d="M0 52 L160 52" stroke="#facc15" stroke-width="2.5"/>';
            }
            else if(has('bus')&&(has('quitte','arr√™t signal√©','c√©der le passage'))){
                s+='<rect x="25" y="35" width="110" height="38" rx="3" fill="#d97706" stroke="#1a202c"/>'+
                '<rect x="32" y="40" width="16" height="14" fill="#fef3c7"/><rect x="52" y="40" width="16" height="14" fill="#fef3c7"/>'+
                '<rect x="72" y="40" width="16" height="14" fill="#fef3c7"/><rect x="105" y="42" width="10" height="22" fill="#78350f"/>'+
                '<circle cx="42" cy="70" r="5" fill="#1a202c"/><circle cx="118" cy="70" r="5" fill="#1a202c"/>'+
                '<rect x="38" y="28" width="28" height="22" rx="2" fill="#2563eb"/>';
            }
            else if(qtext.indexOf('bleu')!==-1&&(qtext.indexOf('v\u00e9lo')!==-1||qtext.indexOf('velo')!==-1)&&(qtext.indexOf('pi\u00e9ton')!==-1||qtext.indexOf('pi√©ton')!==-1||qtext.indexOf('pieton')!==-1)){
                s+='<ellipse cx="80" cy="88" rx="22" ry="3" fill="#1a202c" opacity="0.25"/>'+
                '<line x1="80" y1="54" x2="80" y2="78" stroke="#52525b" stroke-width="2"/>'+
                '<rect x="50" y="20" width="60" height="60" rx="4" fill="#1a202c" opacity="0.15"/>'+
                '<rect x="48" y="18" width="64" height="64" rx="4" fill="#2563eb"/>'+
                '<circle cx="68" cy="44" r="10" fill="#fff"/><path d="M68 54 L68 68 M64 68 L72 68" stroke="#fff" stroke-width="2"/>'+
                '<circle cx="66" cy="42" r="3" fill="#e0f2fe" opacity="0.6"/>'+
                '<circle cx="92" cy="52" r="8" fill="#fff"/><line x1="92" y1="60" x2="92" y2="68" stroke="#fff" stroke-width="1.5"/>'+
                '<circle cx="90" cy="50" r="2" fill="#e0f2fe" opacity="0.6"/>';
            }
            else if(qtext.indexOf('bleu')!==-1&&(qtext.indexOf('carr\u00e9')!==-1||qtext.indexOf('carre')!==-1)&&(qtext.indexOf('fl\u00e8che')!==-1||qtext.indexOf('fleche')!==-1||qtext.indexOf('indication')!==-1||qtext.indexOf('indique')!==-1)){
                s+='<rect x="50" y="20" width="60" height="60" rx="4" fill="#1a202c" opacity="0.12"/>'+
                '<rect x="48" y="18" width="64" height="64" rx="4" fill="#2563eb"/>'+
                '<path d="M80 28 L80 68 M80 48 L118 48 M80 48 L68 36 M80 48 L68 60" stroke="#fff" stroke-width="6" stroke-linecap="round"/>'+
                '<path d="M78 46 L82 50 L78 54" fill="none" stroke="#93c5fd" stroke-width="2" opacity="0.5"/>';
            }
            else if((qtext.indexOf('rond')!==-1||qtext.indexOf('circulaire')!==-1)&&qtext.indexOf('rouge')!==-1&&(qtext.indexOf('barre')!==-1||qtext.indexOf('interdiction')!==-1||qtext.indexOf('acc\u00e8s')!==-1||qtext.indexOf('sens interdit')!==-1)){
                s+='<ellipse cx="82" cy="90" rx="30" ry="5" fill="#0f172a" opacity="0.5"/>'+
                '<line x1="80" y1="52" x2="80" y2="80" stroke="url(#metalG)" stroke-width="2.8"/>'+
                '<line x1="79" y1="52" x2="79" y2="80" stroke="#a1a1aa" stroke-width="0.6" opacity="0.5"/>'+
                '<circle cx="82" cy="50" r="37" fill="#0f172a" opacity="0.4"/>'+
                '<circle cx="80" cy="48" r="36" fill="#991b1b" stroke="#7f1d1d" stroke-width="1"/>'+
                '<circle cx="80" cy="48" r="34" fill="#b91c1c"/>'+
                '<circle cx="80" cy="48" r="32" fill="#dc2626"/>'+
                '<circle cx="76" cy="44" r="4" fill="#fca5a5" opacity="0.5"/>'+
                '<rect x="40" y="44" width="80" height="12" fill="#fff"/>'+
                '<rect x="42" y="45" width="76" height="10" fill="#f8fafc"/>'+
                '<rect x="44" y="46" width="72" height="8" fill="#f1f5f9"/>';
            }
            else if((qtext.indexOf('rond')!==-1||qtext.indexOf('circulaire')!==-1)&&qtext.indexOf('bleu')!==-1&&qtext.indexOf('rouge')===-1&&qtext.indexOf('carr\u00e9')===-1&&qtext.indexOf('carre')===-1){
                s+='<circle cx="80" cy="48" r="38" fill="#2563eb" stroke="#1e40af" stroke-width="3"/>'+
                '<path d="M80 18 L80 78 M58 48 L102 48" stroke="#fff" stroke-width="8" stroke-linecap="round"/>'+L('Panneau rond bleu = obligation');
            }
            else if(((qtext.indexOf('triangulaire')!==-1||qtext.indexOf('triangle')!==-1)&&qtext.indexOf('rouge')!==-1&&qtext.indexOf('pointe en bas')===-1)||(qtext.indexOf('danger')!==-1&&(qtext.indexOf('panneau')!==-1||qtext.indexOf('signal')!==-1||qtext.indexOf('triangulaire')!==-1))||qtext.indexOf('avertissement')!==-1){
                s+='<ellipse cx="80" cy="86" rx="22" ry="4" fill="#0f172a" opacity="0.45"/>'+
                '<line x1="80" y1="52" x2="80" y2="78" stroke="url(#metalG)" stroke-width="2.5"/>'+
                '<line x1="79" y1="52" x2="79" y2="78" stroke="#a1a1aa" stroke-width="0.5" opacity="0.5"/>'+
                '<polygon points="83,15 121,85 39,85" fill="#0f172a" opacity="0.35"/>'+
                '<polygon points="81,13 119,83 41,83" fill="#7f1d1d" stroke="#991b1b" stroke-width="1"/>'+
                '<polygon points="80,14 118,82 42,82" fill="#fff" stroke="#dc2626" stroke-width="3.5"/>'+
                '<polygon points="80,22 108,74 52,74" fill="#f8fafc"/>'+
                '<polygon points="78,48 82,46 84,50 80,52" fill="#e2e8f0" opacity="0.6"/>';
            }
            else if(qtext.indexOf('fin de limitation')!==-1||(qtext.indexOf('noir')!==-1&&qtext.indexOf('blanc')!==-1&&qtext.indexOf('limitation')!==-1)){
                s+='<circle cx="80" cy="48" r="36" fill="#fff" stroke="#1f2937" stroke-width="3"/>'+
                '<line x1="42" y1="48" x2="118" y2="48" stroke="#1f2937" stroke-width="6"/>'+L('Fin de limitation');
            }
            else if(qtext.indexOf('ligne blanche continue')!==-1||qtext.indexOf('ligne continue')!==-1||(qtext.indexOf('franchir')!==-1&&qtext.indexOf('ligne')!==-1&&qtext.indexOf('d\u00e9passer')!==-1)){
                s+='<rect x="0" y="36" width="160" height="28" fill="url(#roadG)"/>'+
                '<path d="M0 38 L160 39 M0 41 L160 42 M0 44 L160 45 M0 47 L160 48 M0 54 L160 55 M0 57 L160 58 M0 61 L160 62" stroke="#2d3748" stroke-width="0.35" opacity="0.4"/>'+
                '<rect x="0" y="36" width="160" height="2" fill="#1f2937"/>'+
                '<rect x="0" y="62" width="160" height="2" fill="#1f2937"/>'+
                '<path d="M0 50 L160 50" stroke="#374151" stroke-width="6"/>'+
                '<path d="M0 50 L160 50" stroke="#fff" stroke-width="4.5"/>'+
                '<path d="M0 50 L160 50" stroke="#f8fafc" stroke-width="3"/>'+
                '<path d="M0 49 L80 49.5 L160 49" stroke="#e2e8f0" stroke-width="1" opacity="0.6"/>';
            }
            else if(qtext.indexOf('ligne')!==-1&&(qtext.indexOf('discontinue')!==-1||qtext.indexOf('pointill\u00e9')!==-1||qtext.indexOf('pointill√©')!==-1||qtext.indexOf('axiale')!==-1)){
                s+='<rect x="0" y="38" width="160" height="24" fill="url(#roadG)"/>'+
                '<rect x="0" y="38" width="160" height="1" fill="#374151"/>'+
                '<rect x="0" y="61" width="160" height="1" fill="#1f2937"/>'+
                '<path d="M0 50 L160 50" stroke="#fff" stroke-width="4" stroke-dasharray="14 10" stroke-linecap="round"/>'+
                '<path d="M0 50 L160 50" stroke="#f1f5f9" stroke-width="2.5" stroke-dasharray="14 10" stroke-linecap="round"/>';
            }
            else if(qtext.indexOf('ligne jaune')!==-1||(qtext.indexOf('jaune')!==-1&&qtext.indexOf('sol')!==-1&&qtext.indexOf('stationnement')!==-1)){
                s+='<rect x="0" y="36" width="160" height="28" fill="url(#roadG)"/>'+
                '<rect x="0" y="36" width="160" height="1" fill="#374151"/>'+
                '<rect x="0" y="63" width="160" height="1" fill="#1f2937"/>'+
                '<path d="M0 52 L160 52" stroke="#ca8a04" stroke-width="4"/>'+
                '<path d="M0 52 L160 52" stroke="#facc15" stroke-width="2.5"/>';
            }
            else if(qtext.indexOf('orange clignotant')!==-1||(qtext.indexOf('clignotant')!==-1&&qtext.indexOf('feu')!==-1&&qtext.indexOf('orange')!==-1)){
                s+='<ellipse cx="80" cy="84" rx="12" ry="3" fill="#0f172a" opacity="0.5"/>'+
                '<line x1="80" y1="52" x2="80" y2="80" stroke="url(#metalG)" stroke-width="3"/>'+
                '<line x1="79" y1="52" x2="79" y2="80" stroke="#a1a1aa" stroke-width="0.6" opacity="0.5"/>'+
                '<rect x="60" y="16" width="40" height="64" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1.5"/>'+
                '<rect x="63" y="20" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="29" r="7" fill="#374151"/><circle cx="80" cy="29" r="5" fill="#6b7280"/>'+
                '<circle cx="78" cy="27" r="1.5" fill="#9ca3af" opacity="0.8"/>'+
                '<rect x="63" y="39" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="48" r="7" fill="#374151"/><circle cx="80" cy="48" r="5" fill="#f59e0b"/>'+
                '<circle cx="80" cy="47" r="2" fill="#fbbf24"/>'+
                '<circle cx="78" cy="46" r="0.8" fill="#fef3c7"/>'+
                '<rect x="63" y="58" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="67" r="7" fill="#374151"/><circle cx="80" cy="67" r="5" fill="#6b7280"/>'+
                '<circle cx="78" cy="65" r="1.5" fill="#9ca3af" opacity="0.6"/>';
            }
            else if(qtext.indexOf('feu orange')!==-1||qtext.indexOf('feu')!==-1&&qtext.indexOf('orange')!==-1&&qtext.indexOf('arr\u00eater')!==-1){
                s+='<ellipse cx="80" cy="84" rx="12" ry="3" fill="#0f172a" opacity="0.5"/>'+
                '<line x1="80" y1="52" x2="80" y2="80" stroke="url(#metalG)" stroke-width="3"/>'+
                '<line x1="79" y1="52" x2="79" y2="80" stroke="#a1a1aa" stroke-width="0.6" opacity="0.5"/>'+
                '<rect x="60" y="16" width="40" height="64" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1.5"/>'+
                '<rect x="63" y="20" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="29" r="7" fill="#374151"/><circle cx="80" cy="29" r="5" fill="#6b7280"/>'+
                '<circle cx="78" cy="27" r="1.5" fill="#9ca3af" opacity="0.7"/>'+
                '<rect x="63" y="39" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="48" r="7" fill="#374151"/><circle cx="80" cy="48" r="5" fill="#f59e0b"/>'+
                '<circle cx="80" cy="47" r="2" fill="#fbbf24"/>'+
                '<circle cx="78" cy="46" r="0.8" fill="#fef3c7"/>'+
                '<rect x="63" y="58" width="34" height="17" rx="4" fill="#0f172a"/>'+
                '<circle cx="80" cy="67" r="7" fill="#374151"/><circle cx="80" cy="67" r="5" fill="#6b7280"/>'+
                '<circle cx="78" cy="65" r="1.5" fill="#9ca3af" opacity="0.6"/>';
            }
            else if(qtext.indexOf('losange')!==-1||(qtext.indexOf('prioritaire')!==-1&&qtext.indexOf('route')!==-1)){
                s+='<ellipse cx="80" cy="88" rx="26" ry="4" fill="#0f172a" opacity="0.5"/>'+
                '<line x1="80" y1="54" x2="80" y2="78" stroke="url(#metalG)" stroke-width="2.5"/>'+
                '<line x1="79" y1="54" x2="79" y2="78" stroke="#a1a1aa" stroke-width="0.6" opacity="0.5"/>'+
                '<rect x="55" y="29" width="52" height="52" fill="#0f172a" opacity="0.4" transform="rotate(45 81 55)"/>'+
                '<rect x="54" y="28" width="54" height="54" fill="#ca8a04" stroke="#a16207" stroke-width="1.5" transform="rotate(45 80 54)"/>'+
                '<rect x="56" y="30" width="50" height="50" fill="#fde047" stroke="#b45309" stroke-width="1.5" transform="rotate(45 80 54)"/>'+
                '<rect x="60" y="34" width="42" height="42" fill="#fef08a" transform="rotate(45 80 54)"/>'+
                '<polygon points="78,50 82,48 84,52 80,54" fill="#fef9c3" opacity="0.7" transform="rotate(45 81 52)"/>';
            }
            else if(qtext.indexOf('sens unique')!==-1||qtext.indexOf('contresens')!==-1){
                s+='<rect x="30" y="38" width="100" height="24" fill="#4a5568"/>'+
                '<path d="M80 42 L98 52 L80 62 L62 52 Z" fill="#fff"/><polygon points="84,52 94,52 89,58" fill="#1e293b"/>'+L('Sens unique ‚Äî contresens interdit');
            }
            else if(qtext.indexOf('giratoire')!==-1||qtext.indexOf('rond-point')!==-1){
                s+='<circle cx="80" cy="52" r="38" fill="url(#roadG)"/>'+
                '<circle cx="80" cy="52" r="38" fill="none" stroke="#374151" stroke-width="2"/>'+
                '<circle cx="80" cy="52" r="24" fill="#4a5568"/>'+
                '<circle cx="80" cy="52" r="24" fill="none" stroke="#1f2937" stroke-width="1"/>'+
                '<path d="M56 52 A24 24 0 0 1 80 28" stroke="#fff" stroke-width="2.5" fill="none" stroke-dasharray="8 5"/>'+
                '<path d="M80 28 A24 24 0 0 1 104 52" stroke="#9ca3af" stroke-width="1.5" fill="none"/>'+
                '<ellipse cx="80" cy="26" rx="8" ry="6" fill="#1a202c" opacity="0.2"/>'+
                '<polygon points="80,22 94,48 80,72 66,48" fill="#fef08a" stroke="#dc2626" stroke-width="2"/>'+
                '<polygon points="80,26 90,48 80,68 70,48" fill="#fef9c3"/>';
            }
            else if(qtext.indexOf('passage \u00e0 niveau')!==-1||qtext.indexOf('passage √† niveau')!==-1||qtext.indexOf('train')!==-1){
                s+='<rect x="20" y="40" width="120" height="22" fill="#374151"/>'+
                '<path d="M20 52 H140" stroke="#fbbf24" stroke-width="2" stroke-dasharray="6 4"/>'+
                '<rect x="58" y="26" width="44" height="32" rx="2" fill="#b91c1c"/>'+L('Passage √† niveau ‚Äî train');
            }
            else if(qtext.indexOf('tramway')!==-1){
                s+='<rect x="20" y="38" width="120" height="32" rx="2" fill="#475569" stroke="#1e293b"/>'+
                '<rect x="26" y="42" width="18" height="14" fill="#94a3b8"/><rect x="48" y="42" width="18" height="14" fill="#94a3b8"/>'+
                '<rect x="70" y="42" width="18" height="14" fill="#94a3b8"/><rect x="92" y="42" width="18" height="14" fill="#94a3b8"/>'+
                '<circle cx="38" cy="68" r="5" fill="#1e293b"/><circle cx="100" cy="68" r="5" fill="#1e293b"/>'+
                '<rect x="55" y="32" width="12" height="10" fill="#64748b"/>'+L('Tramway ‚Äî prioritaire');
            }
            else if(qtext.indexOf('bus')!==-1&&(qtext.indexOf('arr\u00eat')!==-1||qtext.indexOf('arr√™t')!==-1||qtext.indexOf('quitte')!==-1)){
                s+='<rect x="25" y="35" width="110" height="38" rx="3" fill="#d97706" stroke="#1a202c"/>'+
                '<rect x="32" y="40" width="16" height="14" fill="#fef3c7"/><rect x="52" y="40" width="16" height="14" fill="#fef3c7"/>'+
                '<rect x="72" y="40" width="16" height="14" fill="#fef3c7"/><rect x="105" y="42" width="10" height="22" fill="#78350f"/>'+
                '<circle cx="42" cy="70" r="5" fill="#1a202c"/><circle cx="118" cy="70" r="5" fill="#1a202c"/>'+
                '<circle cx="55" cy="38" r="3" fill="#fef08a"/><rect x="38" y="28" width="28" height="22" rx="2" fill="#2563eb"/>'+
                '<circle cx="46" cy="48" r="2" fill="#1a202c"/><circle cx="58" cy="48" r="2" fill="#1a202c"/>'+L('Bus qui quitte l\'arr√™t ‚Äî c√©der');
            }
            else if(qtext.indexOf('zone de rencontre')!==-1||qtext.indexOf('zone 20')!==-1){
                s+='<ellipse cx="80" cy="88" rx="26" ry="4" fill="#0f172a" opacity="0.5"/>'+
                '<line x1="80" y1="54" x2="80" y2="78" stroke="url(#metalG)" stroke-width="2.5"/>'+
                '<line x1="79" y1="54" x2="79" y2="78" stroke="#a1a1aa" stroke-width="0.5" opacity="0.5"/>'+
                '<rect x="50" y="23" width="60" height="46" rx="5" fill="#0f172a" opacity="0.35"/>'+
                '<rect x="48" y="21" width="64" height="50" rx="5" fill="#fff" stroke="#1e293b" stroke-width="2"/>'+
                '<rect x="50" y="23" width="60" height="46" rx="4" fill="#f8fafc"/>'+
                '<circle cx="80" cy="46" r="19" fill="#fff" stroke="#b91c1c" stroke-width="2.5"/>'+
                '<circle cx="80" cy="46" r="17" fill="#fff" stroke="#dc2626" stroke-width="1.5"/>'+
                '<circle cx="80" cy="46" r="15" fill="#f8fafc"/>'+
                '<circle cx="77" cy="43" r="4" fill="#e2e8f0" opacity="0.8"/>'+
                '<circle cx="82" cy="48" r="2" fill="#f1f5f9" opacity="0.5"/>';
            }
            else if(qtext.indexOf('distance')!==-1&&(qtext.indexOf('s\u00e9curit\u00e9')!==-1||qtext.indexOf('s√©curit√©')!==-1||qtext.indexOf('secondes')!==-1||qtext.indexOf('2 secondes')!==-1)){
                s+='<rect x="25" y="38" width="110" height="28" fill="#4a5568"/>'+
                '<path d="M25 52 H135" stroke="#fff" stroke-width="2" stroke-dasharray="8 6"/>'+
                '<rect x="35" y="44" width="28" height="18" rx="2" fill="#2563eb"/><rect x="97" y="44" width="28" height="18" rx="2" fill="#64748b"/>'+
                L('Distance de s√©curit√© : au moins 2 secondes');
            }
            else if(((qtext.indexOf('passage pi\u00e9ton')!==-1||qtext.indexOf('passage pi√©ton')!==-1||qtext.indexOf('5 m')!==-1||qtext.indexOf('5 m\u00e8tres')!==-1)&&t==='stationnement')){
                s+='<rect x="15" y="35" width="130" height="32" fill="url(#roadG)"/>'+
                '<rect x="12" y="35" width="136" height="2" fill="#374151"/><rect x="12" y="65" width="136" height="2" fill="#1f2937"/>'+
                '<rect x="48" y="38" width="64" height="26" fill="#fff" stroke="#1f2937" stroke-width="0.5"/>'+
                '<line x1="52" y1="38" x2="52" y2="64" stroke="#1f2937" stroke-width="2"/><line x1="62" y1="38" x2="62" y2="64" stroke="#1f2937" stroke-width="2"/>'+
                '<line x1="72" y1="38" x2="72" y2="64" stroke="#1f2937" stroke-width="2"/><line x1="82" y1="38" x2="82" y2="64" stroke="#1f2937" stroke-width="2"/>'+
                '<line x1="92" y1="38" x2="92" y2="64" stroke="#1f2937" stroke-width="2"/><line x1="102" y1="38" x2="102" y2="64" stroke="#1f2937" stroke-width="2"/>'+
                '<ellipse cx="80" cy="54" rx="4" ry="2" fill="#1a202c" opacity="0.2"/>'+
                '<circle cx="80" cy="52" r="5" fill="#1e293b"/><line x1="80" y1="57" x2="80" y2="64" stroke="#1e293b" stroke-width="1.5"/>'+
                '<rect x="28" y="42" width="28" height="18" rx="2" fill="#2563eb"/>'+
                '<rect x="32" y="46" width="10" height="6" rx="1" fill="#93c5fd" opacity="0.8"/>'+
                '<circle cx="36" cy="58" r="2" fill="#1e293b"/><circle cx="48" cy="58" r="2" fill="#1e293b"/>';
            }
            else if(qtext.indexOf('crit\'air')!==-1||qtext.indexOf('vignette')!==-1||qtext.indexOf('zfe')!==-1){
                s+='<rect x="50" y="25" width="60" height="55" rx="5" fill="#e2e8f0" stroke="#94a3b8"/>'+
                '<circle cx="80" cy="48" r="18" fill="#22c55e"/>'+
                '<circle cx="77" cy="45" r="4" fill="#4ade80" opacity="0.5"/>';
            }
            else if(qtext.indexOf('112')!==-1||(qtext.indexOf('18')!==-1&&qtext.indexOf('pompiers')!==-1)||qtext.indexOf('pompiers')!==-1||qtext.indexOf('15')!==-1||qtext.indexOf('samu')!==-1||(qtext.indexOf('num\u00e9ro')!==-1&&qtext.indexOf('urgence')!==-1)){
                s+='<rect x="55" y="28" width="50" height="50" rx="8" fill="#1e293b" stroke="#334155">'+
                '<animate attributeName="opacity" values="1;0.88;1" dur="1.5s" repeatCount="indefinite"/></rect>'+
                '<path d="M72 38 L88 38 L88 52 L82 58 L82 68 L78 68 L78 58 L72 52 Z" fill="#64748b"/>'+
                '<circle cx="80" cy="75" r="4" fill="#64748b"/>'+
                '<circle cx="80" cy="52" r="8" fill="#22c55e" opacity="0.4"/>';
            }
            else if(qtext.indexOf('p-a-s')!==-1||(qtext.indexOf('prot\u00e9ger')!==-1&&qtext.indexOf('alerter')!==-1)||(qtext.indexOf('pas')!==-1&&qtext.indexOf('signifie')!==-1&&(qtext.indexOf('accident')!==-1||qtext.indexOf('geste')!==-1))){
                s+='<rect x="40" y="24" width="80" height="52" rx="4" fill="#fef3c7" stroke="#f59e0b"/>'+
                '<rect x="48" y="32" width="64" height="8" rx="1" fill="#fde68a"/>'+
                '<rect x="48" y="44" width="64" height="8" rx="1" fill="#fde68a"/>'+
                '<rect x="48" y="56" width="64" height="8" rx="1" fill="#fde68a"/>';
            }
            else if(qtext.indexOf('pneus')!==-1||qtext.indexOf('rainures')!==-1||qtext.indexOf('1,6')!==-1||qtext.indexOf('sculptures')!==-1){
                s+='<circle cx="55" cy="55" r="28" fill="#374151" stroke="#4b5563"/>'+
                '<circle cx="55" cy="55" r="20" fill="#6b7280"/>'+
                '<path d="M35 55 Q55 35 75 55 Q55 75 35 55" stroke="#9ca3af" stroke-width="3" fill="none"/>'+
                '<path d="M42 55 Q55 42 68 55 Q55 68 42 55" stroke="#78716c" stroke-width="1.5" fill="none"/>';
            }
            else if(qtext.indexOf('abs')!==-1||qtext.indexOf('blocage')!==-1&&qtext.indexOf('roues')!==-1){
                s+='<rect x="22" y="32" width="116" height="48" rx="4" fill="#374151" stroke="#4b5563"/>'+
                '<circle cx="48" cy="78" r="14" fill="#1f2937"/><circle cx="48" cy="78" r="7" fill="#6b7280"/>'+
                '<circle cx="112" cy="78" r="14" fill="#1f2937"/><circle cx="112" cy="78" r="7" fill="#6b7280"/>'+
                '<rect x="38" y="42" width="84" height="22" rx="2" fill="#4b5563"/>'+
                '<rect x="44" y="46" width="24" height="12" fill="#6b7280"/><rect x="74" y="46" width="24" height="12" fill="#6b7280"/>'+
                '<rect x="64" y="50" width="32" height="4" rx="1" fill="#9ca3af"/>';
            }
            else if(qtext.indexOf('trottoir')!==-1&&t==='stationnement'){
                s+='<rect x="12" y="28" width="136" height="28" fill="#9ca3af"/><rect x="12" y="56" width="136" height="20" fill="#4a5568"/>'+
                '<path d="M12 42 H148" stroke="#6b7280" stroke-width="1"/>'+
                '<rect x="35" y="48" width="38" height="24" rx="2" fill="#2563eb"/><rect x="39" y="52" width="12" height="10" fill="#93c5fd"/>'+
                '<circle cx="44" cy="68" r="3" fill="#1a202c"/><circle cx="66" cy="68" r="3" fill="#1a202c"/>'+
                '<line x1="80" y1="56" x2="80" y2="76" stroke="#facc15" stroke-width="2"/>'+
                L('Trottoir ‚Äî 1,50 m pour pi√©tons si autoris√©');
            }
            else if(qtext.indexOf('arr\u00eat')!==-1&&(qtext.indexOf('signifie')!==-1||qtext.indexOf('d\u00e9finit')!==-1||qtext.indexOf('commandes')!==-1)&&t==='stationnement'){
                s+='<rect x="42" y="22" width="76" height="58" rx="4" fill="#1e293b" stroke="#334155"/>'+
                '<circle cx="80" cy="42" r="16" fill="#fbbf24"/><rect x="66" y="54" width="28" height="16" rx="2" fill="#334155"/>'+
                '<line x1="72" y1="50" x2="88" y2="50" stroke="#64748b" stroke-width="2"/>'+
                L('Arr√™t = conducteur aux commandes');
            }
            else if(qtext.indexOf('t\u00e9l\u00e9phone')!==-1||qtext.indexOf('telephone')!==-1||qtext.indexOf('oreillette')!==-1||qtext.indexOf('135')!==-1){
                s+='<rect x="42" y="20" width="76" height="62" rx="4" fill="#1e293b"/>'+
                '<circle cx="80" cy="38" r="14" fill="#fbbf24"/><rect x="66" y="50" width="28" height="18" rx="2" fill="#334155"/>'+
                '<rect x="72" y="54" width="16" height="22" rx="2" fill="#374151"/>'+
                '<circle cx="80" cy="62" r="4" fill="#22c55e"/><path d="M74 44 L86 44 L86 52 L80 56 L80 68 L76 68 L76 56 L74 52 Z" fill="#64748b"/>'+
                L('T√©l√©phone au volant interdit');
            }
            else if(qtext.indexOf('alcool')!==-1||qtext.indexOf('alcool\u00e9mie')!==-1||qtext.indexOf('0,2')!==-1||qtext.indexOf('caf\u00e9')!==-1){
                s+='<rect x="50" y="28" width="60" height="50" rx="4" fill="#fef3c7" stroke="#f59e0b"/>'+
                '<ellipse cx="80" cy="48" rx="12" ry="18" fill="#fde68a" stroke="#f59e0b"/>'+
                '<ellipse cx="78" cy="44" rx="4" ry="6" fill="#fef08a" opacity="0.5"/>';
            }
            else if(qtext.indexOf('fatigue')!==-1||qtext.indexOf('b\u00e2illements')!==-1||qtext.indexOf('b√¢illements')!==-1){
                s+='<rect x="40" y="18" width="80" height="62" rx="4" fill="#1e293b"/>'+
                '<circle cx="80" cy="38" r="15" fill="#fbbf24"/><path d="M72 52 Q80 48 88 52" stroke="#64748b" stroke-width="3" fill="none"/>'+
                '<ellipse cx="80" cy="58" rx="12" ry="4" fill="#64748b"/>'+
                L('Fatigue ‚Äî faire une PAUSE');
            }
            else if(qtext.indexOf('points')!==-1&&(qtext.indexOf('permis')!==-1||qtext.indexOf('probatoire')!==-1||qtext.indexOf('stage')!==-1)){
                s+='<rect x="45" y="25" width="70" height="55" rx="5" fill="#fff" stroke="#94a3b8"/>'+
                '<circle cx="80" cy="48" r="16" fill="#2563eb"/>'+
                '<circle cx="77" cy="45" r="4" fill="#60a5fa" opacity="0.6"/>';
            }
            else if(qtext.indexOf('assurance')!==-1||qtext.indexOf('responsabilit\u00e9 civile')!==-1||qtext.indexOf('rc')!==-1){
                s+='<rect x="38" y="22" width="84" height="58" rx="4" fill="#f8fafc" stroke="#cbd5e1"/>'+
                '<rect x="44" y="28" width="72" height="8" fill="#e2e8f0"/><rect x="44" y="40" width="72" height="8" fill="#e2e8f0"/>'+
                '<rect x="44" y="52" width="72" height="8" fill="#e2e8f0"/>';
            }
            else if(qtext.indexOf('document')!==-1||qtext.indexOf('permis')!==-1&&qtext.indexOf('carte grise')!==-1||qtext.indexOf('circulation')!==-1){
                s+='<rect x="35" y="25" width="90" height="55" rx="4" fill="#f8fafc" stroke="#cbd5e1"/>'+
                '<rect x="42" y="32" width="28" height="36" rx="2" fill="#1e40af"/><rect x="48" y="38" width="16" height="4" rx="1" fill="#3b82f6"/>'+
                '<rect x="76" y="32" width="28" height="36" rx="2" fill="#e2e8f0"/><rect x="82" y="38" width="16" height="4" rx="1" fill="#cbd5e1"/>'+
                '<rect x="110" y="32" width="28" height="36" rx="2" fill="#e2e8f0"/><rect x="116" y="38" width="16" height="4" rx="1" fill="#cbd5e1"/>';
            }
            else if(qtext.indexOf('car scolaire')!==-1||qtext.indexOf('autocar scolaire')!==-1||qtext.indexOf('feux clignotants')!==-1&&qtext.indexOf('enfant')!==-1){
                s+='<rect x="18" y="32" width="124" height="40" rx="3" fill="#f59e0b" stroke="#1a202c"/>'+
                '<rect x="24" y="36" width="18" height="14" fill="#fef3c7"/><rect x="46" y="36" width="18" height="14" fill="#fef3c7"/>'+
                '<rect x="68" y="36" width="18" height="14" fill="#fef3c7"/><rect x="90" y="36" width="18" height="14" fill="#fef3c7"/>'+
                '<circle cx="50" cy="68" r="4" fill="#ef4444"/><circle cx="50" cy="68" r="2" fill="#fca5a5"/>'+
                '<circle cx="110" cy="68" r="4" fill="#ef4444"/><circle cx="110" cy="68" r="2" fill="#fca5a5"/>'+
                '<rect x="38" y="26" width="32" height="22" rx="2" fill="#2563eb"/><circle cx="46" cy="46" r="2" fill="#1a202c"/><circle cx="58" cy="46" r="2" fill="#1a202c"/>'+
                L('Car scolaire ‚Äî STOP, ne pas d√©passer');
            }
            else if(qtext.indexOf('trottinette')!==-1||qtext.indexOf('edpm')!==-1||qtext.indexOf('25 km')!==-1){
                s+='<rect x="15" y="42" width="130" height="28" fill="#4a5568"/>'+
                '<rect x="25" y="48" width="50" height="18" rx="2" fill="#64748b"/>'+
                '<circle cx="38" cy="64" r="5" fill="#1e293b"/><circle cx="62" cy="64" r="5" fill="#1e293b"/>'+
                '<circle cx="55" cy="54" r="4" fill="#1e293b"/><line x1="55" y1="58" x2="55" y2="62" stroke="#1e293b"/>'+
                L('Trottinette √©lectrique ‚Äî 25 km/h max');
            }
            else if(qtext.indexOf('\u00e9co-conduite')!==-1||qtext.indexOf('eco-conduite')!==-1||qtext.indexOf('carburant')!==-1){
                s+='<rect x="28" y="38" width="104" height="38" rx="3" fill="#374151"/>'+
                '<rect x="34" y="42" width="24" height="16" fill="#93c5fd"/><rect x="62" y="42" width="36" height="16" fill="#4b5563"/>'+
                '<rect x="102" y="42" width="24" height="16" fill="#e2e8f0"/>'+
                '<circle cx="44" cy="62" r="5" fill="#1a202c"/><circle cx="88" cy="62" r="5" fill="#1a202c"/>'+
                '<path d="M95 32 Q105 28 112 38" stroke="#22c55e" stroke-width="3" fill="none"/>'+
                '<circle cx="108" cy="32" r="5" fill="#22c55e" opacity="0.5"/>';
            }
            else if(qtext.indexOf('contr\u00f4le technique')!==-1||qtext.indexOf('controle technique')!==-1||qtext.indexOf('p\u00e9riodicit\u00e9')!==-1){
                s+='<rect x="30" y="28" width="100" height="50" rx="4" fill="#475569" stroke="#64748b"/>'+
                '<rect x="40" y="38" width="80" height="28" rx="2" fill="#64748b"/>'+
                '<circle cx="55" cy="72" r="6" fill="#1e293b"/><circle cx="105" cy="72" r="6" fill="#1e293b"/>'+
                '<rect x="62" y="44" width="36" height="16" rx="2" fill="#94a3b8"/>';
            }
            else if(qtext.indexOf('huile')!==-1||qtext.indexOf('niveau')!==-1&&qtext.indexOf('moteur')!==-1){
                s+='<rect x="55" y="30" width="50" height="45" rx="3" fill="#fef3c7" stroke="#f59e0b"/>'+
                '<rect x="62" y="38" width="36" height="28" fill="#78350f"/>'+
                '<line x1="72" y1="42" x2="88" y2="42" stroke="#fef08a" stroke-width="2"/>'+
                '<rect x="68" y="48" width="24" height="3" rx="1" fill="#92400e" opacity="0.5"/>';
            }
            else if(qtext.indexOf('brouillard')!==-1){
                s+='<rect x="25" y="35" width="110" height="38" rx="3" fill="#374151"/>'+
                '<rect x="32" y="40" width="16" height="14" fill="#93c5fd"/><rect x="52" y="40" width="16" height="14" fill="#e2e8f0"/>'+
                '<rect x="72" y="40" width="16" height="14" fill="#fef08a"/><rect x="92" y="40" width="16" height="14" fill="#fef08a"/>'+
                '<circle cx="48" cy="68" r="4" fill="#1a202c"/><circle cx="112" cy="68" r="4" fill="#1a202c"/>'+
                L('Feux de brouillard avant et arri√®re');
            }
            else if(qtext.indexOf('bouche')!==-1&&qtext.indexOf('incendie')!==-1){
                s+='<rect x="15" y="38" width="130" height="28" fill="#4a5568"/>'+
                '<rect x="58" y="28" width="44" height="48" rx="2" fill="#dc2626" stroke="#b91c1c"/>'+
                '<circle cx="80" cy="38" r="6" fill="#fff"/><circle cx="80" cy="50" r="6" fill="#fff"/><circle cx="80" cy="62" r="6" fill="#fff"/>'+
                '<rect x="68" y="22" width="24" height="12" fill="#64748b"/>'+
                '<rect x="35" y="48" width="30" height="18" rx="2" fill="#2563eb"/><circle cx="42" cy="62" r="2" fill="#1a202c"/>'+
                L('Bouche d\'incendie ‚Äî 5 m interdit');
            }
            else if(qtext.indexOf('angle mort')!==-1||qtext.indexOf('angle-mort')!==-1){
                s+='<rect x="25" y="35" width="110" height="38" rx="3" fill="#374151"/>'+
                '<rect x="40" y="42" width="50" height="24" rx="2" fill="#2563eb"/><polygon points="48,48 70,48 70,58 48,58" fill="#1e3a5f"/>'+
                '<circle cx="55" cy="62" r="3" fill="#1a202c"/><circle cx="75" cy="62" r="3" fill="#1a202c"/>'+
                '<path d="M95 55 L115 45 M95 58 L118 48" stroke="#22c55e" stroke-width="2"/>'+
                '<circle cx="118" cy="48" r="6" fill="#22c55e"/><circle cx="118" cy="48" r="3" fill="#166534"/>'+
                L('V√©rifier l\'angle mort');
            }
            else if((qtext.indexOf('bande')!==-1&&qtext.indexOf('arr\u00eat')!==-1)||qtext.indexOf('BAU')!==-1){
                s+='<rect x="10" y="30" width="160" height="44" fill="#4a5568"/>'+
                '<rect x="10" y="30" width="120" height="44" fill="#374151"/><rect x="130" y="30" width="40" height="44" fill="#6b7280"/>'+
                '<rect x="10" y="30" width="120" height="2" fill="#fff"/><rect x="10" y="72" width="120" height="2" fill="#fff"/>'+
                '<rect x="45" y="42" width="50" height="22" rx="2" fill="#2563eb"/><circle cx="55" cy="60" r="2" fill="#1a202c"/><circle cx="85" cy="60" r="2" fill="#1a202c"/>'+
                '<rect x="138" y="48" width="24" height="14" rx="2" fill="#6b7280"/>';
            }
            else if(qtext.indexOf('clignotant')!==-1||qtext.indexOf('clignotants')!==-1){
                s+='<rect x="25" y="35" width="110" height="38" rx="3" fill="#374151"/>'+
                '<rect x="35" y="42" width="70" height="24" rx="2" fill="#2563eb"/><polygon points="42,48 98,48 98,54 42,54" fill="#1e3a5f"/>'+
                '<circle cx="50" cy="62" r="3" fill="#1a202c"/><circle cx="90" cy="62" r="3" fill="#1a202c"/>'+
                '<rect x="108" y="48" width="8" height="6" rx="1" fill="#facc15">'+
                '<animate attributeName="opacity" values="1;0.2;1" dur="0.6s" repeatCount="indefinite"/></rect>'+L('Clignotant obligatoire');
            }
            else if(t==='vitesse'||qtext.indexOf('vitesse')!==-1||qtext.indexOf('50')!==-1||qtext.indexOf('80')!==-1||qtext.indexOf('30')!==-1||qtext.indexOf('km/h')!==-1||qtext.indexOf('70')!==-1){
                s+='<ellipse cx="80" cy="88" rx="24" ry="3" fill="#1a202c" opacity="0.3"/>'+
                '<line x1="80" y1="54" x2="80" y2="78" stroke="#52525b" stroke-width="2"/>'+
                '<circle cx="82" cy="48" r="30" fill="#1a202c" opacity="0.2"/>'+
                '<circle cx="80" cy="46" r="32" fill="#fff" stroke="#dc2626" stroke-width="4"/>'+
                '<circle cx="80" cy="46" r="26" fill="#f8fafc"/>'+
                '<circle cx="76" cy="42" r="5" fill="#e2e8f0" opacity="0.7"/>';
            }
            else if(t==='priorites'){
                s+='<polygon points="80,22 98,48 80,74 62,48" fill="#fef9c3" stroke="#dc2626" stroke-width="2"/>'+L('Priorit√©s');
            }
            else if(t==='conducteur'){
                s+='<rect x="50" y="28" width="60" height="48" rx="6" fill="#1e293b"/>'+
                '<circle cx="80" cy="48" r="16" fill="#fbbf24"/><rect x="70" y="58" width="20" height="12" rx="2" fill="#334155"/>'+L('Conducteur');
            }
            else if(t==='usagers'){
                s+='<circle cx="50" cy="48" r="14" fill="#1e293b"/><line x1="50" y1="62" x2="50" y2="72" stroke="#1e293b" stroke-width="2"/>'+
                '<line x1="42" y1="72" x2="58" y2="72" stroke="#1e293b" stroke-width="2"/>'+
                '<rect x="85" y="38" width="50" height="24" rx="2" fill="#2563eb"/>'+L('Usagers ‚Äî pi√©tons, cyclistes');
            }
            else if(t==='stationnement'){
                s+='<rect x="35" y="35" width="90" height="30" fill="#4a5568" rx="2"/>'+
                '<path d="M35 52 H125" stroke="#facc15" stroke-width="3"/>'+L('Stationnement');
            }
            else if(t==='environnement'){
                s+='<rect x="50" y="28" width="60" height="50" rx="5" fill="#e2e8f0"/>'+
                '<circle cx="80" cy="48" r="18" fill="#22c55e"/>'+
                '<circle cx="77" cy="45" r="5" fill="#4ade80" opacity="0.5"/>';
            }
            else if(t==='mecanique'){
                s+='<circle cx="80" cy="48" r="30" fill="#374151"/><circle cx="80" cy="48" r="20" fill="#6b7280"/>'+
                '<path d="M60 48 Q80 32 100 48 Q80 64 60 48" stroke="#9ca3af" stroke-width="2" fill="none"/>';
            }
            else if(t==='secours'){
                s+='<rect x="50" y="28" width="60" height="50" rx="8" fill="#1e293b"/>'+
                '<circle cx="80" cy="52" r="12" fill="#22c55e" opacity="0.5"/>'+
                '<path d="M74 44 L86 44 L86 52 L80 58 L80 66 L76 66 L76 58 L74 52 Z" fill="#64748b"/>';
            }
            else if(t==='reglementation'){
                s+='<rect x="42" y="28" width="76" height="48" rx="4" fill="#f8fafc" stroke="#cbd5e1"/>'+
                '<rect x="50" y="36" width="60" height="6" rx="1" fill="#e2e8f0"/>'+
                '<rect x="50" y="46" width="60" height="6" rx="1" fill="#e2e8f0"/>';
            }
            else if(t==='signalisation'){
                s+='<polygon points="80,18 118,78 42,78" fill="#fff" stroke="#dc2626" stroke-width="3"/>'+
                '<polygon points="80,28 106,72 54,72" fill="#f8fafc"/>';
            }
            else{
                s+='<rect x="45" y="32" width="70" height="42" rx="6" fill="#f1f5f9" stroke="#cbd5e1"/>'+
                '<rect x="52" y="42" width="56" height="6" rx="2" fill="#e2e8f0"/>'+
                '<rect x="52" y="54" width="56" height="6" rx="2" fill="#e2e8f0"/>';
            }
            return s+'</svg>';
        }
        const questionIllustrations = new Array(150);
        const questionIllustrationsSvg = new Array(150);
        for(var i=0;i<150;i++){
            var raw = sceneExam(i);
            questionIllustrationsSvg[i] = raw;
            questionIllustrations[i] = svgExam(raw);
        }
        
                // M√©lange al√©atoire (Fisher-Yates) ‚Äî utilise crypto si dispo pour un tirage vraiment al√©atoire
        function secureRandomInt(max) {
            if (typeof crypto !== 'undefined' && crypto.getRandomValues) {
                const buf = new Uint32Array(1);
                crypto.getRandomValues(buf);
                return (buf[0] % (max + 1));
            }
            return Math.floor(Math.random() * (max + 1));
        }
        function shuffleArray(arr) {
            const a = [...arr];
            for (let i = a.length - 1; i > 0; i--) {
                const j = secureRandomInt(i);
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }
        
        // =============================================
        // VARIABLES GLOBALES
        // =============================================
        let currentCourse = null;
        let examQuestions = [];
        let currentQuestionIndex = 0;
        let examStartTime = null;
        let examTimer = null;
        let userAnswers = [];
        let isQuizByTheme = false;
        let isErreursQuiz = false;
        let courseProgress = {};
        let examHistory = [];
        
        // NOUVELLES VARIABLES LUDIQUES
        let soundEnabled = true;
        
        // Variables des mini-jeux
        let speedQuizTimerId = null;
        let speedQuizQuestions = [];
        let speedQuizIndex = 0;
        let speedQuizScore = 0;
        let speedQuizTimeLeft = 120;
        let speedQuizAnswers = [];
        let prioriteQuestions = [];
        let prioriteIndex = 0;
        let prioriteScore = 0;
        let chiffresQuestions = [];
        let chiffresIndex = 0;
        let chiffresScore = 0;
        
        // =============================================
        // FONCTIONS
        // =============================================
        
        // Th√®me clair / sombre
        function getTheme() {
            return document.documentElement.getAttribute('data-theme') || 'light';
        }
        function setTheme(theme) {
            theme = theme === 'dark' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('codeRouteProTheme', theme);
            var m = document.querySelector('meta[name="theme-color"]');
            if (m) m.setAttribute('content', theme === 'dark' ? '#25252a' : '#FF6B35');
            updateThemeButton();
        }
        function toggleTheme() {
            setTheme(getTheme() === 'dark' ? 'light' : 'dark');
        }
        function updateThemeButton() {
            var btn = document.getElementById('themeToggle');
            var icon = document.getElementById('themeIcon');
            var label = document.getElementById('themeLabel');
            if (!btn || !icon || !label) return;
            if (getTheme() === 'dark') {
                icon.textContent = '‚òÄÔ∏è';
                label.textContent = 'Mode clair';
            } else {
                icon.textContent = 'üåô';
                label.textContent = 'Mode sombre';
            }
        }
        
        // Impression
        function printMemo() {
            document.body.classList.add('print-memo');
            window.print();
            var done = function () { document.body.classList.remove('print-memo', 'print-course'); };
            window.addEventListener('afterprint', done, { once: true });
            setTimeout(done, 1000);
        }
        function printCourse() {
            document.body.classList.add('print-course');
            window.print();
            var done = function () { document.body.classList.remove('print-memo', 'print-course'); };
            window.addEventListener('afterprint', done, { once: true });
            setTimeout(done, 1000);
        }
        
        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            
            const targetTab = document.getElementById(tabName);
            if (targetTab) targetTab.classList.add('active');
            
            // Activer le bon bouton
            const tabMap = { home: 'Accueil', courses: 'Cours', exam: 'Examen', games: 'Jeux', quiz: 'Quiz', erreurs: 'Erreurs', flashcards: 'Flashcards', memo: 'M√©mo', candidatlibre: 'Candidat libre', stats: 'Stats' };
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.textContent.includes(tabMap[tabName])) btn.classList.add('active');
            });
            
            // Charger contenu
            if (tabName === 'home') updateHomePrediction();
            else if (tabName === 'courses') displayCourseList();
            else if (tabName === 'quiz') displayQuizThemes();
            else if (tabName === 'erreurs') displayErreursTab();
            else if (tabName === 'flashcards') displayFlashcardsThemes();
            else if (tabName === 'stats') displayStats();
            else if (tabName === 'exam') resetExam();
            else if (tabName === 'games') backToGames();
            
            window.scrollTo(0, 0);
        }
        
        // ========================================
        // MINI-JEUX
        // ========================================
        function backToGames() {
            document.getElementById('gamesMenu').style.display = 'block';
            document.getElementById('prioriteGame').style.display = 'none';
            document.getElementById('speedQuizGame').style.display = 'none';
            document.getElementById('chiffresGame').style.display = 'none';
            if (speedQuizTimerId) clearInterval(speedQuizTimerId);
            window.scrollTo(0, 0);
        }
        
        // Helper : image SVG unique par situation (data URI) ‚Äî style explicite avec libell√©s
        function svgPriorite(svg) { return 'data:image/svg+xml,' + encodeURIComponent(svg); }
        function scenePriorite(idx) {
            var vb='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 280 140">'+
                '<defs><linearGradient id="skyGP" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#475569"/><stop offset="0.5" stop-color="#94a3b8"/><stop offset="1" stop-color="#e2e8f0"/></linearGradient>'+
                '<linearGradient id="roadGP" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#2d3748"/><stop offset="0.2" stop-color="#374151"/><stop offset="0.5" stop-color="#4b5563"/><stop offset="0.8" stop-color="#374151"/><stop offset="1" stop-color="#1f2937"/></linearGradient>'+
                '<linearGradient id="grassGP" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#4d7c23"/><stop offset="0.5" stop-color="#42631e"/><stop offset="1" stop-color="#365318"/></linearGradient>'+
                '<linearGradient id="metalGP" x1="0" y1="0" x2="1" y2="0"><stop offset="0" stop-color="#3f3f46"/><stop offset="0.5" stop-color="#a1a1aa"/><stop offset="1" stop-color="#3f3f46"/></linearGradient>'+
                '<linearGradient id="glassGP" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#e0f2fe"/><stop offset="0.5" stop-color="#f0f9ff"/><stop offset="1" stop-color="#bae6fd"/></linearGradient>'+
                '<radialGradient id="vignetteGP" cx="0.5" cy="0.5" r="0.8"><stop offset="0" stop-color="#000" stop-opacity="0"/><stop offset="0.8" stop-color="#000" stop-opacity="0"/><stop offset="1" stop-color="#000" stop-opacity="0.35"/></radialGradient></defs>'+
                '<rect fill="url(#skyGP)" width="280" height="140"/>';
            var grass='<rect x="0" y="0" width="280" height="54" fill="url(#grassGP)"/>'+
                '<rect x="0" y="86" width="280" height="54" fill="url(#grassGP)"/>'+
                '<path d="M0 52 Q70 50 140 52 Q210 50 280 52" fill="#3d6220" opacity="0.4"/>'+
                '<path d="M0 88 Q140 86 280 88" fill="#2d4a14" opacity="0.35"/>'+
                '<ellipse cx="40" cy="28" rx="18" ry="10" fill="#3d6220" opacity="0.5"/><ellipse cx="240" cy="112" rx="20" ry="12" fill="#365318" opacity="0.5"/>'+
                '<path d="M0 54 L280 54" stroke="#1f2937" stroke-width="2"/><path d="M0 86 L280 86" stroke="#1f2937" stroke-width="2"/>';
            var road='<rect x="0" y="54" width="280" height="34" fill="url(#roadGP)"/>'+
                '<path d="M0 55 L280 55 M0 58 L280 58 M0 61 L280 61 M0 64 L280 64 M0 67 L280 67 M0 73 L280 73 M0 76 L280 76 M0 79 L280 79 M0 83 L280 83" stroke="#334155" stroke-width="0.3" opacity="0.45"/>'+
                '<rect x="0" y="54" width="280" height="3" fill="#fff"/><rect x="0" y="85" width="280" height="3" fill="#fff"/>'+
                '<path d="M0 70 L280 70" stroke="#374151" stroke-width="4"/>'+
                '<path d="M0 70 L280 70" stroke="#fff" stroke-width="2.8"/>'+
                '<path d="M0 70 L280 70" stroke="#f8fafc" stroke-width="1.8"/>'+
                '<path d="M0 58 L280 58" stroke="#6b7280" stroke-width="0.6" opacity="0.5"/><path d="M0 82 L280 82" stroke="#6b7280" stroke-width="0.6" opacity="0.5"/>';
            var car=function(x,y,col){ return '<ellipse cx="'+(x+22)+'" cy="'+(y+19)+'" rx="24" ry="6" fill="#0f172a" opacity="0.5"/>'+
                '<rect x="'+(x+1)+'" y="'+(y+1)+'" width="42" height="16" rx="2" fill="#1a202c" opacity="0.12"/>'+
                '<rect x="'+x+'" y="'+y+'" width="44" height="18" rx="3" fill="'+col+'" stroke="#1e293b" stroke-width="1"/>'+
                '<line x1="'+(x+22)+'" y1="'+(y+2)+'" x2="'+(x+22)+'" y2="'+(y+16)+'" stroke="#334155" stroke-width="0.8" opacity="0.6"/>'+
                '<rect x="'+(x+3)+'" y="'+(y+3)+'" width="15" height="9" rx="1" fill="#93c5fd" opacity="0.9"/>'+
                '<rect x="'+(x+5)+'" y="'+(y+5)+'" width="9" height="5" fill="#bfdbfe"/>'+
                '<path d="M'+(x+6)+' '+(y+4)+' L'+(x+9)+' '+(y+7)+' L'+(x+6)+' '+(y+10)+' Z" fill="#fff" opacity="0.4"/>'+
                '<rect x="'+(x+26)+'" y="'+(y+3)+'" width="15" height="9" rx="1" fill="#e2e8f0"/>'+
                '<rect x="'+(x+28)+'" y="'+(y+5)+'" width="9" height="5" fill="#f8fafc"/>'+
                '<path d="M'+(x+28)+' '+(y+4)+' L'+(x+31)+' '+(y+7)+' L'+(x+28)+' '+(y+10)+' Z" fill="#fff" opacity="0.5"/>'+
                '<circle cx="'+(x+8)+'" cy="'+(y+15)+'" r="4" fill="#1e293b"/><circle cx="'+(x+8)+'" cy="'+(y+15)+'" r="2.5" fill="#374151"/><circle cx="'+(x+8)+'" cy="'+(y+15)+'" r="1" fill="#64748b"/>'+
                '<circle cx="'+(x+36)+'" cy="'+(y+15)+'" r="4" fill="#1e293b"/><circle cx="'+(x+36)+'" cy="'+(y+15)+'" r="2.5" fill="#374151"/><circle cx="'+(x+36)+'" cy="'+(y+15)+'" r="1" fill="#64748b"/>'+
                '<path d="M'+(x+10)+' '+(y+6)+' L'+(x+12)+' '+(y+8)+' L'+(x+10)+' '+(y+10)+' Z" fill="#1e293b" opacity="0.2"/>'+
                '<rect x="'+x+'" y="'+(y+1)+'" width="2" height="4" rx="0.6" fill="#fef08a"/><rect x="'+(x+1.2)+'" y="'+(y+1)+'" width="2" height="4" rx="0.6" fill="#fde047"/>'+
                '<rect x="'+(x+41.5)+'" y="'+(y+1)+'" width="2.5" height="5" rx="0.8" fill="#fca5a5"/><rect x="'+(x+43.5)+'" y="'+(y+1)+'" width="2.5" height="5" rx="0.8" fill="#fca5a5"/>'+
                '<rect x="'+(x+42)+'" y="'+(y+6)+'" width="2" height="3" rx="0.5" fill="#94a3b8"/>'; };
            var stopPanneau='<ellipse cx="144" cy="99" rx="8" ry="3" fill="#0f172a" opacity="0.45"/>'+
                '<line x1="142" y1="66" x2="142" y2="97" stroke="url(#metalGP)" stroke-width="3.5"/>'+
                '<line x1="141" y1="66" x2="141" y2="97" stroke="#a1a1aa" stroke-width="0.6" opacity="0.5"/>'+
                '<line x1="142" y1="97" x2="148" y2="100" stroke="#3f3f46" stroke-width="2.5"/>'+
                '<polygon points="143,47 157,58 143,69 129,58" fill="#0f172a" opacity="0.35"/>'+
                '<polygon points="142,48 156,58 142,68 128,58" fill="#b91c1c" stroke="#fff" stroke-width="2.2"/>'+
                '<polygon points="142,50 154,58 142,66 130,58" fill="#dc2626"/>'+
                '<polygon points="140,54 142,52 144,54 142,56" fill="#fca5a5" opacity="0.6"/>';
            var cedezPanneau='<ellipse cx="97" cy="91" rx="7" ry="2.5" fill="#0f172a" opacity="0.4"/>'+
                '<line x1="95" y1="56" x2="95" y2="89" stroke="url(#metalGP)" stroke-width="3"/>'+
                '<line x1="94" y1="56" x2="94" y2="89" stroke="#a1a1aa" stroke-width="0.5" opacity="0.5"/>'+
                '<polygon points="96,49 104,67 88,67" fill="#0f172a" opacity="0.3"/>'+
                '<polygon points="95,50 103,66 87,66" fill="#fef08a" stroke="#dc2626" stroke-width="2.2"/>'+
                '<polygon points="95,56 100,64 90,64" fill="#fef9c3"/>';
            var losangePanneau='<ellipse cx="148" cy="78" rx="6" ry="2" fill="#0f172a" opacity="0.35"/>'+
                '<line x1="148" y1="54" x2="148" y2="76" stroke="url(#metalGP)" stroke-width="2.5"/>'+
                '<line x1="147" y1="54" x2="147" y2="76" stroke="#a1a1aa" stroke-width="0.5" opacity="0.5"/>'+
                '<rect x="138" y="39" width="20" height="20" fill="#ca8a04" stroke="#a16207" stroke-width="1.5" transform="rotate(45 148 49)"/>'+
                '<rect x="140" y="41" width="16" height="16" fill="#fde047" transform="rotate(45 148 49)"/>'+
                '<rect x="143" y="44" width="10" height="10" fill="#fef08a" transform="rotate(45 148 49)"/>';
            var feuTricolore='<line x1="158" y1="46" x2="158" y2="90" stroke="#374151" stroke-width="3"/>'+
                '<rect x="151" y="46" width="14" height="32" rx="2" fill="#1f2937" stroke="#4b5563" stroke-width="1"/>'+
                '<circle cx="158" cy="52" r="5" fill="#22c55e"/><circle cx="158" cy="52" r="3" fill="#4ade80" opacity="0.8"/>'+
                '<circle cx="158" cy="62" r="5" fill="#d1d5db"/><circle cx="158" cy="72" r="5" fill="#d1d5db"/>';
            var zebra='<rect x="105" y="54" width="70" height="32" fill="#f8fafc"/>'+
                '<rect x="105" y="54" width="70" height="32" fill="none" stroke="#1e293b" stroke-width="1"/>'+
                '<line x1="110" y1="54" x2="110" y2="86" stroke="#1e293b" stroke-width="2.8"/><line x1="118" y1="54" x2="118" y2="86" stroke="#1e293b" stroke-width="2.8"/>'+
                '<line x1="126" y1="54" x2="126" y2="86" stroke="#1e293b" stroke-width="2.8"/><line x1="134" y1="54" x2="134" y2="86" stroke="#1e293b" stroke-width="2.8"/>'+
                '<line x1="142" y1="54" x2="142" y2="86" stroke="#1e293b" stroke-width="2.8"/><line x1="150" y1="54" x2="150" y2="86" stroke="#1e293b" stroke-width="2.8"/>'+
                '<line x1="158" y1="54" x2="158" y2="86" stroke="#1e293b" stroke-width="2.8"/><line x1="166" y1="54" x2="166" y2="86" stroke="#1e293b" stroke-width="2.8"/>'+
                '<line x1="174" y1="54" x2="174" y2="86" stroke="#1e293b" stroke-width="2.8"/>';
            var pieton='<circle cx="148" cy="60" r="6" fill="#1e293b"/><circle cx="148" cy="59" r="2" fill="#64748b"/>'+
                '<path d="M142 66 Q148 62 154 66" stroke="#1e293b" stroke-width="2.5" fill="none"/>'+
                '<line x1="148" y1="66" x2="148" y2="78" stroke="#1e293b" stroke-width="2.2"/>'+
                '<line x1="144" y1="78" x2="152" y2="78" stroke="#1e293b" stroke-width="2"/>'+
                '<line x1="145" y1="66" x2="151" y2="70" stroke="#1e293b" stroke-width="1.2"/>'+
                '<line x1="146" y1="72" x2="150" y2="74" stroke="#1e293b" stroke-width="1"/>';
            var prioritaire='<ellipse cx="218" cy="79" rx="22" ry="3" fill="#1a202c" opacity="0.45"/>'+
                car(198,68,'#1e3a5f')+
                '<rect x="208" y="72" width="6" height="5" rx="1" fill="#1e293b"/><rect x="216" y="72" width="6" height="5" rx="1" fill="#1e293b"/>'+
                '<circle cx="211" cy="75" r="4" fill="#ef4444"/><circle cx="211" cy="75" r="2" fill="#fca5a5"/>'+
                '<circle cx="218" cy="75" r="4" fill="#3b82f6"/><circle cx="218" cy="75" r="2" fill="#93c5fd"/>'+
                '<circle cx="225" cy="75" r="4" fill="#ef4444"/><circle cx="225" cy="75" r="2" fill="#fca5a5"/>';
            var busDetail='<ellipse cx="236" cy="90" rx="28" ry="3" fill="#1a202c" opacity="0.3"/>'+
                '<rect x="204" y="58" width="64" height="34" rx="3" fill="#b45309" stroke="#1a202c" stroke-width="1"/>'+
                '<rect x="209" y="62" width="11" height="11" fill="#fef3c7"/><rect x="223" y="62" width="11" height="11" fill="#fef3c7"/>'+
                '<rect x="237" y="62" width="11" height="11" fill="#fef3c7"/><rect x="251" y="62" width="11" height="11" fill="#fef3c7"/>'+
                '<rect x="258" y="66" width="6" height="18" fill="#78350f" rx="1"/><line x1="261" y1="68" x2="261" y2="82" stroke="#92400e"/>'+
                '<circle cx="212" cy="90" r="4" fill="#1a202c"/><circle cx="212" cy="90" r="2" fill="#4b5563"/>'+
                '<circle cx="258" cy="90" r="4" fill="#1a202c"/><circle cx="258" cy="90" r="2" fill="#4b5563"/>'+
                '<rect x="206" y="60" width="3" height="4" fill="#fef08a"/><rect x="262" y="62" width="2" height="5" fill="#fca5a5"/>';
            var tramDetail='<rect x="154" y="52" width="78" height="38" rx="2" fill="#475569" stroke="#1e293b" stroke-width="1"/>'+
                '<rect x="159" y="56" width="13" height="13" fill="#94a3b8"/><rect x="176" y="56" width="13" height="13" fill="#94a3b8"/>'+
                '<rect x="193" y="56" width="13" height="13" fill="#94a3b8"/><rect x="210" y="56" width="13" height="13" fill="#94a3b8"/>'+
                '<rect x="227" y="58" width="8" height="18" fill="#64748b"/><line x1="168" y1="88" x2="168" y2="90" stroke="#1e293b" stroke-width="2"/>'+
                '<circle cx="168" cy="88" r="5" fill="#1f2937"/><circle cx="168" cy="88" r="2" fill="#4b5563"/>'+
                '<circle cx="220" cy="88" r="5" fill="#1f2937"/><circle cx="220" cy="88" r="2" fill="#4b5563"/>'+
                '<line x1="193" y1="48" x2="193" y2="52" stroke="#64748b" stroke-width="1.5"/><rect x="189" y="42" width="8" height="8" fill="#94a3b8"/>';
            var trainDetail='<rect x="0" y="56" width="280" height="28" fill="#374151"/><path d="M0 70 L280 70" stroke="#fbbf24" stroke-width="1.2" stroke-dasharray="8 5"/>'+
                '<path d="M0 64 L280 64" stroke="#6b7280" stroke-width="0.8" opacity="0.5"/><path d="M0 76 L280 76" stroke="#6b7280" stroke-width="0.8" opacity="0.5"/>'+
                '<rect x="75" y="35" width="20" height="50" fill="#78716c" stroke="#57534e"/><rect x="185" y="35" width="20" height="50" fill="#78716c" stroke="#57534e"/>'+
                '<line x1="75" y1="42" x2="95" y2="42" stroke="#fbbf24" stroke-width="2"/><line x1="185" y1="42" x2="205" y2="42" stroke="#fbbf24" stroke-width="2"/>'+
                '<circle cx="85" cy="38" r="3" fill="#ef4444"/><circle cx="195" cy="38" r="3" fill="#ef4444"/>'+
                '<rect x="113" y="36" width="52" height="50" rx="2" fill="#b91c1c" stroke="#7f1d1d" stroke-width="1"/>'+
                '<rect x="118" y="42" width="12" height="14" fill="#fef2f2"/><rect x="134" y="42" width="12" height="14" fill="#fef2f2"/>'+
                '<rect x="150" y="42" width="10" height="14" fill="#fecaca"/>'+
                '<circle cx="126" cy="82" r="5" fill="#1f2937"/><circle cx="126" cy="82" r="2" fill="#4b5563"/>'+
                '<circle cx="152" cy="82" r="5" fill="#1f2937"/><circle cx="152" cy="82" r="2" fill="#4b5563"/>'+
                '<line x1="139" y1="28" x2="139" y2="36" stroke="#78716c" stroke-width="2"/>'+
                '<rect x="134" y="20" width="10" height="14" fill="#a8a29e" rx="1"/>';
            var cyclisteDetail='<circle cx="128" cy="56" r="7" fill="#1e293b"/><circle cx="128" cy="55" r="2" fill="#64748b"/>'+
                '<path d="M122 62 Q128 58 134 62" stroke="#1e293b" stroke-width="2.2" fill="none"/>'+
                '<line x1="128" y1="62" x2="128" y2="74" stroke="#1e293b" stroke-width="2"/>'+
                '<line x1="124" y1="74" x2="132" y2="74" stroke="#1e293b" stroke-width="1.8"/>'+
                '<circle cx="142" cy="70" r="6" fill="#6b7280"/><circle cx="142" cy="70" r="3" fill="#9ca3af"/>'+
                '<circle cx="114" cy="70" r="6" fill="#6b7280"/><circle cx="114" cy="70" r="3" fill="#9ca3af"/>'+
                '<line x1="116" y1="70" x2="140" y2="70" stroke="#4b5563" stroke-width="2.2"/>'+
                '<line x1="125" y1="68" x2="131" y2="72" stroke="#374151" stroke-width="1.2"/>'+
                '<ellipse cx="128" cy="72" rx="4" ry="2" fill="#1e293b"/>';
            var parkingZone='<rect x="6" y="56" width="74" height="82" fill="#9ca3af" stroke="#6b7280" stroke-width="2"/>'+
                '<rect x="10" y="60" width="66" height="20" fill="#78716c" opacity="0.4"/><rect x="12" y="62" width="62" height="16" fill="#57534e"/>'+
                '<path d="M16 72 H68 M16 82 H68 M16 92 H68 M16 102 H68 M16 112 H68" stroke="#6b7280" stroke-dasharray="4 3" stroke-width="1"/>'+
                '<path d="M16 72 V112 M28 72 V112 M40 72 V112 M52 72 V112 M68 72 V112" stroke="#6b7280" stroke-dasharray="2 2" stroke-width="0.8"/>'+
                '<rect x="20" y="76" width="24" height="20" rx="1" fill="#d1d5db" stroke="#9ca3af"/>'+
                '<rect x="24" y="80" width="8" height="8" fill="#93c5fd"/><circle cx="28" cy="92" r="2" fill="#374151"/><circle cx="36" cy="92" r="2" fill="#374151"/>';
            var s='';

            if(idx<=0||idx===10||idx===15||idx===25||idx===35){
                s=vb+grass+parkingZone+road+car(95,68,'#2563eb')+car(195,68,'#6b7280');
            }
            else if(idx===1||idx===16){
                s=vb+grass+'<circle cx="140" cy="70" r="50" fill="url(#roadGP)"/><circle cx="140" cy="70" r="32" fill="#6b8e23"/>'+
                '<path d="M108 70 A32 32 0 0 1 140 38" stroke="#fff" stroke-width="2" fill="none" stroke-dasharray="6 4"/>'+
                '<path d="M122 54 A16 16 0 0 1 138 68" stroke="#fff" stroke-width="1.5" fill="none"/>'+
                '<polygon points="136,66 142,70 137,74" fill="#fff"/>'+
                cedezPanneau+car(82,48,'#2563eb')+car(198,72,'#6b7280');
            }
            else if(idx===2||idx===17){
                s=vb+grass+'<rect x="0" y="54" width="280" height="32" fill="url(#roadGP)"/><rect x="126" y="0" width="30" height="140" fill="url(#roadGP)"/>'+
                '<rect x="0" y="54" width="280" height="3" fill="#fff"/><rect x="0" y="83" width="280" height="3" fill="#fff"/>'+
                '<path d="M0 70 L280 70 M141 0 L141 140" stroke="#fff" stroke-dasharray="10 8" stroke-width="2"/>'+
                '<rect x="72" y="66" width="8" height="8" fill="#fff"/>'+
                '<line x1="80" y1="70" x2="126" y2="70" stroke="#fff" stroke-width="2.5"/>'+
                stopPanneau+car(72,68,'#2563eb');
            }
            else if(idx===3||idx===18){
                s=vb+grass+road+zebra+pieton+car(205,68,'#2563eb');
            }
            else if(idx===4||idx===19){
                s=vb+grass+'<rect x="0" y="52" width="280" height="36" fill="url(#roadGP)"/><rect x="128" y="0" width="26" height="140" fill="url(#roadGP)"/>'+
                '<path d="M0 70 L280 70 M141 0 L141 140" stroke="#fff" stroke-dasharray="8 6"/>'+
                '<rect x="0" y="52" width="280" height="2" fill="#fff"/><rect x="0" y="86" width="280" height="2" fill="#fff"/>'+
                car(72,58,'#2563eb')+car(168,68,'#6b7280');
            }
            else if(idx===5||idx===11||idx===20||idx===26){
                s=vb+grass+road+losangePanneau+car(55,68,'#2563eb')+car(205,58,'#6b7280');
            }
            else if(idx===6||idx===12||idx===21||idx===27||idx===36){
                s=vb+grass+road+car(65,68,'#2563eb')+prioritaire;
            }
            else if(idx===7||idx===22||idx===32){
                s=vb+grass+'<rect x="0" y="52" width="280" height="36" fill="url(#roadGP)"/><rect x="128" y="0" width="26" height="140" fill="url(#roadGP)"/>'+
                '<path d="M0 70 L280 70 M141 0 L141 140" stroke="#fff" stroke-dasharray="8 6"/>'+
                '<rect x="0" y="52" width="280" height="2" fill="#fff"/><rect x="0" y="86" width="280" height="2" fill="#fff"/>'+
                car(72,68,'#6b7280')+car(168,58,'#2563eb');
            }
            else if(idx===8||idx===23){
                s=vb+grass+road+cedezPanneau+car(118,68,'#2563eb');
            }
            else if(idx===9||idx===24||idx===33){
                s=vb+grass+road+car(95,68,'#2563eb')+pieton;
            }
            else if(idx===13||idx===28){
                s=vb+grass+'<rect x="0" y="52" width="280" height="36" fill="url(#roadGP)"/><rect x="128" y="88" width="26" height="54" fill="url(#roadGP)"/>'+
                '<path d="M0 70 L280 70 M141 70 L141 140" stroke="#fff" stroke-dasharray="8 6"/>'+
                '<rect x="0" y="52" width="280" height="2" fill="#fff"/><rect x="0" y="86" width="280" height="2" fill="#fff"/>'+
                car(72,68,'#2563eb')+car(168,75,'#6b7280');
            }
            else if(idx===14){
                s=vb+grass+road+car(70,68,'#2563eb')+'<rect x="132" y="56" width="46" height="30" rx="2" fill="#d1d5db" stroke="#6b7280" stroke-width="1.5"/>'+
                '<path d="M138 62 H172 M138 70 H172 M138 78 H172" stroke="#9ca3af" stroke-dasharray="3 2"/>'+
                '<path d="M138 62 V82 M152 62 V82 M166 62 V82" stroke="#9ca3af" stroke-dasharray="2 2"/>'+
                '<rect x="142" y="64" width="22" height="14" rx="1" fill="none" stroke="#94a3b8" stroke-dasharray="4 2"/>';
            }
            else if(idx===29){
                s=vb+grass+road+'<path d="M0 70 L75 70 L75 95 L0 95 Z" fill="#9ca3af" opacity="0.9" stroke="#6b7280"/>'+
                car(105,68,'#2563eb')+car(215,68,'#6b7280');
            }
            else if(idx===30){
                s=vb+grass+road+tramDetail+car(55,68,'#2563eb');
            }
            else if(idx===31){
                s=vb+grass+road+busDetail+car(55,68,'#2563eb');
            }
            else if(idx===34){
                s=vb+grass+road+car(55,68,'#2563eb')+busDetail;
            }
            else if(idx===37){
                s=vb+grass+'<rect x="0" y="52" width="280" height="36" fill="url(#roadGP)"/><rect x="128" y="0" width="26" height="140" fill="url(#roadGP)"/>'+
                '<path d="M0 70 L280 70 M141 0 L141 140" stroke="#fff" stroke-dasharray="8 6"/>'+
                '<rect x="0" y="52" width="280" height="2" fill="#fff"/><rect x="0" y="86" width="280" height="2" fill="#fff"/>'+
                cyclisteDetail+car(178,58,'#2563eb');
            }
            else if(idx===38){
                s=vb+grass+trainDetail;
            }
            else{
                s=vb+grass+road+car(80,68,'#2563eb')+car(165,68,'#6b7280');
            }
            var vignette='<rect x="0" y="0" width="280" height="140" fill="url(#vignetteGP)"/>';
            return s+vignette+'</svg>';
        }
        const prioriteIllustrations = (function(){ var a=[]; for(var i=0;i<39;i++) a.push(svgPriorite(scenePriorite(i))); return a; })();

        const IMAGES_BASE = 'Code-Route-Pro-Images/';
        const prioriteImageFiles = ['priorite-01-sortie-parking.png','priorite-02-giratoire-cede-passage-entree.png','priorite-03-stop-intersection-vide.png','priorite-04-pieton-passage-cloute.png','priorite-05-tourner-gauche-en-face.png','priorite-06-route-prioritaire-losange.png','priorite-07-vehicule-prioritaire-derriere.png','priorite-08-priorite-droite-carrefour.png','priorite-09-panneau-cedez-passage.png','priorite-10-marche-arriere-stationnement.png','priorite-11-sortie-parking-route.png','priorite-12-route-nationale-losange.png','priorite-13-pompiers-en-face.png','priorite-14-carrefour-en-t.png','priorite-15-creation-stationnement.png','priorite-16-allee-privee-route.png','priorite-17-rond-point-vehicules-anneau.png','priorite-18-stop-vide.png','priorite-19-pieton-traverse-passage.png','priorite-20-tourner-gauche-voiture-droit.png','priorite-21-route-losange-secondaire-droite.png','priorite-22-ambulance-derriere.png','priorite-23-carrefour-sans-signalisation-droite.png','priorite-24-cedez-passage-voie-libre.png','priorite-25-recul-stationnement-voiture.png','priorite-26-parking-souterrain-rue.png','priorite-27-route-nationale-gauche.png','priorite-28-police-en-face-route-etroite.png','priorite-29-carrefour-t-barre-horizontale.png','priorite-30-aire-repos-autoroute.png','priorite-31-tramway-engage-chaussee.png','priorite-32-bus-scolaire-feux-clignotants.png','priorite-33-deux-voitures-meme-temps-droite.png','priorite-34-sortie-place-pieton.png','priorite-35-voie-bus-bus-clignotants.png','priorite-36-chemin-foret-route.png','priorite-37-samu-vert-carrefour.png','priorite-38-tourner-gauche-cycliste-en-face.png','priorite-39-passage-niveau-train.png'];
        const examThemeImages = { signalisation: 'exam-panneau-triangle-danger.png', priorites: 'exam-place-priorite-droite.png', vitesse: 'exam-agglomeration-50.png', stationnement: 'exam-stationnement-5m-passage-pieton.png', conducteur: 'exam-alcoolemie-02-permis-probatoire.png', usagers: 'exam-pieton-intention-traverser.png', environnement: 'exam-eco-conduite.png', mecanique: 'exam-profondeur-sculptures-pneus.png', secours: 'exam-proteger-zone-accident.png', reglementation: 'exam-documents-contr√¥le.png' };
        // Mapping image ‚Üî question : s√©lectionne l'image la plus adapt√©e au contenu de la question
        function getExamImageForQuestion(q, qIdx) {
            var t = q.theme, qtext = (q.q||'').toLowerCase();
            var has=function(){for(var j=0;j<arguments.length;j++)if(qtext.indexOf(arguments[j])!==-1)return true;return false;};
            // Signalisation
            if((has('triangulaire','triangle')&&has('rouge'))&&!has('pointe en bas')) return 'exam-q001.png';
            if(has('ligne blanche continue')||(has('franchir')&&has('ligne')&&has('cycliste'))) return 'exam-q002.png';
            if(has('feu orange')&&!has('clignotant')) return 'exam-q003.png';
            if((has('rond')||has('circulaire'))&&has('bleu')&&!has('carr√©')&&!has('carre')) return 'exam-q004.png';
            if(has('orange clignotant')||(has('clignotant')&&has('feu'))) return 'exam-q005.png';
            if(has('giratoire')||has('rond-point')||has('rond point')) return has('priorit√© √† droite') ? 'exam-q062.png' : 'exam-q006.png';
            if(has('panneau stop')||has('au stop')||has('√† un stop')||has('arr√™t complet')) return 'exam-q007.png';
            if(has('parking')&&(has('sortez')||has('sortie')||has('quittez'))) return 'exam-q008.png';
            if((has('c√©dez')||has('c√©der'))&&(has('passage')||has('forme')||has('triangle pointe'))) return 'exam-q009.png';
            if(has('agglom√©ration')&&(has('50')||has('limite')||has('entrant'))) return 'exam-q010.png';
            if(has('route')&&has('double sens')&&!has('s√©par√©e')) return 'exam-q011.png';
            if(has('autoroute')&&(has('permis')||has('probatoire')||has('3 ans'))) return 'exam-q012.png';
            if(has('distance')&&(has('s√©curit√©')||has('secondes')||has('v√©hicule devant'))) return 'exam-q013.png';
            if(has('pluie')||has('mouill√©e')||has('mouill√©')) return has('freinage') ? 'exam-q014.png' : 'exam-q015.png';
            if(has('autoroute')&&has('pluie')) return 'exam-q015.png';
            if(has('stationnement')&&(has('30 secondes')||has('20 secondes')||has('colis')||has('quittez'))) return 'exam-q016.png';
            if(has('trottoir')&&has('stationnement')) return 'exam-q017.png';
            if(has('passage pi√©ton')&&(has('5 m')||has('5 m√®tres')||has('avant')||has('distance'))) return 'exam-q018.png';
            if(has('arr√™t')&&(has('commandes')||has('d√©finit')||has('signifie'))) return 'exam-q019.png';
            if(has('ligne jaune')||(has('marquage')&&has('arr√™t interdit'))) return 'exam-q020.png';
            // Conducteur
            if(has('alcool')||has('alcool√©mie')||has('0,2')||has('caf√©')) return 'exam-q021.png';
            if(has('oreillette')||has('√©couteurs')||has('t√©l√©phone')&&has('main')) return 'exam-q022.png';
            if(has('fatigue')||has('b√¢illements')) return 'exam-q024.png';
            if(has('points')&&(has('probatoire')||has('6 points')||has('stage'))) return has('stage') ? 'exam-q044.png' : 'exam-q025.png';
            if(has('r√©cup√©ration')&&has('points')) return 'exam-q025.png';
            // Usagers
            if(has('cycliste')&&has('d√©passer')||has('distance')&&has('1 m')) return 'exam-q026.png';
            if(has('pi√©ton')&&(has('passage')||has('traverser')||has('intention'))) return 'exam-q027.png';
            if(has('tramway')) return 'exam-q028.png';
            // Environnement / M√©canique / Secours / R√©glementation
            if(has('√©co-conduite')||has('eco-conduite')||has('carburant')) return 'exam-q029.png';
            if(has('crit\'air')||has('critair')||has('vignette')||has('zfe')) return 'exam-q030.png';
            if(has('pneus')||has('sculptures')||has('rainures')||has('1,6')) return 'exam-q031.png';
            if(has('abs')||has('blocage')&&has('roues')) return 'exam-q032.png';
            if(has('p-a-s')||(has('prot√©ger')&&has('alerter'))||(has('accident')&&has('geste'))) return 'exam-q033.png';
            if(has('112')||(has('urgence')&&has('europ√©en'))) return 'exam-q034.png';
            if(has('assurance')||has('responsabilit√© civile')||has(' rc ')) return 'exam-q035.png';
            if(has('document')||(has('permis')&&has('carte grise'))) return 'exam-q035.png';
            if(has('carr√©')&&has('bleu')&&(has('fl√®che')||has('indication'))) return 'exam-q036.png';
            if(has('ligne')&&(has('discontinue')||has('pointill√©s'))) return 'exam-q037.png';
            if(has('sens unique')||has('contresens')) return 'exam-q038.png';
            if(has('bus')&&(has('arr√™t')||has('quitte')||has('clignotant'))) return 'exam-q039.png';
            if(has('zone de rencontre')||has('zone 20')) return 'exam-q040.png';
            if(has('brouillard')||has('visibilit√©')&&has('50')) return 'exam-q041.png';
            if(has('135')&&has('t√©l√©phone')) return 'exam-q043.png';
            if(has('v√©lo barr√©')||has('cyclistes interdit')||has('acc√®s cyclistes')) return 'exam-q147.png';
            if(has('sens interdit')||(has('rond')&&has('rouge')&&has('barre'))) return 'exam-q054.png';
            if(has('passage √† niveau')||has('train')) return 'exam-q139.png';
            if(has('car scolaire')||has('feux clignotants')&&has('enfant')) return 'exam-q143.png';
            if(has('trottinette')||has('edpm')) return 'exam-q046.png';
            if(has('bouche')&&has('incendie')) return 'exam-q122.png';
            if(has('contr√¥le technique')||has('p√©riodicit√©')) return 'exam-q049.png';
            if(has('pompiers')||has('18')) return 'exam-q050.png';
            if(has('huile')||has('niveau')&&has('moteur')) return 'exam-q144.png';
            if(has('brouillard')&&has('feux')) return 'exam-q048.png';
            if(has('pression')&&has('pneus')) return 'exam-q132.png';
            if(has('disque')&&has(' a ')) return 'exam-q125.png';
            if(has('zone 30')) return 'exam-q140.png';
            if(has('panneau')&&has('70')) return 'exam-q120.png';
            if(has('traverser')&&has('carrefour')&&has('feu')) return 'exam-q150.png';
            // Fallback par th√®me puis index
            var themeImg = { signalisation:'exam-q001.png', priorites:'exam-q006.png', vitesse:'exam-q010.png', stationnement:'exam-q017.png', conducteur:'exam-q021.png', usagers:'exam-q027.png', environnement:'exam-q029.png', mecanique:'exam-q031.png', secours:'exam-q033.png', reglementation:'exam-q035.png' };
            return themeImg[t] || 'exam-q'+String(Math.min(qIdx+1,150)).padStart(3,'0')+'.png';
        }
        
        // Donn√©es : Qui a la priorit√© ?
        const prioriteSituations = [
            { situation: "Vous sortez d'un parking (ou d'une station-service). Une voiture arrive sur la route √† votre gauche.", answers: ["Vous c√©dez le passage", "Vous avez la priorit√©", "Priorit√© √† droite"], correct: 0, explanation: "En sortant d'un lieu priv√© (parking, garage, station), on c√®de TOUJOURS le passage aux v√©hicules sur la route, m√™me venant de gauche." },
            { situation: "Vous entrez dans un giratoire. Un panneau ¬´ C√©dez le passage ¬ª est √† l'entr√©e. Des v√©hicules circulent d√©j√† dans le giratoire.", answers: ["Vous avez la priorit√©", "Vous c√©dez le passage aux v√©hicules dans le giratoire", "Priorit√© √† droite"], correct: 1, explanation: "Dans un giratoire avec ¬´ C√©dez le passage ¬ª, la priorit√© est aux v√©hicules D√âJ√Ä dans le giratoire." },
            { situation: "Vous √™tes au STOP. Personne n'arrive. Que faites-vous ?", answers: ["Je passe sans m'arr√™ter", "Je m'arr√™te compl√®tement, puis je passe si la voie est libre", "J'acc√©l√®re"], correct: 1, explanation: "Au STOP, un arr√™t complet est OBLIGATOIRE m√™me si la route est d√©gag√©e." },
            { situation: "Un pi√©ton est sur le passage pi√©ton, il traverse. Vous approchez.", answers: ["Je klaxonne", "Je c√®de le passage et m'arr√™te si besoin", "Je passe, il doit attendre"], correct: 1, explanation: "Le pi√©ton engag√© sur un passage pi√©ton a la priorit√© absolue. Vous devez vous arr√™ter." },
            { situation: "Vous tournez √† gauche √† une intersection. En face, une voiture va tout droit.", answers: ["Vous passez en premier", "Vous c√©dez le passage au v√©hicule en face", "Priorit√© √† droite"], correct: 1, explanation: "En tournant √† gauche, on c√®de le passage aux v√©hicules qui viennent en face (tout droit ou qui tournent √† droite)." },
            { situation: "Vous √™tes sur une route avec le panneau losange jaune (route prioritaire). Une voiture arrive d'une route secondaire √† votre droite.", answers: ["Vous c√©dez le passage", "Vous avez la priorit√©", "Priorit√© √† droite"], correct: 1, explanation: "Sur une route prioritaire (losange jaune), vous avez la priorit√© sur les v√©hicules des routes secondaires." },
            { situation: "Vous voyez un v√©hicule avec gyrophare bleu et sir√®ne. Il arrive derri√®re vous.", answers: ["J'acc√©l√®re", "Je facilite son passage (je me range, je m'arr√™te si besoin)", "Je ne change rien"], correct: 1, explanation: "Les v√©hicules prioritaires (gyrophare + sir√®ne) ont la priorit√©. Il faut faciliter leur passage." },
            { situation: "√Ä un carrefour, aucune signalisation. Une voiture arrive √† votre droite.", answers: ["Vous avez la priorit√©", "Vous c√©dez le passage (priorit√© √† droite)", "Celui qui klaxonne en premier"], correct: 1, explanation: "Sans signalisation, c'est la priorit√© √† droite : vous c√©dez le passage au v√©hicule venant de votre droite." },
            { situation: "Vous √™tes au panneau ¬´ C√©dez le passage ¬ª. La route est libre.", answers: ["Je m'arr√™te obligatoirement", "Je ralentis et je passe car personne n'arrive", "Je klaxonne"], correct: 1, explanation: "Au ¬´ C√©dez le passage ¬ª, l'arr√™t n'est obligatoire que s'il y a un v√©hicule prioritaire. Si la route est libre, vous pouvez passer sans vous arr√™ter." },
            { situation: "Vous faites une marche arri√®re pour vous garer. Un v√©hicule arrive.", answers: ["J'ai la priorit√©", "Je c√®de le passage", "Priorit√© √† droite"], correct: 1, explanation: "Un v√©hicule en marche arri√®re n'a jamais la priorit√© ; il doit c√©der le passage √† tous." },
            { situation: "Vous quittez un parking par la sortie. Un v√©hicule circule sur la route.", answers: ["J'ai la priorit√©", "Je c√®de le passage", "Priorit√© √† droite"], correct: 1, explanation: "En sortant d'un lieu priv√© (parking, cour), on c√®de le passage aux v√©hicules sur la route." },
            { situation: "Vous √™tes sur une route nationale (losange jaune). Un v√©hicule d√©bouche d'une route √† votre gauche.", answers: ["Vous c√©dez le passage", "Vous avez la priorit√©", "Priorit√© √† droite"], correct: 1, explanation: "Sur une route prioritaire (losange), vous avez la priorit√© sur les v√©hicules des routes secondaires." },
            { situation: "Un v√©hicule d'intervention (pompiers) avec gyrophare et sir√®ne arrive en face. Vous √™tes sur une route √©troite.", answers: ["J'acc√©l√®re", "Je me range ou m'arr√™te pour faciliter son passage", "Je ne change rien"], correct: 1, explanation: "Les v√©hicules prioritaires (gyrophare + sir√®ne) ont la priorit√©. Il faut faciliter leur passage." },
            { situation: "√Ä un carrefour en T, vous √™tes sur la barre du T. Une voiture est sur la branche √† votre droite.", answers: ["Vous avez la priorit√©", "Vous c√©dez le passage (priorit√© √† droite)", "Celui qui arrive en premier"], correct: 1, explanation: "Sans signalisation, priorit√© √† droite : vous c√©dez au v√©hicule venant de votre droite." },
            { situation: "Vous voulez vous garer en cr√©neau. Un v√©hicule attend derri√®re vous.", answers: ["J'ai la priorit√© pour me garer", "Je c√®de le passage et je repars", "Priorit√© √† droite"], correct: 1, explanation: "En cr√©neau, si un v√©hicule attend, il est courtois de c√©der ; en pratique on ne ¬´ bloque ¬ª pas la circulation." },
            { situation: "Vous d√©bouchez d'une all√©e priv√©e sur une route. Des v√©hicules circulent.", answers: ["Ils me c√®dent le passage", "Je c√®de le passage √† tous", "Priorit√© √† droite"], correct: 1, explanation: "Quitter un lieu priv√© (all√©e, cour, garage) : on laisse toujours passer ceux qui sont sur la route." },
            { situation: "Rond-point avec ¬´ C√©dez le passage ¬ª. Plusieurs v√©hicules tournent d√©j√† dans l'anneau.", answers: ["J'entre, j'ai la priorit√©", "J'attends qu'ils passent puis j'entre", "Priorit√© √† droite"], correct: 1, explanation: "Ceux qui sont d√©j√† dans le rond-point sont prioritaires. On s'ins√®re quand c'est libre." },
            { situation: "STOP √† l'intersection. Aucune voiture en vue.", answers: ["Je ralentis et je passe", "Je marque un arr√™t complet puis je repars si libre", "J'acc√©l√®re"], correct: 1, explanation: "Le STOP exige un arr√™t complet, m√™me si personne n'arrive. Ensuite on c√®de √† tous." },
            { situation: "Un pi√©ton traverse d√©j√† sur le passage clout√©. Vous arrivez.", answers: ["Je klaxonne", "Je m'arr√™te et je le laisse finir", "Je passe √† c√¥t√©"], correct: 1, explanation: "Le pi√©ton engag√© sur le passage a la priorit√©. Obligation de s'arr√™ter." },
            { situation: "Vous tournez √† gauche. En face, un v√©hicule va tout droit.", answers: ["Je passe en premier", "Je c√®de le passage √† celui qui va tout droit", "Priorit√© √† droite"], correct: 1, explanation: "En tournant √† gauche, on laisse passer ceux qui viennent en face (tout droit ou √† droite)." },
            { situation: "Vous roulez sur une route √† losange jaune. Une voiture sort d'une route secondaire √† droite.", answers: ["Je c√®de", "J'ai la priorit√©", "Priorit√© √† droite"], correct: 1, explanation: "Sur une route prioritaire (losange), vous √™tes prioritaire sur les v√©hicules des routes secondaires." },
            { situation: "Ambulance avec gyrophare et sir√®ne derri√®re vous.", answers: ["J'acc√©l√®re", "Je me range ou m'arr√™te pour la laisser passer", "Je ne change rien"], correct: 1, explanation: "V√©hicule prioritaire en mission : il faut faciliter son passage (se ranger, s'arr√™ter si besoin)." },
            { situation: "Carrefour sans feu ni panneau. Une auto arrive par votre droite.", answers: ["J'ai la priorit√©", "Je c√®de (priorit√© √† droite)", "Le premier qui klaxonne"], correct: 1, explanation: "Sans signalisation, c'est la priorit√© √† droite : celui qui vient de droite passe en premier." },
            { situation: "Panneau ¬´ C√©dez le passage ¬ª. Personne sur la voie prioritaire.", answers: ["Arr√™t obligatoire quand m√™me", "Je ralentis et je passe car la voie est libre", "Je klaxonne"], correct: 1, explanation: "Au ¬´ C√©dez le passage ¬ª, on s'arr√™te seulement s'il y a du trafic prioritaire. Sinon on peut passer." },
            { situation: "Vous reculez pour une man≈ìuvre de stationnement. Une voiture arrive.", answers: ["J'ai la priorit√©", "Je c√®de le passage", "Priorit√© √† droite"], correct: 1, explanation: "En marche arri√®re, on n'a jamais la priorit√©. On laisse passer les autres." },
            { situation: "Vous sortez d'un parking souterrain. La rue est fr√©quent√©e.", answers: ["Les v√©hicules me c√®dent", "Je c√®de le passage √† la circulation", "Priorit√© √† droite"], correct: 1, explanation: "Sortie d'un lieu priv√© (parking, etc.) : on s'ins√®re en c√©dant le passage √† tous." },
            { situation: "Route nationale (losange). Une voiture d√©bouche d'une route √† gauche.", answers: ["Je c√®de", "J'ai la priorit√©", "Priorit√© √† droite"], correct: 1, explanation: "Sur route prioritaire, vous gardez la priorit√© sur les v√©hicules des routes qui croisent." },
            { situation: "V√©hicule de police avec gyrophare et sir√®ne en face sur route √©troite.", answers: ["J'acc√©l√®re", "Je me range ou m'arr√™te pour faciliter le passage", "Je continue"], correct: 1, explanation: "Prioritaire en mission : on lib√®re la voie (se ranger, s'arr√™ter) pour qu'il passe." },
            { situation: "Carrefour en T : vous √™tes sur la barre horizontale, une voiture sur la branche √† votre droite.", answers: ["J'ai la priorit√©", "Je c√®de (priorit√© √† droite)", "Le premier arriv√©"], correct: 1, explanation: "Sans signalisation, priorit√© √† droite : vous c√©dez √† celui qui arrive par votre droite." },
            { situation: "Vous sortez d'une aire de repos sur l'autoroute. Des v√©hicules roulent sur la voie de droite.", answers: ["J'ai la priorit√©", "Je c√®de le passage √† la circulation", "Priorit√© √† droite"], correct: 1, explanation: "En vous ins√©rant depuis une aire ou une bretelle, vous devez c√©der le passage aux v√©hicules d√©j√† sur l'autoroute." },
            { situation: "Un tramway s'engage sur la chauss√©e depuis un arr√™t. Vous roulez sur la m√™me voie.", answers: ["J'acc√©l√®re pour passer avant", "Je c√®de le passage au tramway", "Priorit√© √† droite"], correct: 1, explanation: "Le tramway est prioritaire sauf signalisation contraire ; en repartant d'un arr√™t, il doit pouvoir s'ins√©rer." },
            { situation: "Vous √™tes sur une route en lacet. Un bus scolaire avec feux clignotants fait monter des enfants. Vous arrivez en face.", answers: ["Je passe en premier", "Je m'arr√™te et je ne d√©passe pas", "Je klaxonne"], correct: 1, explanation: "En pr√©sence d'un car scolaire avec feux clignotants (mont√©e ou descente d'enfants), il faut s'arr√™ter et ne pas d√©passer." },
            { situation: "√Ä un carrefour, vous et une autre voiture arrivez en m√™me temps. L'autre est √† votre droite.", answers: ["J'ai la priorit√©", "Je c√®de le passage (priorit√© √† droite)", "On passe ensemble"], correct: 1, explanation: "Sans signalisation, priorit√© √† droite : vous c√©dez au v√©hicule qui arrive par votre droite." },
            { situation: "Vous voulez quitter une place de parking en marche arri√®re. Un pi√©ton passe derri√®re votre v√©hicule.", answers: ["J'ai la priorit√©", "Je c√®de le passage au pi√©ton", "Priorit√© √† droite"], correct: 1, explanation: "En man≈ìuvre (marche arri√®re, sortie de place), vous devez c√©der le passage aux pi√©tons et aux v√©hicules." },
            { situation: "Vous roulez sur une voie de bus. Un bus vous suit avec ses clignotants. La voie est √©troite.", answers: ["J'acc√©l√®re", "Je me range ou je quitte la voie pour le laisser passer", "Je ne change rien"], correct: 1, explanation: "Sur une voie r√©serv√©e aux bus, il faut faciliter le passage des bus ; en pratique, se ranger ou quitter la voie si possible." },
            { situation: "Vous d√©bouchez d'un chemin forestier sur une route d√©partementale. Des v√©hicules circulent.", answers: ["Ils me c√®dent le passage", "Je c√®de le passage √† tous", "Priorit√© √† droite"], correct: 1, explanation: "En quittant un chemin non ouvert √† la circulation publique (ou priv√©), on c√®de le passage √† tous les v√©hicules sur la route." },
            { situation: "Un v√©hicule de secours (SAMU) avec gyrophare et sir√®ne arrive en face √† un carrefour. Vous √™tes engag√© au vert.", answers: ["Je termine mon passage", "Je m'arr√™te pour le laisser passer", "J'acc√©l√®re"], correct: 1, explanation: "Les v√©hicules prioritaires en mission ont la priorit√© ; il faut faciliter leur passage (s'arr√™ter, se ranger)." },
            { situation: "Vous tournez √† gauche. Un cycliste arrive en face et va tout droit. Qui c√®de ?", answers: ["Le cycliste me c√®de", "Je c√®de le passage au cycliste", "Priorit√© √† droite"], correct: 1, explanation: "En tournant √† gauche, on c√®de le passage aux usagers qui viennent en face (dont les cyclistes)." },
            { situation: "√Ä un passage √† niveau sans barri√®re, les feux clignotent et la sonnerie retentit. Un train approche.", answers: ["Je traverse rapidement", "Je m'arr√™te avant les rails et je n'engage pas mon v√©hicule", "Je klaxonne"], correct: 1, explanation: "√Ä un passage √† niveau, d√®s que les feux clignotent ou les barri√®res se ferment, il est interdit de s'engager sur les rails." }
        ];
        
        function startPriorite() {
            document.getElementById('gamesMenu').style.display = 'none';
            document.getElementById('prioriteGame').style.display = 'block';
            prioriteQuestions = shuffleArray(prioriteSituations).slice(0, 10);
            prioriteIndex = 0;
            prioriteScore = 0;
            document.getElementById('prioriteNum').textContent = '1';
            document.getElementById('prioriteScore').textContent = '0';
            renderPriorite();
            window.scrollTo(0, 0);
        }
        
        function renderPriorite() {
            const container = document.getElementById('prioriteContent');
            if (prioriteIndex >= prioriteQuestions.length) {
                container.innerHTML = `
                    <div class="results-card">
                        <h2>üîÑ Qui a la priorit√© ? ‚Äî Termin√© !</h2>
                        <div class="results-score">${prioriteScore}/10</div>
                        <p>${prioriteScore >= 7 ? 'Bravo, les priorit√©s n\'ont plus de secret !' : 'Relisez le cours Priorit√©s pour progresser.'}</p>
                        <button class="btn" onclick="backToGames()">‚Üê Retour aux jeux</button>
                    </div>
                `;
                return;
            }
            const q = prioriteQuestions[prioriteIndex];
            const origIdx = prioriteSituations.indexOf(q);
            const prioriteImg = (origIdx >= 0 && prioriteImageFiles[origIdx]) ? '<img src="'+IMAGES_BASE+prioriteImageFiles[origIdx]+'" alt="Situation" class="situation-illustration">' : '';
            container.innerHTML = `
                <div class="question-card">
                    <div class="question-number">Situation ${prioriteIndex + 1}/10</div>
                    ${prioriteImg}
                    <div class="question-text" style="font-size:1.15em;">${q.situation}</div>
                    <p style="margin:15px 0 10px; color: var(--text-light);">Qui doit c√©der le passage ?</p>
                    <div class="answers-grid">
                        ${shuffleArray(q.answers.map((_,j)=>j)).map(origIdx => `<div class="answer-option" onclick="answerPriorite(${origIdx})"><div class="answer-radio"></div><span>${q.answers[origIdx]}</span></div>`).join('')}
                    </div>
                </div>
            `;
        }
        
        function answerPriorite(choiceIndex) {
            const q = prioriteQuestions[prioriteIndex];
            const correct = choiceIndex === q.correct;
            if (correct) {
                prioriteScore++;
                if (soundEnabled) playSound('correct');
            } else if (soundEnabled) playSound('wrong');
            document.getElementById('prioriteScore').textContent = prioriteScore;
            const origIdxAns = prioriteSituations.indexOf(q);
            const prioriteImgAns = (origIdxAns >= 0 && prioriteImageFiles[origIdxAns]) ? '<img src="'+IMAGES_BASE+prioriteImageFiles[origIdxAns]+'" alt="Situation" class="situation-illustration">' : '';
            document.getElementById('prioriteContent').innerHTML = `
                <div class="question-card">
                    <div class="question-number">${correct ? '‚úÖ Correct !' : '‚ùå Faux'}</div>
                    ${prioriteImgAns}
                    <div class="question-text">${q.situation}</div>
                    <div class="explanation"><strong>üí°</strong> ${q.explanation}</div>
                    <button class="btn" style="margin-top:20px;" onclick="prioriteIndex++; document.getElementById('prioriteNum').textContent = prioriteIndex + 1; renderPriorite();">Suivant ‚Üí</button>
                </div>
            `;
        }
        
        // Donn√©es : Chiffres cl√©s
        const chiffresData = [
            { q: "Vitesse max en agglom√©ration (par d√©faut) ?", answers: ["30 km/h", "50 km/h", "70 km/h", "90 km/h"], correct: 1, explanation: "En ville, 50 km/h sauf panneau indiquant autre chose (zone 30, 70‚Ä¶)." },
            { q: "Vitesse max sur autoroute (temps sec) ?", answers: ["110 km/h", "120 km/h", "130 km/h", "140 km/h"], correct: 2, explanation: "130 km/h sur autoroute par temps sec. 110 km/h par temps de pluie." },
            { q: "Distance de s√©curit√© minimum entre deux v√©hicules ?", answers: ["1 seconde", "2 secondes", "3 secondes", "5 secondes"], correct: 1, explanation: "Au moins 2 secondes entre vous et le v√©hicule devant (r√®gle des ¬´ 1001, 1002 ¬ª)." },
            { q: "Nombre de points sur le permis au d√©part (permis probatoire) ?", answers: ["4 points", "6 points", "8 points", "12 points"], correct: 1, explanation: "Permis probatoire : 6 points au d√©part, puis +2 ou +3 par an sans infraction." },
            { q: "Taux d'alcool max pour un permis de moins de 3 ans ?", answers: ["0,2 g/L", "0,5 g/L", "0,8 g/L", "1 g/L"], correct: 0, explanation: "Jeune conducteur : 0,2 g/L maximum (en pratique, z√©ro alcool recommand√©)." },
            { q: "Profondeur minimum des sculptures des pneus (l√©gal) ?", answers: ["0,8 mm", "1,6 mm", "2,5 mm", "3 mm"], correct: 1, explanation: "1,6 mm sur toute la bande de roulement. En dessous = infraction." },
            { q: "Vitesse max sur route √† 2 voies (hors agglom√©ration, temps sec) ?", answers: ["70 km/h", "80 km/h", "90 km/h", "110 km/h"], correct: 1, explanation: "80 km/h par d√©faut sur route √† double sens (90 si panneau selon d√©partements)." },
            { q: "Distance min pour d√©passer un cycliste hors agglom√©ration ?", answers: ["0,5 m", "1 m", "1,5 m", "2 m"], correct: 2, explanation: "Hors agglom√©ration : 1,50 m minimum. En ville : 1 m." },
            { q: "Amende possible pour circulation sans assurance ?", answers: ["135 ‚Ç¨", "750 ‚Ç¨", "1 500 ‚Ç¨", "3 750 ‚Ç¨"], correct: 3, explanation: "Circuler sans assurance : jusqu'√† 3 750 ‚Ç¨ + suspension + confiscation possible." },
            { q: "Premier contr√¥le technique obligatoire (v√©hicule neuf) ?", answers: ["2 ans", "3 ans", "4 ans", "5 ans"], correct: 2, explanation: "Premier contr√¥le avant 4 ans, puis tous les 2 ans." },
            { q: "Vitesse max autoroute pour permis probatoire ?", answers: ["100 km/h", "110 km/h", "120 km/h", "130 km/h"], correct: 1, explanation: "Permis de moins de 3 ans : 110 km/h sur autoroute (au lieu de 130)." },
            { q: "T√©l√©phone en main au volant : amende forfaitaire ?", answers: ["68 ‚Ç¨", "135 ‚Ç¨", "375 ‚Ç¨", "750 ‚Ç¨"], correct: 1, explanation: "T√©l√©phone tenu en main : 135 ‚Ç¨ et 3 points." },
            { q: "Alcool√©mie max conducteur confirm√© ?", answers: ["0,2 g/L", "0,5 g/L", "0,8 g/L", "1 g/L"], correct: 1, explanation: "Conducteur confirm√© : 0,5 g/L de sang maximum." },
            { q: "Stage de r√©cup√©ration de points : combien max ?", answers: ["2 points", "4 points", "6 points", "8 points"], correct: 1, explanation: "Un stage peut rendre au maximum 4 points (une fois par an)." },
            { q: "Zone 30 : vitesse max ?", answers: ["20 km/h", "30 km/h", "50 km/h", "70 km/h"], correct: 1, explanation: "Zone 30 : 30 km/h (zones r√©sidentielles, abords √©coles)." },
            { q: "Vitesse max en zone de rencontre ?", answers: ["20 km/h", "30 km/h", "50 km/h", "70 km/h"], correct: 0, explanation: "Zone de rencontre : 20 km/h. Les pi√©tons peuvent circuler sur la chauss√©e et sont prioritaires." },
            { q: "Distance min pour d√©passer un cycliste en agglom√©ration ?", answers: ["0,5 m", "1 m", "1,5 m", "2 m"], correct: 1, explanation: "En ville : 1 m minimum entre le v√©hicule et le cycliste. Hors agglo : 1,50 m." },
            { q: "Amende forfaitaire pour non-port de la ceinture (conducteur) ?", answers: ["68 ‚Ç¨", "135 ‚Ç¨", "375 ‚Ç¨", "750 ‚Ç¨"], correct: 1, explanation: "Ceinture non attach√©e : 135 ‚Ç¨ d'amende et 3 points de retrait." },
            { q: "Nombre de classes pour la vignette Crit'Air ?", answers: ["4", "5", "6", "8"], correct: 2, explanation: "Crit'Air comporte 6 classes (0 √† 5). 0 = v√©hicules les plus propres (√©lectrique, hydrog√®ne)." },
            { q: "Premier contr√¥le technique pour un v√©hicule neuf : avant combien de temps ?", answers: ["2 ans", "3 ans", "4 ans", "5 ans"], correct: 2, explanation: "Premier contr√¥le technique obligatoire avant 4 ans pour un v√©hicule neuf, puis tous les 2 ans." },
            { q: "Vitesse max sur autoroute par temps de pluie ?", answers: ["100 km/h", "110 km/h", "120 km/h", "130 km/h"], correct: 1, explanation: "Autoroute : 130 km/h temps sec, 110 km/h par temps de pluie." },
            { q: "Visibilit√© inf√©rieure √† 50 m (brouillard) : vitesse max sur toute route ?", answers: ["30 km/h", "50 km/h", "80 km/h", "90 km/h"], correct: 1, explanation: "Visibilit√© < 50 m : 50 km/h maximum sur toutes les routes, autoroute comprise." },
            { q: "Num√©ro d'urgence europ√©en unique ?", answers: ["15", "17", "18", "112"], correct: 3, explanation: "Le 112 fonctionne dans tous les pays de l'Union europ√©enne pour toute urgence." },
            { q: "Points retir√©s pour t√©l√©phone tenu en main au volant ?", answers: ["1 point", "2 points", "3 points", "6 points"], correct: 2, explanation: "T√©l√©phone en main : 135 ‚Ç¨ et 3 points de retrait." },
            { q: "Profondeur minimale l√©gale des sculptures des pneus ?", answers: ["0,8 mm", "1,6 mm", "2,5 mm", "3 mm"], correct: 1, explanation: "1,6 mm sur toute la bande de roulement. En dessous = infraction et danger." },
            { q: "Feux de brouillard arri√®re : √† partir de quelle visibilit√© les allumer ?", answers: ["< 200 m", "< 150 m", "< 100 m", "< 50 m"], correct: 2, explanation: "Feux de brouillard arri√®re uniquement si visibilit√© inf√©rieure √† 100 m (brouillard, neige)." },
            { q: "Capital points maximum sur le permis (apr√®s r√©cup√©ration) ?", answers: ["6 points", "8 points", "12 points", "15 points"], correct: 2, explanation: "Le permis comporte 12 points au maximum. Apr√®s retrait, r√©cup√©ration progressive selon les r√®gles." },
            { q: "Amende forfaitaire pour exc√®s de vitesse inf√©rieur √† 20 km/h (hors agglo) ?", answers: ["68 ‚Ç¨", "135 ‚Ç¨", "375 ‚Ç¨", "750 ‚Ç¨"], correct: 0, explanation: "Exc√®s < 20 km/h : 68 ‚Ç¨ (contravention de 2e classe) et 1 point." },
            { q: "Vitesse max sur route √† chauss√©e s√©par√©e (2√ó2 voies) hors agglo ?", answers: ["80 km/h", "90 km/h", "110 km/h", "130 km/h"], correct: 2, explanation: "Route √† chauss√©e s√©par√©e hors agglom√©ration : 110 km/h par d√©faut." },
            { q: "Permis probatoire : r√©cup√©ration de combien de points par an sans infraction ?", answers: ["1 point", "2 points", "2 ou 3 points", "6 points"], correct: 2, explanation: "Permis probatoire : +2 points par an sans infraction (ou +3 pour conduite accompagn√©e)." },
            { q: "Num√©ro pour alerter le SAMU ?", answers: ["15", "17", "18", "112"], correct: 0, explanation: "15 = SAMU (urgence m√©dicale). 17 = police, 18 = pompiers, 112 = urgence europ√©en." },
            { q: "Num√©ro pour alerter la police/gendarmerie ?", answers: ["15", "17", "18", "112"], correct: 1, explanation: "17 = police/gendarmerie (accident, agression, etc.)." },
            { q: "Amende forfaitaire pour ceinture non attach√©e (passager) ?", answers: ["68 ‚Ç¨", "135 ‚Ç¨", "375 ‚Ç¨", "750 ‚Ç¨"], correct: 1, explanation: "Passager sans ceinture : 135 ‚Ç¨ (le conducteur peut √™tre sanctionn√© s'il est majeur)." },
            { q: "Distance de freinage √† 90 km/h sur route s√®che (ordre de grandeur) ?", answers: ["45 m", "65 m", "90 m", "120 m"], correct: 1, explanation: "√Ä 90 km/h sur route s√®che : environ 65 m (temps de r√©action + freinage)." },
            { q: "Zone de rencontre : vitesse max autoris√©e ?", answers: ["20 km/h", "30 km/h", "50 km/h", "70 km/h"], correct: 0, explanation: "Zone de rencontre : 20 km/h max. Les pi√©tons peuvent circuler sur la chauss√©e et sont prioritaires." },
            { q: "Disque A (jeune conducteur) : obligatoire pendant combien d'ann√©es ?", answers: ["1 an", "2 ans", "3 ans", "5 ans"], correct: 2, explanation: "Disque A obligatoire pendant 3 ans (ou 2 ans si conduite accompagn√©e)." },
            { q: "Points retir√©s pour un exc√®s de vitesse sup√©rieur √† 50 km/h ?", answers: ["2 points", "4 points", "6 points", "8 points"], correct: 2, explanation: "Exc√®s > 50 km/h : 6 points (et amende, suspension possible)." },
            { q: "Trottinette √©lectrique sur trottoir : vitesse max autoris√©e ?", answers: ["6 km/h", "25 km/h", "30 km/h", "Interdit"], correct: 0, explanation: "Sur trottoir, l'EDPM doit rouler √† 6 km/h max et ne pas g√™ner les pi√©tons." },
            { q: "Vitesse max autoroute par temps de pluie (tous permis) ?", answers: ["100 km/h", "110 km/h", "120 km/h", "130 km/h"], correct: 1, explanation: "Autoroute sous la pluie : 110 km/h pour tous." },
            { q: "Points retir√©s pour non-port de la ceinture (conducteur) ?", answers: ["1 point", "2 points", "3 points", "6 points"], correct: 2, explanation: "Ceinture non attach√©e : 135 ‚Ç¨ et 3 points." },
            { q: "Amende forfaitaire pour franchissement de ligne continue ?", answers: ["68 ‚Ç¨", "135 ‚Ç¨", "375 ‚Ç¨", "750 ‚Ç¨"], correct: 1, explanation: "Franchissement de ligne continue : 135 ‚Ç¨ et 3 points." },
            { q: "Vitesse max en zone 30 ?", answers: ["20 km/h", "30 km/h", "50 km/h", "70 km/h"], correct: 1, explanation: "Zone 30 : 30 km/h (zones r√©sidentielles, abords √©coles)." },
            { q: "Num√©ro pour alerter les pompiers ?", answers: ["15", "17", "18", "112"], correct: 2, explanation: "18 = pompiers (incendie, accident, secours)." },
            { q: "Distance min pour d√©passer un cycliste en ville ?", answers: ["0,5 m", "1 m", "1,5 m", "2 m"], correct: 1, explanation: "En agglom√©ration : 1 m minimum. Hors agglo : 1,50 m." },
            { q: "Premier contr√¥le technique (v√©hicule neuf) : avant ?", answers: ["2 ans", "3 ans", "4 ans", "5 ans"], correct: 2, explanation: "Premier CT avant 4 ans, puis tous les 2 ans." },
            { q: "Taux d'alcool max permis confirm√© (en g/L de sang) ?", answers: ["0,2", "0,5", "0,8", "1"], correct: 1, explanation: "Conducteur confirm√© : 0,5 g/L maximum." },
            { q: "Amende possible pour conduite sans permis (jamais obtenu) ?", answers: ["135 ‚Ç¨", "1 500 ‚Ç¨", "15 000 ‚Ç¨", "45 000 ‚Ç¨"], correct: 2, explanation: "Conduite sans permis : jusqu'√† 15 000 ‚Ç¨ d'amende et prison possible (d√©lit)." },
            { q: "Vitesse max route √† 2 voies hors agglo (par d√©faut) ?", answers: ["70 km/h", "80 km/h", "90 km/h", "110 km/h"], correct: 1, explanation: "80 km/h par d√©faut (90 si panneau selon d√©partements)." },
            { q: "Gilet de s√©curit√© et triangle : obligatoires ?", answers: ["Non", "Oui, dans le v√©hicule", "Seulement sur autoroute", "Seulement la nuit"], correct: 1, explanation: "Gilet r√©tror√©fl√©chissant et triangle obligatoires dans le v√©hicule (utilisation en cas d'arr√™t d'urgence)." },
            { q: "Points retir√©s pour exc√®s de vitesse entre 20 et 30 km/h ?", answers: ["1 point", "2 points", "3 points", "4 points"], correct: 1, explanation: "Exc√®s entre 20 et 30 km/h : 2 points (et amende)." },
            { q: "Vitesse max sur route √† chauss√©e s√©par√©e (2√ó2) hors agglo ?", answers: ["80 km/h", "90 km/h", "110 km/h", "130 km/h"], correct: 2, explanation: "Route √† chauss√©e s√©par√©e hors agglo : 110 km/h par d√©faut." },
            { q: "Stationnement interdit √† moins de combien de m√®tres d'un passage pi√©ton ?", answers: ["3 m", "5 m", "10 m", "15 m"], correct: 1, explanation: "Stationnement interdit √† moins de 5 m d'un passage pi√©ton." },
            { q: "Amende pour refus de priorit√© √† un pi√©ton ?", answers: ["68 ‚Ç¨", "135 ‚Ç¨", "375 ‚Ç¨", "750 ‚Ç¨"], correct: 1, explanation: "Refus de priorit√© au pi√©ton : 135 ‚Ç¨ et 6 points (faute √©liminatoire √† l'examen)." },
            { q: "Points retir√©s pour alcool entre 0,5 et 0,8 g/L ?", answers: ["2 points", "4 points", "6 points", "8 points"], correct: 2, explanation: "Alcool entre 0,5 et 0,8 g/L : 6 points et 135 ‚Ç¨." },
            { q: "Validit√© du permis de conduire (photo) ?", answers: ["10 ans", "15 ans", "20 ans", "√Ä vie"], correct: 1, explanation: "Le permis est valable 15 ans (photo √† renouveler)." },
            { q: "Vitesse max EDPM (trottinette √©lectrique) sur piste cyclable ?", answers: ["25 km/h", "30 km/h", "45 km/h", "50 km/h"], correct: 0, explanation: "EDPM limit√©s √† 25 km/h (6 km/h sur trottoir si autoris√©)." },
            { q: "Amende pour d√©faut de port du gilet en cas d'arr√™t d'urgence ?", answers: ["35 ‚Ç¨", "68 ‚Ç¨", "135 ‚Ç¨", "375 ‚Ç¨"], correct: 2, explanation: "Absence de gilet r√©fl√©chissant hors v√©hicule en cas d'arr√™t : 135 ‚Ç¨." },
            { q: "Exc√®s de vitesse entre 30 et 40 km/h : combien de points ?", answers: ["2 points", "3 points", "4 points", "6 points"], correct: 1, explanation: "Exc√®s entre 30 et 40 km/h : 3 points et amende." },
            { q: "Exc√®s de vitesse entre 40 et 50 km/h : combien de points ?", answers: ["2 points", "4 points", "6 points", "8 points"], correct: 1, explanation: "Exc√®s entre 40 et 50 km/h : 4 points et amende." },
            { q: "Temps de r√©action moyen du conducteur (en secondes) ?", answers: ["0,5 s", "1 s", "1,5 s", "2 s"], correct: 1, explanation: "Temps de r√©action moyen : environ 1 seconde (avant de freiner)." },
            { q: "Distance d'arr√™t √† 50 km/h sur route s√®che (ordre de grandeur) ?", answers: ["25 m", "35 m", "50 m", "70 m"], correct: 0, explanation: "√Ä 50 km/h : environ 25 m (r√©action + freinage sur route s√®che)." },
            { q: "Distance d'arr√™t √† 130 km/h sur autoroute s√®che (ordre de grandeur) ?", answers: ["100 m", "130 m", "160 m", "200 m"], correct: 2, explanation: "√Ä 130 km/h : environ 160 m (temps de r√©action + freinage)." },
            { q: "√Çge minimum pour conduire un cyclomoteur (sans permis) ?", answers: ["14 ans", "16 ans", "18 ans", "21 ans"], correct: 0, explanation: "BSR/AM possible √† 14 ans pour cyclomoteur 50 cm¬≥." },
            { q: "Amende pour usage de feu de brouillard arri√®re sans brouillard ?", answers: ["35 ‚Ç¨", "68 ‚Ç¨", "135 ‚Ç¨", "375 ‚Ç¨"], correct: 2, explanation: "Feux de brouillard arri√®re sans n√©cessit√© : 135 ‚Ç¨ (√©blouit les autres)." },
            { q: "Points maximum r√©cup√©rables avec un stage (par stage) ?", answers: ["2 points", "4 points", "6 points", "8 points"], correct: 1, explanation: "Un stage de r√©cup√©ration permet de r√©cup√©rer 4 points max (1 stage/an)." },
            { q: "Vitesse max en agglom√©ration sans indication ?", answers: ["30 km/h", "50 km/h", "70 km/h", "90 km/h"], correct: 1, explanation: "En agglom√©ration : 50 km/h par d√©faut." },
            { q: "Alcool √† partir de quel taux (permis confirm√©) = d√©lit ?", answers: ["0,5 g/L", "0,8 g/L", "1 g/L", "1,2 g/L"], correct: 1, explanation: "√Ä partir de 0,8 g/L : d√©lit (suspension, amende forte, prison possible)." },
            { q: "Contr√¥le technique : p√©riodicit√© apr√®s le premier ?", answers: ["Tous les ans", "Tous les 2 ans", "Tous les 3 ans", "Tous les 5 ans"], correct: 1, explanation: "Apr√®s le premier CT (avant 4 ans) : tous les 2 ans." },
            { q: "Nombre de points au d√©part pour un permis probatoire (conduite accompagn√©e) ?", answers: ["4 points", "6 points", "8 points", "12 points"], correct: 2, explanation: "AAC : 8 points au d√©part, puis +3 par an sans infraction (sur 12 max)." },
            { q: "R√©cup√©ration de points par an sans infraction (permis probatoire classique) ?", answers: ["1 point", "2 points", "3 points", "6 points"], correct: 1, explanation: "Permis probatoire classique : +2 points par an sans infraction." },
            { q: "Amende forfaitaire pour feu rouge ?", answers: ["135 ‚Ç¨", "375 ‚Ç¨", "750 ‚Ç¨", "1 500 ‚Ç¨"], correct: 0, explanation: "Feu rouge : 135 ‚Ç¨ et 4 points (peut √™tre plus en cas de circonstances aggravantes)." },
            { q: "Points retir√©s pour feu rouge ?", answers: ["2 points", "4 points", "6 points", "8 points"], correct: 1, explanation: "Franchissement de feu rouge : 4 points." },
            { q: "Vitesse max sur autoroute (temps sec) pour tous ?", answers: ["110 km/h", "120 km/h", "130 km/h", "140 km/h"], correct: 2, explanation: "130 km/h sur autoroute par temps sec (110 si pluie ou permis < 3 ans)." },
            { q: "Obligation du triangle de signalisation en cas d'arr√™t d'urgence ?", answers: ["Non obligatoire", "Obligatoire dans le v√©hicule", "Obligatoire d√©ploy√© √† 30 m", "Uniquement sur autoroute"], correct: 1, explanation: "Triangle obligatoire dans le v√©hicule (√† d√©ployer en cas d'arr√™t d'urgence si possible)." },
            { q: "Dur√©e du permis probatoire (sans conduite accompagn√©e) ?", answers: ["2 ans", "3 ans", "4 ans", "5 ans"], correct: 1, explanation: "Permis probatoire : 3 ans (2 ans si conduite accompagn√©e)." },
            { q: "Amende pour circulation sur bande d'arr√™t d'urgence (sans n√©cessit√©) ?", answers: ["68 ‚Ç¨", "135 ‚Ç¨", "375 ‚Ç¨", "750 ‚Ç¨"], correct: 1, explanation: "Usage de la BAU sans n√©cessit√© : 135 ‚Ç¨ et 3 points." },
            { q: "Distance de s√©curit√© sur autoroute √† 130 km/h (2 secondes) ‚âà ?", answers: ["65 m", "75 m", "90 m", "130 m"], correct: 2, explanation: "√Ä 130 km/h, en 2 secondes on parcourt environ 72 m ; il faut garder au moins cette distance." },
            { q: "Vitesse max en zone 30 (panneau) ?", answers: ["20 km/h", "30 km/h", "50 km/h", "70 km/h"], correct: 1, explanation: "Zone 30 : 30 km/h." },
            { q: "Taux d'alcool √† ne pas d√©passer (permis < 3 ans) en g/L ?", answers: ["0 g/L", "0,2 g/L", "0,5 g/L", "0,8 g/L"], correct: 1, explanation: "Jeune conducteur : 0,2 g/L maximum (z√©ro alcool conseill√©)." }
        ];
        
        function startChiffres() {
            document.getElementById('gamesMenu').style.display = 'none';
            document.getElementById('chiffresGame').style.display = 'block';
            chiffresQuestions = shuffleArray(chiffresData).slice(0, 10);
            chiffresIndex = 0;
            chiffresScore = 0;
            document.getElementById('chiffresNum').textContent = '1';
            document.getElementById('chiffresScore').textContent = '0';
            renderChiffres();
            window.scrollTo(0, 0);
        }
        
        function renderChiffres() {
            const container = document.getElementById('chiffresContent');
            if (chiffresIndex >= chiffresQuestions.length) {
                container.innerHTML = `
                    <div class="results-card">
                        <h2>üî¢ Chiffres cl√©s ‚Äî Termin√© !</h2>
                        <div class="results-score">${chiffresScore}/10</div>
                        <p>${chiffresScore >= 7 ? 'Bravo, les chiffres du code sont bien en t√™te !' : 'Relisez les cours pour m√©moriser vitesses, points et distances.'}</p>
                        <button class="btn" onclick="backToGames()">‚Üê Retour aux jeux</button>
                    </div>
                `;
                return;
            }
            const q = chiffresQuestions[chiffresIndex];
            container.innerHTML = `
                <div class="question-card">
                    <div class="question-number">Question ${chiffresIndex + 1}/10</div>
                    <div class="question-text">${q.q}</div>
                    <div class="answers-grid">
                        ${shuffleArray(q.answers.map((_,j)=>j)).map(origIdx => `<div class="answer-option" onclick="answerChiffres(${origIdx})"><div class="answer-radio"></div><span>${q.answers[origIdx]}</span></div>`).join('')}
                    </div>
                </div>
            `;
        }
        
        function answerChiffres(choiceIndex) {
            const q = chiffresQuestions[chiffresIndex];
            const correct = choiceIndex === q.correct;
            if (correct) {
                chiffresScore++;
                if (soundEnabled) playSound('correct');
            } else if (soundEnabled) playSound('wrong');
            document.getElementById('chiffresScore').textContent = chiffresScore;
            document.getElementById('chiffresContent').innerHTML = `
                <div class="question-card">
                    <div class="question-number">${correct ? '‚úÖ Correct !' : '‚ùå Faux'}</div>
                    <div class="question-text">${q.q}</div>
                    <div class="explanation"><strong>üí°</strong> ${q.explanation}</div>
                    <button class="btn" style="margin-top:20px;" onclick="chiffresIndex++; document.getElementById('chiffresNum').textContent = chiffresIndex + 1; renderChiffres();">Suivant ‚Üí</button>
                </div>
            `;
        }
        
        // Pool suppl√©mentaire pour le Quiz Chrono (tire 10 au hasard parmi quiz + ce pool)
        const speedQuizExtraQuestions = [
            { theme: 'signalisation', q: 'Un panneau triangulaire pointe en haut indique :', answers: ['Une interdiction', 'Un danger', 'Une obligation', 'Une indication'], correct: 1, explanation: 'Triangle pointe en haut = danger.' },
            { theme: 'priorites', q: '√Ä un rond-point, qui a la priorit√© en l\'absence de marquage ?', answers: ['Ceux qui entrent', 'Ceux qui en sortent', 'Ceux qui sont d√©j√† sur l\'anneau', 'Priorit√© √† droite'], correct: 2, explanation: 'Priorit√© aux v√©hicules d√©j√† engag√©s sur l\'anneau (sauf signalisation contraire).' },
            { theme: 'vitesse', q: 'Sur autoroute, par temps de pluie, la vitesse max pour tous est :', answers: ['100 km/h', '110 km/h', '120 km/h', '130 km/h'], correct: 1, explanation: '110 km/h sur autoroute par temps de pluie.' },
            { theme: 'conducteur', q: 'En cas de fatigue, que faire ?', answers: ['Acc√©l√©rer pour arriver plus vite', 'Continuer en ouvrant la vitre', 'S\'arr√™ter et se reposer', 'Boire un caf√© et repartir'], correct: 2, explanation: 'La seule solution s√ªre : s\'arr√™ter et se reposer.' },
            { theme: 'usagers', q: 'Un pi√©ton manifeste l\'intention de traverser sur un passage. Vous devez :', answers: ['Klaxonner', 'Acc√©l√©rer', 'C√©der le passage', 'Ralentir sans vous arr√™ter'], correct: 2, explanation: 'C√©der le passage au pi√©ton qui manifeste l\'intention de traverser.' },
            { theme: 'stationnement', q: 'Ligne jaune en bord de chauss√©e signifie :', answers: ['Stationnement autoris√©', 'Arr√™t et stationnement interdits', 'Arr√™t autoris√© 5 min', 'R√©serv√© livraisons'], correct: 1, explanation: 'Ligne jaune = arr√™t et stationnement interdits.' },
            { theme: 'reglementation', q: 'Quels documents pr√©senter en cas de contr√¥le ?', answers: ['Permis uniquement', 'Permis, carte grise, attestation d\'assurance', 'Carte grise uniquement', 'Assurance uniquement'], correct: 1, explanation: 'Permis, carte grise (certificat d\'immatriculation), attestation d\'assurance.' },
            { theme: 'secours', q: 'Que signifie le A de PAS ?', answers: ['Arr√™ter', 'Alerter', 'Ambulance', 'Accident'], correct: 1, explanation: 'PAS = Prot√©ger, Alerter, Secourir.' },
            { theme: 'environnement', q: 'Conduire avec des pneus sous la limite d\'usure (1,6 mm) :', answers: ['Autoris√© en ville', 'Interdit', 'Autoris√© √† faible vitesse', 'Uniquement l\'√©t√©'], correct: 1, explanation: 'Pneus √† moins de 1,6 mm = infraction et danger.' },
            { theme: 'mecanique', q: 'Contr√¥le technique : premier passage pour un v√©hicule neuf avant :', answers: ['2 ans', '3 ans', '4 ans', '5 ans'], correct: 2, explanation: 'Premier CT avant 4 ans, puis tous les 2 ans.' },
            { theme: 'signalisation', q: 'Un panneau rond √† fond rouge avec une barre blanche signifie :', answers: ['Danger', 'Interdiction', 'Obligation', 'Indication'], correct: 1, explanation: 'Rond rouge = interdiction.' },
            { theme: 'priorites', q: '√Ä une intersection sans signalisation, en France on applique :', answers: ['Priorit√© √† gauche', 'Priorit√© √† droite', 'Priorit√© √† celui qui va tout droit', 'Priorit√© aux v√©hicules lourds'], correct: 1, explanation: 'Priorit√© √† droite en l\'absence de signalisation.' },
            { theme: 'vitesse', q: 'En zone de rencontre, vitesse max :', answers: ['20 km/h', '30 km/h', '50 km/h', '70 km/h'], correct: 0, explanation: 'Zone de rencontre : 20 km/h.' },
            { theme: 'conducteur', q: 'Alcool au volant (permis confirm√©) : taux max autoris√© ?', answers: ['0,2 g/L', '0,5 g/L', '0,8 g/L', '1 g/L'], correct: 1, explanation: '0,5 g/L pour un conducteur confirm√©.' },
            { theme: 'usagers', q: 'Distance min pour d√©passer un cycliste hors agglom√©ration ?', answers: ['0,5 m', '1 m', '1,5 m', '2 m'], correct: 2, explanation: '1,50 m hors agglo, 1 m en ville.' },
            { theme: 'stationnement', q: 'Stationnement interdit √† moins de combien de m d\'un passage pi√©ton ?', answers: ['3 m', '5 m', '10 m', '15 m'], correct: 1, explanation: '5 m avant un passage pi√©ton.' },
            { theme: 'reglementation', q: 'T√©l√©phone tenu en main au volant : amende forfaitaire ?', answers: ['68 ‚Ç¨', '135 ‚Ç¨', '375 ‚Ç¨', '750 ‚Ç¨'], correct: 1, explanation: '135 ‚Ç¨ et 3 points.' },
            { theme: 'secours', q: 'Num√©ro pour alerter les pompiers ?', answers: ['15', '17', '18', '112'], correct: 2, explanation: '18 = pompiers.' },
            { theme: 'environnement', q: 'Visibilit√© inf√©rieure √† 50 m (brouillard) : vitesse max ?', answers: ['30 km/h', '50 km/h', '80 km/h', '90 km/h'], correct: 1, explanation: '50 km/h max sur toutes les routes.' },
            { theme: 'mecanique', q: 'Gilet et triangle : obligatoires ?', answers: ['Non', 'Oui, dans le v√©hicule', 'Seulement sur autoroute', 'Seulement la nuit'], correct: 1, explanation: 'Obligatoires dans le v√©hicule (√† utiliser en cas d\'arr√™t d\'urgence).' },
            { theme: 'signalisation', q: 'Feu orange fixe (non clignotant) :', answers: ['Passer en acc√©l√©rant', 'S\'arr√™ter', 'Passer si on est proche', 'Ralentir seulement'], correct: 1, explanation: 'Feu orange fixe = s\'arr√™ter (sauf danger d\'arr√™t brutal).' },
            { theme: 'priorites', q: 'Panneau ¬´ C√©dez le passage ¬ª : que faire ?', answers: ['S\'arr√™ter obligatoirement', 'Ralentir et c√©der si n√©cessaire', 'Acc√©l√©rer', 'Klaxonner'], correct: 1, explanation: 'Ralentir et c√©der le passage aux v√©hicules qui ont la priorit√©.' },
            { theme: 'vitesse', q: 'Permis probatoire : vitesse max sur autoroute ?', answers: ['100 km/h', '110 km/h', '120 km/h', '130 km/h'], correct: 1, explanation: '110 km/h pour les permis de moins de 3 ans.' },
            { theme: 'conducteur', q: 'Permis probatoire : combien de points au d√©part ?', answers: ['4', '6', '8', '12'], correct: 1, explanation: '6 points au d√©part (8 si conduite accompagn√©e).' },
            { theme: 'usagers', q: 'EDPM (trottinette √©lectrique) sur trottoir : vitesse max ?', answers: ['6 km/h', '25 km/h', '30 km/h', 'Interdit'], correct: 0, explanation: '6 km/h max sur trottoir si autoris√©.' },
            { theme: 'reglementation', q: 'Capital de points max sur le permis ?', answers: ['6', '8', '12', '15'], correct: 2, explanation: '12 points au maximum.' },
            { theme: 'secours', q: 'Num√©ro d\'urgence europ√©en ?', answers: ['15', '17', '18', '112'], correct: 3, explanation: '112 dans toute l\'UE.' },
            { theme: 'environnement', q: 'Profondeur min des sculptures des pneus (l√©gal) ?', answers: ['0,8 mm', '1,6 mm', '2,5 mm', '3 mm'], correct: 1, explanation: '1,6 mm sur toute la bande de roulement.' },
            { theme: 'signalisation', q: 'Panneau carr√© bleu avec fl√®che blanche :', answers: ['Interdiction', 'Danger', 'Obligation ou indication', 'Priorit√©'], correct: 2, explanation: 'Carr√©/rectangle bleu = obligation ou indication.' },
            { theme: 'priorites', q: 'V√©hicule avec gyrophare et 3 tons :', answers: ['Doit respecter les feux', 'A toujours la priorit√©', 'Vous devez faciliter son passage', 'Doit klaxonner'], correct: 2, explanation: 'Vous devez faciliter le passage (s\'√©carter, vous arr√™ter).' },
            { theme: 'vitesse', q: 'Route √† 2√ó2 voies hors agglo (chauss√©es s√©par√©es) : max ?', answers: ['80 km/h', '90 km/h', '110 km/h', '130 km/h'], correct: 2, explanation: '110 km/h par d√©faut.' },
            { theme: 'conducteur', q: 'Stage de r√©cup√©ration de points : max r√©cup√©rable par stage ?', answers: ['2 points', '4 points', '6 points', '8 points'], correct: 1, explanation: '4 points max (1 stage par an).' },
            { theme: 'stationnement', q: 'Ligne blanche continue en bord de chauss√©e :', answers: ['Stationnement autoris√©', 'Arr√™t autoris√©', 'Franchissement interdit', 'Voie r√©serv√©e'], correct: 2, explanation: 'Ne pas franchir sauf n√©cessit√© (danger, obstacle).' },
            { theme: 'reglementation', q: 'Conduite sans assurance : amende max ?', answers: ['375 ‚Ç¨', '750 ‚Ç¨', '1 500 ‚Ç¨', '3 750 ‚Ç¨'], correct: 3, explanation: 'Jusqu\'√† 3 750 ‚Ç¨ + autres sanctions.' },
            { theme: 'mecanique', q: 'Contr√¥le technique : p√©riodicit√© apr√®s le premier ?', answers: ['Tous les ans', 'Tous les 2 ans', 'Tous les 3 ans', 'Tous les 5 ans'], correct: 1, explanation: 'Tous les 2 ans apr√®s le premier.' },
            { theme: 'usagers', q: 'Distance de s√©curit√© min entre deux v√©hicules (r√®gle) ?', answers: ['1 seconde', '2 secondes', '3 secondes', '5 secondes'], correct: 1, explanation: 'Au moins 2 secondes (r√®gle des 1001, 1002).' },
            { theme: 'secours', q: 'Num√©ro SAMU ?', answers: ['15', '17', '18', '112'], correct: 0, explanation: '15 = SAMU (urgence m√©dicale).' },
            { theme: 'signalisation', q: 'Feu vert avec fl√®che orange :', answers: ['M√™me sens que la fl√®che autoris√©', 'Interdit dans la direction de la fl√®che', 'Feu d√©fectueux', 'Priorit√© aux pi√©tons'], correct: 0, explanation: 'Vous pouvez passer dans la direction indiqu√©e par la fl√®che.' },
            { theme: 'priorites', q: 'Panneau stop : que faire ?', answers: ['Ralentir', 'C√©der le passage', 'S\'arr√™ter obligatoirement', 'Klaxonner'], correct: 2, explanation: 'Arr√™t obligatoire √† la ligne ou au panneau.' },
            { theme: 'vitesse', q: 'Agglom√©ration : vitesse max par d√©faut ?', answers: ['30 km/h', '50 km/h', '70 km/h', '90 km/h'], correct: 1, explanation: '50 km/h en agglom√©ration.' },
            { theme: 'conducteur', q: 'Alcool permis &lt; 3 ans : taux max ?', answers: ['0 g/L', '0,2 g/L', '0,5 g/L', '0,8 g/L'], correct: 1, explanation: '0,2 g/L pour les jeunes conducteurs.' },
            { theme: 'reglementation', q: 'Ceinture non attach√©e (conducteur) : points ?', answers: ['1 point', '2 points', '3 points', '6 points'], correct: 2, explanation: '135 ‚Ç¨ et 3 points.' },
            { theme: 'environnement', q: 'Feux de brouillard arri√®re : √† partir de quelle visibilit√© ?', answers: ['Moins de 200 m', 'Moins de 150 m', 'Moins de 100 m', 'Moins de 50 m'], correct: 2, explanation: 'Uniquement si visibilit√© inf√©rieure √† 100 m.' }
        ];
        
        function startSpeedQuiz() {
            document.getElementById('gamesMenu').style.display = 'none';
            document.getElementById('speedQuizGame').style.display = 'block';
            speedQuizQuestions = shuffleArray(questionsQuiz.concat(speedQuizExtraQuestions)).slice(0, 10);
            speedQuizIndex = 0;
            speedQuizScore = 0;
            speedQuizAnswers = [];
            speedQuizTimeLeft = 120;
            document.getElementById('speedTimer').textContent = '2:00';
            if (speedQuizTimerId) clearInterval(speedQuizTimerId);
            speedQuizTimerId = setInterval(() => {
                speedQuizTimeLeft--;
                const m = Math.floor(speedQuizTimeLeft / 60);
                const s = speedQuizTimeLeft % 60;
                document.getElementById('speedTimer').textContent = m + ':' + s.toString().padStart(2, '0');
                if (speedQuizTimeLeft <= 0) {
                    clearInterval(speedQuizTimerId);
                    endSpeedQuiz();
                }
            }, 1000);
            renderSpeedQuizQuestion();
            window.scrollTo(0, 0);
        }
        
        function renderSpeedQuizQuestion() {
            const container = document.getElementById('speedQuizContent');
            if (speedQuizIndex >= speedQuizQuestions.length || speedQuizTimeLeft <= 0) {
                endSpeedQuiz();
                return;
            }
            const q = speedQuizQuestions[speedQuizIndex];
            container.innerHTML = `
                <div class="question-card">
                    <div class="question-number">Question ${speedQuizIndex + 1}/10</div>
                    <div class="question-text">${q.q}</div>
                    <div class="answers-grid">
                        ${shuffleArray(q.answers.map((_,j)=>j)).map(origIdx => `<div class="answer-option" onclick="answerSpeedQuiz(${origIdx})"><div class="answer-radio"></div><span>${q.answers[origIdx]}</span></div>`).join('')}
                    </div>
                </div>
            `;
        }
        
        function answerSpeedQuiz(choiceIndex) {
            const q = speedQuizQuestions[speedQuizIndex];
            const correct = choiceIndex === q.correct;
            speedQuizAnswers[speedQuizIndex] = choiceIndex;
            if (correct) {
                speedQuizScore++;
                if (soundEnabled) playSound('correct');
            } else if (soundEnabled) playSound('wrong');
            const userText = q.answers[choiceIndex];
            const correctText = q.answers[q.correct];
            document.getElementById('speedQuizContent').innerHTML = `
                <div class="question-card">
                    <div class="question-number">${correct ? '‚úÖ Correct !' : '‚ùå Faux'}</div>
                    <div class="question-text">${q.q}</div>
                    <div style="margin:12px 0; font-size:0.95em;"><strong>Votre r√©ponse :</strong> <span style="color:${correct ? 'var(--success)' : 'var(--danger)'}">${userText}</span></div>
                    ${!correct ? '<div style="margin-bottom:12px; font-size:0.95em;"><strong>Bonne r√©ponse :</strong> ' + correctText + '</div>' : ''}
                    <div class="explanation"><strong>üí°</strong> ${q.explanation || ''}</div>
                    <button class="btn" style="margin-top:20px;" onclick="speedQuizIndex++; renderSpeedQuizQuestion();">Suivant ‚Üí</button>
                </div>
            `;
        }
        
        function endSpeedQuiz() {
            if (speedQuizTimerId) clearInterval(speedQuizTimerId);
            document.getElementById('speedQuizContent').innerHTML = `
                <div class="results-card">
                    <h2>‚è±Ô∏è Quiz Chrono termin√© !</h2>
                    <div class="results-score">${speedQuizScore}/10</div>
                    <p>${speedQuizScore >= 7 ? 'Bravo !' : 'Continuez √† r√©viser.'}</p>
                    <button class="btn" onclick="backToGames()">‚Üê Retour aux jeux</button>
                </div>
            `;
            document.getElementById('speedTimer').textContent = '0:00';
        }
        
        function openLegalModal() {
            document.getElementById('legalModal').classList.add('active');
        }
        
        function closeLegalModal() {
            document.getElementById('legalModal').classList.remove('active');
        }
        
        // ========================================
        // SON
        // ========================================
        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('soundBtn').textContent = soundEnabled ? 'üîä' : 'üîá';
            localStorage.setItem('soundEnabled', soundEnabled);
        }
        
        function playSound(type) {
            if (!soundEnabled) return;
            try {
                var ctx = window.audioContextForSounds || (window.audioContextForSounds = new (window.AudioContext || window.webkitAudioContext)());
                var t0 = ctx.currentTime;
                if (type === 'correct') {
                    // Bonne r√©ponse : petite gamme ascendante douce (do ‚Äì mi ‚Äì sol), agr√©able et valorisante
                    var freqs = [523.25, 659.25, 783.99];
                    freqs.forEach(function(freq, i) {
                        var osc = ctx.createOscillator();
                        var gain = ctx.createGain();
                        osc.type = 'sine';
                        osc.frequency.value = freq;
                        osc.connect(gain);
                        gain.connect(ctx.destination);
                        var start = t0 + i * 0.08;
                        gain.gain.setValueAtTime(0, start);
                        gain.gain.linearRampToValueAtTime(0.18, start + 0.02);
                        gain.gain.exponentialRampToValueAtTime(0.001, start + 0.18);
                        osc.start(start);
                        osc.stop(start + 0.18);
                    });
                } else if (type === 'wrong') {
                    // Mauvaise r√©ponse : son court, doux et neutre (pas agressif)
                    var osc = ctx.createOscillator();
                    var gain = ctx.createGain();
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(280, t0);
                    osc.frequency.exponentialRampToValueAtTime(200, t0 + 0.15);
                    osc.connect(gain);
                    gain.connect(ctx.destination);
                    gain.gain.setValueAtTime(0, t0);
                    gain.gain.linearRampToValueAtTime(0.12, t0 + 0.03);
                    gain.gain.exponentialRampToValueAtTime(0.001, t0 + 0.22);
                    osc.start(t0);
                    osc.stop(t0 + 0.22);
                }
            } catch (e) {}
        }
        
        // Display course list
        function displayCourseList() {
            document.getElementById('courseList').style.display = 'block';
            document.getElementById('courseDetail').style.display = 'none';
            
            const grid = document.getElementById('coursesGrid');
            grid.innerHTML = courses.map(course => {
                const isCompleted = courseProgress[course.id] === 100 || courseProgress[course.id] === true;
                return `
                <div class="card ${isCompleted ? 'card-completed' : ''}" onclick="showCourse(${course.id})">
                    <div class="card-icon">${course.icon}</div>
                    <div class="card-title">${course.title}</div>
                    <div class="card-desc">${course.desc}</div>
                    ${isCompleted ? '<div class="course-done-badge">‚úì Termin√©</div>' : ''}
                </div>
            `;
            }).join('');
        }
        
        // Show course detail
        function showCourse(id) {
            currentCourse = courses.find(c => c.id === id);
            document.getElementById('courseList').style.display = 'none';
            document.getElementById('courseDetail').style.display = 'block';
            document.getElementById('courseDetailContent').innerHTML = currentCourse.content;
            const isCompleted = courseProgress[currentCourse.id] === 100 || courseProgress[currentCourse.id] === true;
            const actions = document.getElementById('courseDetailActions');
            actions.innerHTML = isCompleted
                ? '<button class="btn" onclick="markCourseIncomplete()">‚úó Enlever termin√©</button><button class="btn" onclick="backToCourses()">‚Üê Retour</button>'
                : '<button class="btn" onclick="markCourseComplete()">‚úì Marquer termin√©</button><button class="btn" onclick="backToCourses()">‚Üê Retour</button>';
            window.scrollTo(0, 0);
        }
        
        // Back to courses
        function backToCourses() {
            displayCourseList();
            window.scrollTo(0, 0);
        }
        
        // Mark course complete
        function markCourseComplete() {
            if (currentCourse) {
                courseProgress[currentCourse.id] = 100;
                localStorage.setItem('courseProgress', JSON.stringify(courseProgress));
                alert('‚úÖ Cours marqu√© comme termin√© !');
                backToCourses();
            }
        }
        
        // Enlever termin√©
        function markCourseIncomplete() {
            if (currentCourse) {
                delete courseProgress[currentCourse.id];
                localStorage.setItem('courseProgress', JSON.stringify(courseProgress));
                alert('Cours retir√© des termin√©s.');
                backToCourses();
            }
        }
        
        // Start exam
        function startExam() {
            examQuestions = shuffleArray(questionsExam).slice(0, 40);
            currentQuestionIndex = 0;
            document.getElementById('examTimer').style.display = '';
            userAnswers = [];
            examStartTime = Date.now();
            
            document.getElementById('examStart').style.display = 'none';
            document.getElementById('examContent').style.display = 'block';
            
            startExamTimer();
            displayExamQuestion();
        }
        
        // Start exam timer
        function startExamTimer() {
            let timeLeft = 30 * 60;
            
            examTimer = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('examTimer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(examTimer);
                    finishExam();
                }
            }, 1000);
        }
        
        // Vid√©os explicatives optionnelles (ajoutez des IDs YouTube par th√®me pour afficher un lien sous la question)
        const examVideoIds = { signalisation: '', priorites: '', vitesse: '', stationnement: '', conducteur: '', usagers: '', environnement: '', mecanique: '', secours: '', reglementation: '' };
        function getExamVideoUrl(q) {
            if (!q || !examVideoIds[q.theme]) return '';
            return 'https://www.youtube.com/watch?v=' + examVideoIds[q.theme];
        }
        
        // Display exam question
        function displayExamQuestion() {
            const question = examQuestions[currentQuestionIndex];
            const totalQ = examQuestions.length;
            const progressText = `Question ${currentQuestionIndex + 1}/${totalQ}`;
            if (isErreursQuiz) {
                document.getElementById('erreursProgress').textContent = progressText;
            } else if (isQuizByTheme) {
                document.getElementById('quizProgress').textContent = progressText;
            } else {
                document.getElementById('examProgress').textContent = progressText;
            }
            const qIdx = questions.indexOf(question);
            const examImgFile = getExamImageForQuestion(question, qIdx);
            const examImg = '<img src="'+IMAGES_BASE+examImgFile+'" alt="Illustration" class="question-illustration">';
            const questionImgHtml = examImg;
            const videoUrl = getExamVideoUrl(question);
            const videoHtml = videoUrl ? `<p class="exam-video-link"><a href="${videoUrl}" target="_blank" rel="noopener">‚ñ∂ Vid√©o explicative (${question.theme})</a></p>` : '';
            const answerOrder = shuffleArray(question.answers.map((_, j) => j));
            const html = `
                <div class="question-card">
                    <div class="question-number">Question ${currentQuestionIndex + 1}/${totalQ} ‚Ä¢ ${question.theme}</div>
                    ${questionImgHtml}
                    ${videoHtml}
                    <div class="question-text">${question.q}</div>
                    <div class="answers-grid">
                        ${answerOrder.map(origIdx => `
                            <div class="answer-option" onclick="selectAnswer(${origIdx}, event)">
                                <div class="answer-radio"></div>
                                <span>${question.answers[origIdx]}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="btn-group" style="justify-content: space-between; margin-top: 25px;">
                        ${currentQuestionIndex > 0 ? '<button class="btn" onclick="previousQuestion()">‚Üê Pr√©c√©dent</button>' : '<span></span>'}
                        ${currentQuestionIndex < examQuestions.length - 1 ? '<button class="btn" onclick="nextQuestion()">Suivant ‚Üí</button>' : '<button class="btn" onclick="finishExam()">Terminer</button>'}
                    </div>
                </div>
            `;
            
            var targetQuestion = isErreursQuiz ? document.getElementById('erreursQuestion') : (isQuizByTheme ? document.getElementById('quizQuestion') : document.getElementById('examQuestion'));
            targetQuestion.innerHTML = html;
            
            if (userAnswers[currentQuestionIndex] !== undefined) {
                const options = targetQuestion.querySelectorAll('.answer-option');
                const selectedOrig = userAnswers[currentQuestionIndex];
                const selectedPos = answerOrder.indexOf(selectedOrig);
                if (selectedPos >= 0) options[selectedPos].classList.add('selected');
            }
        }
        
        // Select answer
        function selectAnswer(index, evt) {
            const options = document.querySelectorAll('.answer-option');
            options.forEach(opt => opt.classList.remove('selected'));
            if (evt && evt.currentTarget) evt.currentTarget.classList.add('selected');
            else if (options[index]) options[index].classList.add('selected');
            userAnswers[currentQuestionIndex] = index;
        }
        
        // Next/Previous question
        function nextQuestion() {
            if (currentQuestionIndex < examQuestions.length - 1) {
                currentQuestionIndex++;
                displayExamQuestion();
                window.scrollTo(0, 0);
            }
        }
        
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayExamQuestion();
                window.scrollTo(0, 0);
            }
        }
        
        // Finish exam
        function finishExam() {
            if (examTimer) clearInterval(examTimer);
            
            let score = 0;
            examQuestions.forEach((q, i) => {
                if (userAnswers[i] === q.correct) score++;
            });
            
            const totalQ = examQuestions.length;
            const passed = score >= Math.ceil(totalQ * 35 / 40);
            const duration = examStartTime ? Math.round((Date.now() - examStartTime) / 60000) : 0;
            
            var wrongList = [];
            examQuestions.forEach(function(q, i) {
                if (userAnswers[i] !== q.correct) wrongList.push({ q: q, userAnswer: userAnswers[i] });
            });
            if (wrongList.length) addErrorsToList(wrongList);
            if (isErreursQuiz) {
                var correctTexts = {};
                examQuestions.forEach(function(q, i) {
                    if (userAnswers[i] === q.correct) correctTexts[q.q] = true;
                });
                var saved = getSavedErrors().filter(function(q) { return !correctTexts[q.q]; });
                localStorage.setItem('savedErrors', JSON.stringify(saved));
                document.getElementById('erreursQuestion').style.display = 'none';
                document.getElementById('erreursResults').style.display = 'block';
            } else if (!isQuizByTheme) {
                examHistory.push({
                    score: score,
                    passed: passed,
                    date: new Date().toLocaleDateString('fr-FR'),
                    duration: duration
                });
                localStorage.setItem('examHistory', JSON.stringify(examHistory));
                document.getElementById('examContent').style.display = 'none';
                document.getElementById('examResults').style.display = 'block';
            } else {
                document.getElementById('quizQuestion').style.display = 'none';
                document.getElementById('quizResults').style.display = 'block';
            }
            
            const html = `
                <div class="exam-results-wrap">
                    <div class="results-card">
                        <h2>${passed ? 'üéâ F√©licitations !' : 'üòî Pas encore cette fois'}</h2>
                        <div class="results-score">${score}/${totalQ}</div>
                        <p>${passed ? 'Vous √™tes pr√™t(e) !' : 'Continuez √† r√©viser'}</p>
                        ${!isErreursQuiz ? '<p>Temps : ' + duration + ' minutes</p>' : ''}
                        <div class="btn-group">
                            <button class="btn" onclick="reviewExam()">üìù Correction</button>
                            ${isErreursQuiz ? '<button class="btn" onclick="startErreursQuiz()">üîÑ Refaire les erreurs</button><button class="btn" onclick="resetErreursRun()">‚Üê Retour</button>' : (wrongList.length ? '<button class="btn" onclick="switchTab(\'erreurs\')">‚ùå Voir mes erreurs</button>' : '') + '<button class="btn" onclick="' + (isQuizByTheme ? 'resetQuizRun()' : 'resetExam()') + '">üîÑ Nouveau</button>'}
                        </div>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span class="stat-number">${score}</span>
                            <span class="stat-label">Bonnes r√©ponses</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">${totalQ - score}</span>
                            <span class="stat-label">Erreurs</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">${totalQ ? Math.round((score/totalQ)*100) : 0}%</span>
                            <span class="stat-label">Score</span>
                        </div>
                    </div>
                </div>
            `;
            
            if (isErreursQuiz) {
                document.getElementById('erreursResults').innerHTML = html;
            } else if (isQuizByTheme) {
                document.getElementById('quizResults').innerHTML = html;
            } else {
                document.getElementById('examResults').innerHTML = html;
            }
            window.scrollTo(0, 0);
            
            if (passed) showConfetti();
            isErreursQuiz = false;
        }
        
        // Review exam
        function reviewExam() {
            let html = '<div class="exam-results-wrap"><h2 style="margin-bottom: 30px; color: var(--text);">üìù Correction</h2>';
            
            examQuestions.forEach((q, i) => {
                const userAnswer = userAnswers[i];
                const isCorrect = userAnswer === q.correct;
                
                html += `
                    <div class="question-card">
                        <div class="question-number">Question ${i + 1} - ${isCorrect ? '‚úÖ Correct' : '‚ùå Incorrect'}</div>
                        <div class="question-text">${q.q}</div>
                        <div class="answers-grid">
                            ${q.answers.map((answer, j) => `
                                <div class="answer-option ${j === q.correct ? 'correct' : ''} ${j === userAnswer && !isCorrect ? 'incorrect' : ''}">
                                    <div class="answer-radio"></div>
                                    <span>${answer}</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="explanation">
                            <strong>üí° Explication :</strong> ${q.explanation}
                        </div>
                    </div>
                `;
            });
            
            html += '<button class="btn" style="margin-top:20px;" onclick="' + (isErreursQuiz ? 'resetErreursRun()' : (isQuizByTheme ? 'resetQuizRun()' : 'resetExam()')) + '">üîÑ Retour</button></div>';
            if (isErreursQuiz) {
                document.getElementById('erreursResults').innerHTML = html;
            } else if (isQuizByTheme) {
                document.getElementById('quizResults').innerHTML = html;
            } else {
                document.getElementById('examResults').innerHTML = html;
            }
            window.scrollTo(0, 0);
        }
        
        // Reset exam
        function resetExam() {
            document.getElementById('examStart').style.display = 'block';
            document.getElementById('examContent').style.display = 'none';
            document.getElementById('examResults').style.display = 'none';
            currentQuestionIndex = 0;
            userAnswers = [];
            window.scrollTo(0, 0);
        }
        
        // Display quiz themes
        function displayQuizThemes() {
            const themes = [...new Set(questionsQuiz.map(q => q.theme))].filter(t => t !== 'priorites');
            const icons = {
                signalisation: '‚ö†Ô∏è', priorites: 'üîÑ', vitesse: 'üöÄ',
                stationnement: 'üÖøÔ∏è', conducteur: 'üë§', usagers: 'üö∂',
                environnement: 'üåç', mecanique: 'üîß', secours: 'üöë',
                reglementation: 'üìÑ'
            };
            
            const grid = document.getElementById('quizThemes');
            grid.innerHTML = themes.map(theme => `
                <div class="card" onclick="startQuiz('${theme}')">
                    <div class="card-icon">${icons[theme] || 'üìö'}</div>
                    <div class="card-title">${theme.charAt(0).toUpperCase() + theme.slice(1)}</div>
                    <div class="card-desc">10 questions sur ce th√®me</div>
                </div>
            `).join('');
        }
        
        // Start quiz
        function startQuiz(theme) {
            const themeQuestions = questionsQuiz.filter(q => q.theme === theme);
            examQuestions = shuffleArray(themeQuestions).slice(0, Math.min(10, themeQuestions.length));
            currentQuestionIndex = 0;
            userAnswers = [];
            isQuizByTheme = true;
            examStartTime = Date.now();
            
            switchTab('quiz');
            document.getElementById('quizThemesWrap').style.display = 'none';
            document.getElementById('quizRunContainer').style.display = 'block';
            document.getElementById('quizQuestion').style.display = 'block';
            document.getElementById('quizResults').style.display = 'none';
            document.getElementById('quizResults').innerHTML = '';
            displayExamQuestion();
            window.scrollTo(0, 0);
        }
        
        function resetQuizRun() {
            isQuizByTheme = false;
            document.getElementById('quizRunContainer').style.display = 'none';
            document.getElementById('quizThemesWrap').style.display = 'block';
            currentQuestionIndex = 0;
            userAnswers = [];
        }
        
        // Onglet Erreurs : cumul de toutes les erreurs (quiz + examen)
        function getSavedErrors() {
            try {
                var raw = localStorage.getItem('savedErrors');
                return raw ? JSON.parse(raw) : [];
            } catch (e) { return []; }
        }
        function addErrorsToList(wrongList) {
            var saved = getSavedErrors();
            var texts = {};
            saved.forEach(function(q) { texts[q.q] = true; });
            wrongList.forEach(function(item) {
                if (!texts[item.q.q]) {
                    saved.push(item.q);
                    texts[item.q.q] = true;
                }
            });
            localStorage.setItem('savedErrors', JSON.stringify(saved));
        }
        function displayErreursTab() {
            var list = getSavedErrors();
            var msg = document.getElementById('erreursMessage');
            var actions = document.getElementById('erreursActions');
            if (list.length === 0) {
                msg.innerHTML = '<p><strong>Aucune erreur enregistr√©e.</strong></p><p>Les questions auxquelles vous r√©pondez incorrectement dans un <strong>quiz</strong> ou un <strong>examen blanc</strong> sont ajout√©es ici. Vous pourrez ensuite refaire un quiz avec uniquement ces questions.</p>';
                actions.innerHTML = '';
            } else {
                msg.innerHTML = '<p><strong>' + list.length + ' question(s)</strong> enregistr√©e(s) (erreurs pass√©es en quiz et examen).</p><p>Refaites un quiz avec ces questions pour vous entra√Æner.</p>';
                actions.innerHTML = '<button class="btn" onclick="startErreursQuiz()">Refaire les erreurs</button> <button class="btn" onclick="clearSavedErrors()">Effacer toutes les erreurs</button>';
            }
        }
        function startErreursQuiz() {
            var list = getSavedErrors();
            if (!list.length) return;
            isErreursQuiz = true;
            examQuestions = shuffleArray(list.slice());
            userAnswers = [];
            currentQuestionIndex = 0;
            document.getElementById('erreursHome').style.display = 'none';
            document.getElementById('erreursRun').style.display = 'block';
            document.getElementById('erreursQuestion').style.display = 'block';
            document.getElementById('erreursResults').style.display = 'none';
            document.getElementById('erreursResults').innerHTML = '';
            displayExamQuestion();
            window.scrollTo(0, 0);
        }
        function resetErreursRun() {
            isErreursQuiz = false;
            document.getElementById('erreursRun').style.display = 'none';
            document.getElementById('erreursHome').style.display = 'block';
            document.getElementById('erreursResults').style.display = 'none';
            document.getElementById('erreursResults').innerHTML = '';
            displayErreursTab();
        }
        function clearSavedErrors() {
            localStorage.removeItem('savedErrors');
            displayErreursTab();
        }
        
        // Flashcards
        var flashcardList = [];
        var flashcardIndex = 0;
        var flashcardFlipped = false;
        function displayFlashcardsThemes() {
            var themes = [...new Set(questionsQuiz.map(function(q) { return q.theme; }))].filter(function(t) { return t !== 'priorites'; });
            var icons = { signalisation: '‚ö†Ô∏è', priorites: 'üîÑ', vitesse: 'üöÄ', stationnement: 'üÖøÔ∏è', conducteur: 'üë§', usagers: 'üö∂', environnement: 'üåç', mecanique: 'üîß', secours: 'üöë', reglementation: 'üìÑ' };
            var grid = document.getElementById('flashcardsThemes');
            grid.innerHTML = themes.map(function(theme) {
                return '<div class="card" onclick="startFlashcards(\'' + theme + '\')"><div class="card-icon">' + (icons[theme] || 'üìö') + '</div><div class="card-title">' + theme.charAt(0).toUpperCase() + theme.slice(1) + '</div><div class="card-desc">Cartes question / r√©ponse</div></div>';
            }).join('');
            document.getElementById('flashcardsThemesWrap').style.display = 'block';
            document.getElementById('flashcardsRun').style.display = 'none';
        }
        function startFlashcards(theme) {
            var themeQuestions = questionsQuiz.filter(function(q) { return q.theme === theme; });
            flashcardList = shuffleArray(themeQuestions.slice());
            flashcardIndex = 0;
            flashcardFlipped = false;
            document.getElementById('flashcardsThemesWrap').style.display = 'none';
            document.getElementById('flashcardsRun').style.display = 'block';
            renderFlashcard();
        }
        function renderFlashcard() {
            var total = flashcardList.length;
            if (total === 0) {
                document.getElementById('flashcardNum').textContent = '0';
                document.getElementById('flashcardTotal').textContent = '0';
                document.getElementById('flashcardFront').innerHTML = 'Aucune carte pour ce th√®me.';
                document.getElementById('flashcardBack').innerHTML = '';
                return;
            }
            var card = flashcardList[flashcardIndex];
            document.getElementById('flashcardNum').textContent = flashcardIndex + 1;
            document.getElementById('flashcardTotal').textContent = total;
            document.getElementById('flashcardFront').textContent = card.q;
            var rep = card.answers && card.answers[card.correct] ? card.answers[card.correct] : '';
                document.getElementById('flashcardBack').innerHTML = '<p class="fc-text">' + rep + '</p>';
            var inner = document.getElementById('flashcardInner');
            if (flashcardFlipped) inner.classList.add('flipped'); else inner.classList.remove('flipped');
        }
        function flipFlashcard() {
            flashcardFlipped = !flashcardFlipped;
            document.getElementById('flashcardInner').classList.toggle('flipped', flashcardFlipped);
        }
        function nextFlashcard() {
            if (flashcardIndex < flashcardList.length - 1) {
                flashcardIndex++;
                flashcardFlipped = false;
                document.getElementById('flashcardInner').classList.remove('flipped');
                renderFlashcard();
            }
        }
        function prevFlashcard() {
            if (flashcardIndex > 0) {
                flashcardIndex--;
                flashcardFlipped = false;
                document.getElementById('flashcardInner').classList.remove('flipped');
                renderFlashcard();
            }
        }
        function backToFlashcardsThemes() {
            document.getElementById('flashcardsRun').style.display = 'none';
            document.getElementById('flashcardsThemesWrap').style.display = 'block';
        }
        
        // Pr√©diction IA : analyse progression et retourne { percent, message, tips }
        function computePrediction() {
            const tips = [];
            let percent = 0;
            let message = '';
            
            if (examHistory.length === 0) {
                const coursesDone = Object.values(courseProgress).filter(v => v === 100 || v === true).length;
                if (coursesDone >= 5) {
                    percent = 45;
                    message = 'Cours bien avanc√©s ! Passez des examens blancs pour affiner la pr√©diction.';
                } else {
                    percent = 25;
                    message = 'Passez des examens blancs pour obtenir une pr√©diction personnalis√©e.';
                }
                tips.push('Compl√©tez les 10 cours');
                tips.push('Faites au moins 2-3 examens blancs');
                return { percent, message, tips };
            }
            
            const totalExams = examHistory.length;
            const passed = examHistory.filter(e => e.passed).length;
            const avgScore = examHistory.reduce((sum, e) => sum + e.score, 0) / totalExams;
            const bestScore = Math.max(...examHistory.map(e => e.score));
            
            // Base : moyenne sur 40 (35 = r√©ussite)
            let basePercent = Math.round((avgScore / 40) * 100);
            basePercent = Math.min(95, Math.max(10, basePercent));
            
            // Bonus tendance r√©cente (3 derniers examens)
            let trendBonus = 0;
            if (totalExams >= 3) {
                const last3 = examHistory.slice(-3);
                const last3Avg = last3.reduce((s, e) => s + e.score, 0) / 3;
                if (last3Avg > avgScore) {
                    trendBonus = 5;
                    tips.push('Progression positive : continuez !');
                }
            }
            
            // Bonus cours
            const coursesDone = Object.values(courseProgress).filter(v => v === 100 || v === true).length;
            const courseBonus = Math.min(5, coursesDone * 0.5);
            
            percent = Math.min(95, Math.round(basePercent + trendBonus + courseBonus));
            
            if (percent >= 80) {
                message = 'Excellente progression ! Vous √™tes bien pr√©par√©(e) pour l\'examen.';
                if (tips.length === 0) tips.push('Maintenez le rythme jusqu\'au jour J');
            } else if (percent >= 65) {
                message = 'Bonne progression. Encha√Ænez encore quelques examens blancs.';
                tips.push('Visez 35/40 √† plusieurs reprises');
            } else if (percent >= 50) {
                message = 'Continuez la r√©vision. Les examens blancs vous aideront.';
                tips.push('R√©visez les th√®mes o√π vous h√©sitez');
                tips.push('Refaites les quiz par th√®me');
            } else {
                message = 'La pratique r√©guli√®re vous fera progresser. Ne l√¢chez pas !';
                tips.push('Suivez les 10 cours dans l\'ordre');
                tips.push('Faites des quiz par th√®me avant les examens');
            }
            
            if (bestScore < 35 && totalExams >= 2) {
                tips.push('Objectif : d√©passer 35/40 √† l\'examen blanc');
            }
            
            return { percent, message, tips };
        }
        
        function updateHomePrediction() {
            const box = document.getElementById('homePrediction');
            const percentEl = document.getElementById('homePredictionPercent');
            const msgEl = document.getElementById('homePredictionMsg');
            const p = computePrediction();
            percentEl.textContent = p.percent + '%';
            msgEl.textContent = p.message;
            box.style.display = (examHistory.length > 0 || Object.keys(courseProgress).length > 0) ? 'block' : 'none';
        }
        
        // Display stats
        function displayStats() {
            const content = document.getElementById('statsContent');
            const details = document.getElementById('statsDetails');
            
            // Mise √† jour pr√©diction IA dans Stats
            const p = computePrediction();
            document.getElementById('statsPredictionPercent').textContent = p.percent + '%';
            const tipsHtml = p.tips.length ? '<div style="margin-top:16px; padding:12px; background:rgba(6,214,160,0.08); border-radius:10px;"><strong>üí° Conseils :</strong><ul style="margin:8px 0 0 20px; line-height:1.7;">' + p.tips.map(t => '<li>' + t + '</li>').join('') + '</ul></div>' : '';
            document.getElementById('statsAITips').innerHTML = tipsHtml;
            
            if (examHistory.length === 0) {
                content.innerHTML = '<div class="stat-card" style="grid-column: 1/-1;"><p style="color: var(--text-light); padding: 40px;">Aucun examen pass√©. Commencez par un test !</p></div>';
                details.innerHTML = '';
                return;
            }
            
            const totalExams = examHistory.length;
            const passed = examHistory.filter(e => e.passed).length;
            const avgScore = (examHistory.reduce((sum, e) => sum + e.score, 0) / totalExams).toFixed(1);
            const bestScore = Math.max(...examHistory.map(e => e.score));
            
            content.innerHTML = `
                <div class="stat-card">
                    <span class="stat-number">${totalExams}</span>
                    <span class="stat-label">Examens pass√©s</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${passed}</span>
                    <span class="stat-label">R√©ussis (‚â•35)</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${avgScore}/40</span>
                    <span class="stat-label">Moyenne</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${bestScore}/40</span>
                    <span class="stat-label">Meilleur</span>
                </div>
            `;
            
            details.innerHTML = '<h3 style="margin: 30px 0 20px;">üìä Historique</h3>' +
                examHistory.slice().reverse().map((exam, i) => `
                    <div style="background: var(--surface); border: 2px solid ${exam.passed ? 'var(--success)' : 'var(--border)'}; border-radius: 15px; padding: 20px; margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; flex-wrap: wrap; gap: 15px;">
                            <div><strong>Examen ${examHistory.length - i}</strong><br><span style="color: var(--text-light);">${exam.date} ‚Ä¢ ${exam.duration} min</span></div>
                            <div style="font-family: 'Space Mono', monospace; font-size: 1.5em; font-weight: 700; color: ${exam.passed ? 'var(--success)' : 'var(--primary)'};">${exam.score}/40 ${exam.passed ? '‚úÖ' : ''}</div>
                        </div>
                    </div>
                `).join('');
        }
        
        // Show confetti
        function showConfetti() {
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = ['var(--primary)', 'var(--secondary)', 'var(--accent)', 'var(--success)'][Math.floor(Math.random() * 4)];
                    confetti.style.animation = 'confetti-fall 3s linear';
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }
        
        // =============================================
        // INITIALISATION
        // =============================================
        window.addEventListener('load', () => {
            // Charger progression cours
            const savedProgress = localStorage.getItem('courseProgress');
            if (savedProgress) courseProgress = JSON.parse(savedProgress);
            
            // Charger historique examens
            const savedExamHistory = localStorage.getItem('examHistory');
            if (savedExamHistory) examHistory = JSON.parse(savedExamHistory);
            
            // Charger pr√©f√©rence son
            soundEnabled = localStorage.getItem('soundEnabled') !== 'false';
            document.getElementById('soundBtn').textContent = soundEnabled ? 'üîä' : 'üîá';
            
            // Bouton th√®me clair/sombre
            updateThemeButton();
            var m = document.querySelector('meta[name="theme-color"]');
            if (m) m.setAttribute('content', getTheme() === 'dark' ? '#25252a' : '#FF6B35');
            displayCourseList();
            updateHomePrediction();
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js').catch(function () {});
            }
        });
    </script>
</body>
</html>